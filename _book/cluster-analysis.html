<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Chapter 4 Cluster analysis of soil XRPD data | Digital Soil Mineralogy with R</title>
  <meta name="description" content="An online course detailing various methods for data-driven analysis of X-ray powder diffraction using R" />
  <meta name="generator" content="bookdown 0.27 and GitBook 2.6.7" />

  <meta property="og:title" content="Chapter 4 Cluster analysis of soil XRPD data | Digital Soil Mineralogy with R" />
  <meta property="og:type" content="book" />
  <meta property="og:image" content="/figures/dsm_graphic.png" />
  <meta property="og:description" content="An online course detailing various methods for data-driven analysis of X-ray powder diffraction using R" />
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Chapter 4 Cluster analysis of soil XRPD data | Digital Soil Mineralogy with R" />
  
  <meta name="twitter:description" content="An online course detailing various methods for data-driven analysis of X-ray powder diffraction using R" />
  <meta name="twitter:image" content="/figures/dsm_graphic.png" />

<meta name="author" content="Benjamin Butler and Steve Hillier" />


<meta name="date" content="2022-07-19" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="machine-learning.html"/>
<link rel="next" href="mars.html"/>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.1.0/anchor-sections.css" rel="stylesheet" />
<link href="libs/anchor-sections-1.1.0/anchor-sections-hash.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.1.0/anchor-sections.js"></script>
<script src="libs/font-awesome-5.13.0/js/script.js"></script>
<script src="libs/htmlwidgets-1.5.4/htmlwidgets.js"></script>
<link href="libs/leaflet-1.3.1/leaflet.css" rel="stylesheet" />
<script src="libs/leaflet-1.3.1/leaflet.js"></script>
<link href="libs/leafletfix-1.0.0/leafletfix.css" rel="stylesheet" />
<script src="libs/proj4-2.6.2/proj4.min.js"></script>
<script src="libs/Proj4Leaflet-1.0.1/proj4leaflet.js"></script>
<link href="libs/rstudio_leaflet-1.3.1/rstudio_leaflet.css" rel="stylesheet" />
<script src="libs/leaflet-binding-2.1.1/leaflet.js"></script>
<script src="libs/plotly-binding-4.9.4.1/plotly.js"></script>
<script src="libs/typedarray-0.1/typedarray.min.js"></script>
<link href="libs/crosstalk-1.1.1/css/crosstalk.css" rel="stylesheet" />
<script src="libs/crosstalk-1.1.1/js/crosstalk.min.js"></script>
<link href="libs/plotly-htmlwidgets-css-1.57.1/plotly-htmlwidgets.css" rel="stylesheet" />
<script src="libs/plotly-main-1.57.1/plotly-latest.min.js"></script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<style type="text/css">
/* Used with Pandoc 2.11+ new --citeproc when CSL is used */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
}
.hanging div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">Digital Soil Mineralogy with R</a></li>

<li class="divider"></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Preface</a>
<ul>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#prerequisites"><i class="fa fa-check"></i>Prerequisites</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#code-conventions"><i class="fa fa-check"></i>Code Conventions</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#what-to-expect"><i class="fa fa-check"></i>What to expect</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#about-the-authors"><i class="fa fa-check"></i>About the authors</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#acknowledgments"><i class="fa fa-check"></i>Acknowledgments</a></li>
</ul></li>
<li class="chapter" data-level="1" data-path="intro.html"><a href="intro.html"><i class="fa fa-check"></i><b>1</b> Working with XRPD data in R</a>
<ul>
<li class="chapter" data-level="1.1" data-path="intro.html"><a href="intro.html#basic-form"><i class="fa fa-check"></i><b>1.1</b> The basic form of XRPD data</a></li>
<li class="chapter" data-level="1.2" data-path="intro.html"><a href="intro.html#loading-data"><i class="fa fa-check"></i><b>1.2</b> Loading XRPD data</a>
<ul>
<li class="chapter" data-level="1.2.1" data-path="intro.html"><a href="intro.html#powDLL"><i class="fa fa-check"></i><b>1.2.1</b> Option 1: PowDLL</a></li>
<li class="chapter" data-level="1.2.2" data-path="intro.html"><a href="intro.html#loading-directly"><i class="fa fa-check"></i><b>1.2.2</b> Option 2: Loading directly into R</a></li>
<li class="chapter" data-level="1.2.3" data-path="intro.html"><a href="intro.html#loading-multiple"><i class="fa fa-check"></i><b>1.2.3</b> Loading multiple files</a></li>
</ul></li>
<li class="chapter" data-level="1.3" data-path="intro.html"><a href="intro.html#plotting-data"><i class="fa fa-check"></i><b>1.3</b> Plotting XRPD data</a>
<ul>
<li class="chapter" data-level="1.3.1" data-path="intro.html"><a href="intro.html#plotting-xy-objects"><i class="fa fa-check"></i><b>1.3.1</b> Plotting <code>XY</code> objects</a></li>
<li class="chapter" data-level="1.3.2" data-path="intro.html"><a href="intro.html#plotting-multixy-objects"><i class="fa fa-check"></i><b>1.3.2</b> Plotting <code>multiXY</code> objects</a></li>
<li class="chapter" data-level="1.3.3" data-path="intro.html"><a href="intro.html#ggplot2-intro"><i class="fa fa-check"></i><b>1.3.3</b> Modifying plots with <strong>ggplot2</strong></a></li>
</ul></li>
<li class="chapter" data-level="1.4" data-path="intro.html"><a href="intro.html#manipulating-data"><i class="fa fa-check"></i><b>1.4</b> Manipulating XRPD data</a>
<ul>
<li class="chapter" data-level="1.4.1" data-path="intro.html"><a href="intro.html#subsetting"><i class="fa fa-check"></i><b>1.4.1</b> Subsetting XRPD data</a></li>
<li class="chapter" data-level="1.4.2" data-path="intro.html"><a href="intro.html#transformations"><i class="fa fa-check"></i><b>1.4.2</b> Transformations of count intensities</a></li>
<li class="chapter" data-level="1.4.3" data-path="intro.html"><a href="intro.html#interpolation"><i class="fa fa-check"></i><b>1.4.3</b> Interpolation</a></li>
<li class="chapter" data-level="1.4.4" data-path="intro.html"><a href="intro.html#alignment"><i class="fa fa-check"></i><b>1.4.4</b> Alignment</a></li>
<li class="chapter" data-level="1.4.5" data-path="intro.html"><a href="intro.html#background"><i class="fa fa-check"></i><b>1.4.5</b> Background fitting</a></li>
<li class="chapter" data-level="1.4.6" data-path="intro.html"><a href="intro.html#to-data-frame"><i class="fa fa-check"></i><b>1.4.6</b> Converting to and from data frames</a></li>
<li class="chapter" data-level="1.4.7" data-path="intro.html"><a href="intro.html#two-theta-transform"><i class="fa fa-check"></i><b>1.4.7</b> 2θ transformation</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="2" data-path="quant.html"><a href="quant.html"><i class="fa fa-check"></i><b>2</b> Quantitative phase analysis</a>
<ul>
<li class="chapter" data-level="2.1" data-path="quant.html"><a href="quant.html#full-pattern-summation-with-powdr"><i class="fa fa-check"></i><b>2.1</b> Full pattern summation with <strong>powdR</strong></a>
<ul>
<li class="chapter" data-level="2.1.1" data-path="quant.html"><a href="quant.html#powdRlib"><i class="fa fa-check"></i><b>2.1.1</b> The <code>powdRlib</code> object</a></li>
<li class="chapter" data-level="2.1.2" data-path="quant.html"><a href="quant.html#full-pattern-summation-with-fps"><i class="fa fa-check"></i><b>2.1.2</b> Full pattern summation with <code>fps()</code></a></li>
<li class="chapter" data-level="2.1.3" data-path="quant.html"><a href="quant.html#afps"><i class="fa fa-check"></i><b>2.1.3</b> Automated full pattern summation with <code>afps()</code></a></li>
<li class="chapter" data-level="2.1.4" data-path="quant.html"><a href="quant.html#additional-fps-and-afps-functionality"><i class="fa fa-check"></i><b>2.1.4</b> Additional <code>fps()</code> and <code>afps()</code> functionality</a></li>
</ul></li>
<li class="chapter" data-level="2.2" data-path="quant.html"><a href="quant.html#plotting-powdrfps-and-powdrafps-objects"><i class="fa fa-check"></i><b>2.2</b> Plotting <code>powdRfps</code> and <code>powdRafps</code> objects</a></li>
<li class="chapter" data-level="2.3" data-path="quant.html"><a href="quant.html#quantifying-multiple-samples"><i class="fa fa-check"></i><b>2.3</b> Quantifying multiple samples</a>
<ul>
<li class="chapter" data-level="2.3.1" data-path="quant.html"><a href="quant.html#lapply"><i class="fa fa-check"></i><b>2.3.1</b> <code>lapply()</code></a></li>
<li class="chapter" data-level="2.3.2" data-path="quant.html"><a href="quant.html#parallel-processing"><i class="fa fa-check"></i><b>2.3.2</b> Parallel processing</a></li>
</ul></li>
<li class="chapter" data-level="2.4" data-path="quant.html"><a href="quant.html#summarising-mineralogy"><i class="fa fa-check"></i><b>2.4</b> Summarising mineralogy</a></li>
<li class="chapter" data-level="2.5" data-path="quant.html"><a href="quant.html#the-powdr-shiny-app"><i class="fa fa-check"></i><b>2.5</b> The powdR Shiny app</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="machine-learning.html"><a href="machine-learning.html"><i class="fa fa-check"></i><b>3</b> Machine learning with soil XRPD data</a>
<ul>
<li class="chapter" data-level="3.1" data-path="machine-learning.html"><a href="machine-learning.html#loading-packages-and-data"><i class="fa fa-check"></i><b>3.1</b> Loading packages and data</a></li>
<li class="chapter" data-level="3.2" data-path="machine-learning.html"><a href="machine-learning.html#cubist-exploration"><i class="fa fa-check"></i><b>3.2</b> Data exploration</a>
<ul>
<li class="chapter" data-level="3.2.1" data-path="machine-learning.html"><a href="machine-learning.html#spatial-data"><i class="fa fa-check"></i><b>3.2.1</b> Spatial data</a></li>
<li class="chapter" data-level="3.2.2" data-path="machine-learning.html"><a href="machine-learning.html#geochemical-data"><i class="fa fa-check"></i><b>3.2.2</b> Geochemical data</a></li>
<li class="chapter" data-level="3.2.3" data-path="machine-learning.html"><a href="machine-learning.html#xrpd-data"><i class="fa fa-check"></i><b>3.2.3</b> XRPD data</a></li>
</ul></li>
<li class="chapter" data-level="3.3" data-path="machine-learning.html"><a href="machine-learning.html#cubist-pretreatment"><i class="fa fa-check"></i><b>3.3</b> Data pre-treatment</a>
<ul>
<li class="chapter" data-level="3.3.1" data-path="machine-learning.html"><a href="machine-learning.html#alignment-1"><i class="fa fa-check"></i><b>3.3.1</b> Alignment</a></li>
<li class="chapter" data-level="3.3.2" data-path="machine-learning.html"><a href="machine-learning.html#subsetting-1"><i class="fa fa-check"></i><b>3.3.2</b> Subsetting</a></li>
<li class="chapter" data-level="3.3.3" data-path="machine-learning.html"><a href="machine-learning.html#mean-centering"><i class="fa fa-check"></i><b>3.3.3</b> Mean centering</a></li>
</ul></li>
<li class="chapter" data-level="3.4" data-path="machine-learning.html"><a href="machine-learning.html#creation-of-training-and-test-datasets"><i class="fa fa-check"></i><b>3.4</b> Creation of training and test datasets</a></li>
<li class="chapter" data-level="3.5" data-path="machine-learning.html"><a href="machine-learning.html#using-cubist"><i class="fa fa-check"></i><b>3.5</b> Using Cubist</a></li>
<li class="chapter" data-level="3.6" data-path="machine-learning.html"><a href="machine-learning.html#inspection-of-cubist-models"><i class="fa fa-check"></i><b>3.6</b> Inspection of Cubist models</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="cluster-analysis.html"><a href="cluster-analysis.html"><i class="fa fa-check"></i><b>4</b> Cluster analysis of soil XRPD data</a>
<ul>
<li class="chapter" data-level="4.1" data-path="cluster-analysis.html"><a href="cluster-analysis.html#loading-packages-and-data-1"><i class="fa fa-check"></i><b>4.1</b> Loading packages and data</a></li>
<li class="chapter" data-level="4.2" data-path="cluster-analysis.html"><a href="cluster-analysis.html#clustering-pca"><i class="fa fa-check"></i><b>4.2</b> Principal component analysis</a>
<ul>
<li class="chapter" data-level="4.2.1" data-path="cluster-analysis.html"><a href="cluster-analysis.html#interpreting-principal-components"><i class="fa fa-check"></i><b>4.2.1</b> Interpreting principal components</a></li>
</ul></li>
<li class="chapter" data-level="4.3" data-path="cluster-analysis.html"><a href="cluster-analysis.html#fuzzy-clustering"><i class="fa fa-check"></i><b>4.3</b> Fuzzy clustering</a>
<ul>
<li class="chapter" data-level="4.3.1" data-path="cluster-analysis.html"><a href="cluster-analysis.html#cluster-membership"><i class="fa fa-check"></i><b>4.3.1</b> Cluster membership</a></li>
<li class="chapter" data-level="4.3.2" data-path="cluster-analysis.html"><a href="cluster-analysis.html#subsetting-clusters"><i class="fa fa-check"></i><b>4.3.2</b> Subsetting Clusters</a></li>
</ul></li>
<li class="chapter" data-level="4.4" data-path="cluster-analysis.html"><a href="cluster-analysis.html#exploring-results"><i class="fa fa-check"></i><b>4.4</b> Exploring results</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="mars.html"><a href="mars.html"><i class="fa fa-check"></i><b>5</b> From Mars to Mull: Interplanetary comparison of soil XRPD data</a>
<ul>
<li class="chapter" data-level="5.1" data-path="mars.html"><a href="mars.html#mars-package"><i class="fa fa-check"></i><b>5.1</b> Required packages</a></li>
<li class="chapter" data-level="5.2" data-path="mars.html"><a href="mars.html#datasets"><i class="fa fa-check"></i><b>5.2</b> Datasets</a>
<ul>
<li class="chapter" data-level="5.2.1" data-path="mars.html"><a href="mars.html#mars-data"><i class="fa fa-check"></i><b>5.2.1</b> Mars Science Laboratory XRPD Data</a></li>
<li class="chapter" data-level="5.2.2" data-path="mars.html"><a href="mars.html#mars-scotland-data"><i class="fa fa-check"></i><b>5.2.2</b> Scottish Soil XRPD data</a></li>
</ul></li>
<li class="chapter" data-level="5.3" data-path="mars.html"><a href="mars.html#mars-manipulation"><i class="fa fa-check"></i><b>5.3</b> Data manipulation</a>
<ul>
<li class="chapter" data-level="5.3.1" data-path="mars.html"><a href="mars.html#θ-transformation"><i class="fa fa-check"></i><b>5.3.1</b> 2θ transformation</a></li>
<li class="chapter" data-level="5.3.2" data-path="mars.html"><a href="mars.html#θ-interpolation"><i class="fa fa-check"></i><b>5.3.2</b> 2θ interpolation</a></li>
</ul></li>
<li class="chapter" data-level="5.4" data-path="mars.html"><a href="mars.html#comparison-of-xrpd-data"><i class="fa fa-check"></i><b>5.4</b> Comparison of XRPD data</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="references.html"><a href="references.html"><i class="fa fa-check"></i>References</a></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Digital Soil Mineralogy with R</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="cluster-analysis" class="section level1 hasAnchor" number="4">
<h1><span class="header-section-number">Chapter 4</span> Cluster analysis of soil XRPD data<a href="cluster-analysis.html#cluster-analysis" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<p>This chapter will demonstrate the use of cluster analysis to identify mineral-nutrient relationships in African soils. The examples provided for the cluster analysis use the data presented in <span class="citation">Butler et al. (<a href="#ref-Butler2020" role="doc-biblioref">2020</a>)</span> that is hosted <a href="https://doi.org/10.17632/r6g94fgx55.1">here</a> on Mendeley Data. To run the examples in this chapter on your own machine, you will need to download the soil property data in ‘.csv’ format and the XRPD data in a zipped folder of ‘xy’ files. Please simply save these files to your own directory, and unzip the zipped folder containing the ‘.xy’ files. <strong>Skip this step if you have already downloaded these files for the examples in Chapter <a href="machine-learning.html#machine-learning">3</a></strong>,</p>
<a href="https://data.mendeley.com/public-files/datasets/r6g94fgx55/files/9b742b95-c071-4e3a-a227-939efa034ac7/file_downloaded">
<button class="btn btn-danger"><i class="fa fa-save"></i> Download soil property csv</button>
</a>
<a href="https://data.mendeley.com/public-files/datasets/r6g94fgx55/files/ef33d276-e39c-4b64-b9aa-f2d1d69c51b3/file_downloaded">
<button class="btn btn-danger"><i class="fa fa-save"></i> Download zipped XRPD data</button>
</a>
<div id="loading-packages-and-data-1" class="section level2 hasAnchor" number="4.1">
<h2><span class="header-section-number">4.1</span> Loading packages and data<a href="cluster-analysis.html#loading-packages-and-data-1" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>This chapter will use a number of packages that should already be installed on your machine, but will also use the <strong>reshape2</strong> and <strong>e1071</strong> packages that may need to be installed if you have not used them before:</p>
<div class="sourceCode" id="cb165"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb165-1"><a href="cluster-analysis.html#cb165-1" aria-hidden="true" tabindex="-1"></a><span class="co">#install packages that haven&#39;t been used in the course before</span></span>
<span id="cb165-2"><a href="cluster-analysis.html#cb165-2" aria-hidden="true" tabindex="-1"></a><span class="fu">install.packages</span>(<span class="fu">c</span>(<span class="st">&quot;reshape2&quot;</span>, <span class="st">&quot;e1071&quot;</span>))</span></code></pre></div>
<div class="sourceCode" id="cb166"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb166-1"><a href="cluster-analysis.html#cb166-1" aria-hidden="true" tabindex="-1"></a><span class="co">#load the relevant packages</span></span>
<span id="cb166-2"><a href="cluster-analysis.html#cb166-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(reshape2)</span>
<span id="cb166-3"><a href="cluster-analysis.html#cb166-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(e1071)</span>
<span id="cb166-4"><a href="cluster-analysis.html#cb166-4" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(leaflet)</span>
<span id="cb166-5"><a href="cluster-analysis.html#cb166-5" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(powdR)</span>
<span id="cb166-6"><a href="cluster-analysis.html#cb166-6" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb166-7"><a href="cluster-analysis.html#cb166-7" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(plotly)</span>
<span id="cb166-8"><a href="cluster-analysis.html#cb166-8" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(gridExtra)</span>
<span id="cb166-9"><a href="cluster-analysis.html#cb166-9" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(plyr)</span></code></pre></div>
<p>Once you have loaded the packages and downloaded the data required for this chapter (note that it is the same data as that used in Chapter <a href="machine-learning.html#machine-learning">3</a>), the data can be loaded into R by modifying the paths in the following code:</p>
<div class="sourceCode" id="cb167"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb167-1"><a href="cluster-analysis.html#cb167-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Load the soil property data</span></span>
<span id="cb167-2"><a href="cluster-analysis.html#cb167-2" aria-hidden="true" tabindex="-1"></a>props <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="at">file =</span> <span class="st">&quot;path/to/your/file/clusters_and_properties.csv&quot;</span>)</span>
<span id="cb167-3"><a href="cluster-analysis.html#cb167-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb167-4"><a href="cluster-analysis.html#cb167-4" aria-hidden="true" tabindex="-1"></a><span class="co">#Get the full file paths of the XRPD data</span></span>
<span id="cb167-5"><a href="cluster-analysis.html#cb167-5" aria-hidden="true" tabindex="-1"></a>xrpd_paths <span class="ot">&lt;-</span>  <span class="fu">dir</span>(<span class="st">&quot;path/to/xrd&quot;</span>, <span class="at">full.names =</span> <span class="cn">TRUE</span>)</span>
<span id="cb167-6"><a href="cluster-analysis.html#cb167-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb167-7"><a href="cluster-analysis.html#cb167-7" aria-hidden="true" tabindex="-1"></a><span class="co">#Load the XRPD data</span></span>
<span id="cb167-8"><a href="cluster-analysis.html#cb167-8" aria-hidden="true" tabindex="-1"></a>xrpd <span class="ot">&lt;-</span> <span class="fu">read_xy</span>(<span class="at">files =</span> xrpd_paths)</span>
<span id="cb167-9"><a href="cluster-analysis.html#cb167-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb167-10"><a href="cluster-analysis.html#cb167-10" aria-hidden="true" tabindex="-1"></a><span class="co">#Make sure the data are interpolated onto the same 2theta scale</span></span>
<span id="cb167-11"><a href="cluster-analysis.html#cb167-11" aria-hidden="true" tabindex="-1"></a><span class="co">#as there are small differences within the dataset</span></span>
<span id="cb167-12"><a href="cluster-analysis.html#cb167-12" aria-hidden="true" tabindex="-1"></a>xrpd <span class="ot">&lt;-</span> <span class="fu">interpolate</span>(xrpd, <span class="at">new_tth =</span> xrpd<span class="sc">$</span>icr030336<span class="sc">$</span>tth)</span></code></pre></div>
<p>The resulting loaded data matches that loaded and explored in Chapter <a href="machine-learning.html#machine-learning">3</a>, with the <code>props</code> data containing a range of geochemical soil properties and the <code>xrpd</code> data containing an XY diffractogram of each sample.</p>
</div>
<div id="clustering-pca" class="section level2 hasAnchor" number="4.2">
<h2><span class="header-section-number">4.2</span> Principal component analysis<a href="cluster-analysis.html#clustering-pca" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p align="center">
<iframe width="560" height="315" src="https://www.youtube.com/embed/Jv1o7V1Kwj0" frameborder="0" allowfullscreen>
</iframe>
</p>
<p>The cluster analysis in this Chapter is applied to principal components of soil XRPD data derived using Principal Component Analysis [PCA; <span class="citation">Jolliffe (<a href="#ref-Jolliffe1986" role="doc-biblioref">1986</a>)</span>]. Prior to applying cluster analysis to the XRPD data via this approach, it is important to apply corrections for sample-independent variation such as small 2θ misalignments and/or fluctuations in count intensities. For this example, the pre-treatment routine will be based on that defined in <span class="citation">Butler et al. (<a href="#ref-Butler2020" role="doc-biblioref">2020</a>)</span>, and will involve alignment, subsetting, square root transformation and mean centering. Together these correct for common experimental aberrations so that the variation in the observed data is almost entirely sample-dependent. The pre-treatment steps used here also match those described in Section <a href="machine-learning.html#cubist-pretreatment">3.3</a> except for the additional step of square root transforming the data, which acts to reduce the relative intensity of quartz peaks that can often dominate the overall variation in diffraction data because quartz is such a strong diffractor.</p>
<p>Alignment of the data can be carried out using the <a href="intro.html#alignment"><code>align_xy()</code> function</a>, which aligns each sample within the dataset to a pure reference pattern, which in this case will be quartz that is omnipresent within the soil dataset:</p>
<div class="sourceCode" id="cb168"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb168-1"><a href="cluster-analysis.html#cb168-1" aria-hidden="true" tabindex="-1"></a><span class="co">#load the afsis reference library</span></span>
<span id="cb168-2"><a href="cluster-analysis.html#cb168-2" aria-hidden="true" tabindex="-1"></a><span class="fu">data</span>(afsis)</span>
<span id="cb168-3"><a href="cluster-analysis.html#cb168-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb168-4"><a href="cluster-analysis.html#cb168-4" aria-hidden="true" tabindex="-1"></a><span class="co">#Extract a quartz pattern from it</span></span>
<span id="cb168-5"><a href="cluster-analysis.html#cb168-5" aria-hidden="true" tabindex="-1"></a>quartz <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(afsis<span class="sc">$</span>tth,</span>
<span id="cb168-6"><a href="cluster-analysis.html#cb168-6" aria-hidden="true" tabindex="-1"></a>                     afsis<span class="sc">$</span>xrd<span class="sc">$</span>QUARTZ_1_AFSIS)</span>
<span id="cb168-7"><a href="cluster-analysis.html#cb168-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb168-8"><a href="cluster-analysis.html#cb168-8" aria-hidden="true" tabindex="-1"></a><span class="co">#Align the xrpd data to this quartz pattern</span></span>
<span id="cb168-9"><a href="cluster-analysis.html#cb168-9" aria-hidden="true" tabindex="-1"></a><span class="co">#using a restricted 2theta range of 10 to 60</span></span>
<span id="cb168-10"><a href="cluster-analysis.html#cb168-10" aria-hidden="true" tabindex="-1"></a>xrpd_aligned <span class="ot">&lt;-</span> <span class="fu">align_xy</span>(xrpd, <span class="at">std =</span> quartz,</span>
<span id="cb168-11"><a href="cluster-analysis.html#cb168-11" aria-hidden="true" tabindex="-1"></a>                         <span class="at">xmin =</span> <span class="dv">10</span>, <span class="at">xmax =</span> <span class="dv">60</span>,</span>
<span id="cb168-12"><a href="cluster-analysis.html#cb168-12" aria-hidden="true" tabindex="-1"></a>                         <span class="at">xshift =</span> <span class="fl">0.2</span>)</span></code></pre></div>
<p>Aligned data can then be subset to 2θ &gt;= 6 so that the high background at low angles (Figure <a href="machine-learning.html#fig:didy-all-fig">3.4</a>) in the data can be removed.</p>
<div class="sourceCode" id="cb169"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb169-1"><a href="cluster-analysis.html#cb169-1" aria-hidden="true" tabindex="-1"></a>xrpd_aligned_sub <span class="ot">&lt;-</span> <span class="fu">lapply</span>(xrpd_aligned, subset,</span>
<span id="cb169-2"><a href="cluster-analysis.html#cb169-2" aria-hidden="true" tabindex="-1"></a>                           tth <span class="sc">&gt;=</span> <span class="dv">6</span>)</span></code></pre></div>
<p>Following alignment, the remaining data pre-treatment steps (square root transform and mean centering) and the PCA can all be carried out in a single step using the <code>xrpd_pca()</code> function from <strong>powdR</strong>:</p>
<div class="sourceCode" id="cb170"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb170-1"><a href="cluster-analysis.html#cb170-1" aria-hidden="true" tabindex="-1"></a>pca <span class="ot">&lt;-</span> <span class="fu">xrpd_pca</span>(xrpd_aligned_sub,</span>
<span id="cb170-2"><a href="cluster-analysis.html#cb170-2" aria-hidden="true" tabindex="-1"></a>                <span class="at">mean_center =</span> <span class="cn">TRUE</span>,</span>
<span id="cb170-3"><a href="cluster-analysis.html#cb170-3" aria-hidden="true" tabindex="-1"></a>                <span class="at">root_transform =</span> <span class="dv">2</span>,</span>
<span id="cb170-4"><a href="cluster-analysis.html#cb170-4" aria-hidden="true" tabindex="-1"></a>                <span class="at">components =</span> <span class="dv">5</span>)</span>
<span id="cb170-5"><a href="cluster-analysis.html#cb170-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb170-6"><a href="cluster-analysis.html#cb170-6" aria-hidden="true" tabindex="-1"></a><span class="co">#View the variance explained by the first 5 PCs</span></span>
<span id="cb170-7"><a href="cluster-analysis.html#cb170-7" aria-hidden="true" tabindex="-1"></a>pca<span class="sc">$</span>eig[<span class="dv">1</span><span class="sc">:</span><span class="dv">5</span>,]</span></code></pre></div>
<pre><code>##       eigenvalue variance.percent cumulative.variance.percent
## Dim.1 32304.1020        81.451846                    81.45185
## Dim.2  2073.3848         5.227851                    86.67970
## Dim.3  1054.2328         2.658152                    89.33785
## Dim.4   731.3746         1.844094                    91.18194
## Dim.5   611.6932         1.542329                    92.72427</code></pre>
<p>From which it can be seen that the first 5 principal components (PCs) of the data account for 93 % of variation in the XRPD data. For simplicity this example will use the first 5 PCs hereafter, which can be plotted against one-another using the following code:</p>
<div class="sourceCode" id="cb172"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb172-1"><a href="cluster-analysis.html#cb172-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Define the x-axis components</span></span>
<span id="cb172-2"><a href="cluster-analysis.html#cb172-2" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">1</span>,</span>
<span id="cb172-3"><a href="cluster-analysis.html#cb172-3" aria-hidden="true" tabindex="-1"></a>       <span class="dv">2</span>, <span class="dv">2</span>, <span class="dv">2</span>,</span>
<span id="cb172-4"><a href="cluster-analysis.html#cb172-4" aria-hidden="true" tabindex="-1"></a>       <span class="dv">3</span>, <span class="dv">3</span>,</span>
<span id="cb172-5"><a href="cluster-analysis.html#cb172-5" aria-hidden="true" tabindex="-1"></a>       <span class="dv">4</span>)</span>
<span id="cb172-6"><a href="cluster-analysis.html#cb172-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb172-7"><a href="cluster-analysis.html#cb172-7" aria-hidden="true" tabindex="-1"></a><span class="co">#Define the y-axis components</span></span>
<span id="cb172-8"><a href="cluster-analysis.html#cb172-8" aria-hidden="true" tabindex="-1"></a>y <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">2</span>, <span class="dv">3</span>, <span class="dv">4</span>, <span class="dv">5</span>,</span>
<span id="cb172-9"><a href="cluster-analysis.html#cb172-9" aria-hidden="true" tabindex="-1"></a>       <span class="dv">3</span>, <span class="dv">4</span>, <span class="dv">5</span>,</span>
<span id="cb172-10"><a href="cluster-analysis.html#cb172-10" aria-hidden="true" tabindex="-1"></a>       <span class="dv">4</span>, <span class="dv">5</span>,</span>
<span id="cb172-11"><a href="cluster-analysis.html#cb172-11" aria-hidden="true" tabindex="-1"></a>       <span class="dv">5</span>)</span>
<span id="cb172-12"><a href="cluster-analysis.html#cb172-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb172-13"><a href="cluster-analysis.html#cb172-13" aria-hidden="true" tabindex="-1"></a><span class="co">#Create an empty list</span></span>
<span id="cb172-14"><a href="cluster-analysis.html#cb172-14" aria-hidden="true" tabindex="-1"></a>p <span class="ot">&lt;-</span> <span class="fu">list</span>()</span>
<span id="cb172-15"><a href="cluster-analysis.html#cb172-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb172-16"><a href="cluster-analysis.html#cb172-16" aria-hidden="true" tabindex="-1"></a><span class="co">#Populate each item in the list using the dimension defined</span></span>
<span id="cb172-17"><a href="cluster-analysis.html#cb172-17" aria-hidden="true" tabindex="-1"></a><span class="co">#in x and y</span></span>
<span id="cb172-18"><a href="cluster-analysis.html#cb172-18" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(x)) {</span>
<span id="cb172-19"><a href="cluster-analysis.html#cb172-19" aria-hidden="true" tabindex="-1"></a>   </span>
<span id="cb172-20"><a href="cluster-analysis.html#cb172-20" aria-hidden="true" tabindex="-1"></a>   p[[i]] <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(<span class="at">data =</span> pca<span class="sc">$</span>coords) <span class="sc">+</span></span>
<span id="cb172-21"><a href="cluster-analysis.html#cb172-21" aria-hidden="true" tabindex="-1"></a>             <span class="fu">geom_point</span>(<span class="fu">aes_string</span>(<span class="at">x =</span> <span class="fu">paste0</span>(<span class="st">&quot;Dim.&quot;</span>, x[i]),</span>
<span id="cb172-22"><a href="cluster-analysis.html#cb172-22" aria-hidden="true" tabindex="-1"></a>                                   <span class="at">y =</span> <span class="fu">paste0</span>(<span class="st">&quot;Dim.&quot;</span>, y[i])),</span>
<span id="cb172-23"><a href="cluster-analysis.html#cb172-23" aria-hidden="true" tabindex="-1"></a>                        <span class="at">shape =</span> <span class="dv">21</span>,</span>
<span id="cb172-24"><a href="cluster-analysis.html#cb172-24" aria-hidden="true" tabindex="-1"></a>                        <span class="at">size =</span> <span class="dv">3</span>)</span>
<span id="cb172-25"><a href="cluster-analysis.html#cb172-25" aria-hidden="true" tabindex="-1"></a>   </span>
<span id="cb172-26"><a href="cluster-analysis.html#cb172-26" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb172-27"><a href="cluster-analysis.html#cb172-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb172-28"><a href="cluster-analysis.html#cb172-28" aria-hidden="true" tabindex="-1"></a><span class="fu">grid.arrange</span>(<span class="at">grobs =</span> p,</span>
<span id="cb172-29"><a href="cluster-analysis.html#cb172-29" aria-hidden="true" tabindex="-1"></a>             <span class="at">ncol =</span> <span class="dv">2</span>)</span></code></pre></div>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:pc-fig"></span>
<img src="DigiMinR_files/figure-html/pc-fig-1.png" alt="The first 5 PCs plotted against one-another" width="100%" />
<p class="caption">
Figure 4.1: The first 5 PCs plotted against one-another
</p>
</div>
<div id="interpreting-principal-components" class="section level3 hasAnchor" number="4.2.1">
<h3><span class="header-section-number">4.2.1</span> Interpreting principal components<a href="cluster-analysis.html#interpreting-principal-components" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Whilst we’re able to derive that the first 5 PCs explain 93 % of variation in the XRPD data and plot the resulting variables against one-another, we are still not in a position to interpret what the scores actually mean. For example, how do increased/decreased values in Dim.1 reflect mineralogical differences in the soil samples? This interpretation can be achieved by examining the loadings of each PC dimension, for example the loading of Dim.1 can be visualised via:</p>
<div class="sourceCode" id="cb173"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb173-1"><a href="cluster-analysis.html#cb173-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> pca<span class="sc">$</span>loadings) <span class="sc">+</span></span>
<span id="cb173-2"><a href="cluster-analysis.html#cb173-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">x =</span> tth, <span class="at">y =</span> Dim<span class="fl">.1</span>)) <span class="sc">+</span></span>
<span id="cb173-3"><a href="cluster-analysis.html#cb173-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="dv">0</span>)</span></code></pre></div>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:unnamed-chunk-103"></span>
<img src="DigiMinR_files/figure-html/unnamed-chunk-103-1.png" alt="The loading of Dim.1." width="100%" />
<p class="caption">
Figure 4.2: The loading of Dim.1.
</p>
</div>
<p>These loadings represent the weights of each variable that are used when calculating the PCs. In this case, increased values of Dim.1 would result from increased intensity in the regions of the positive peaks of the loading, whereas decreased values of Dim.1 would result from increased intensity in regions of broad but negative peaks. In order to ascertain what these positive and negative features represent, it is possible to apply the full pattern summation principles outlined in Chapter <a href="quant.html#quant">2</a> to the loadings.</p>
<p>Whilst full pattern summation for quantitative analysis deals with scaling factors that should only be positive, the loadings of each PC can be modeled in a similar manner by allowing the scaling coefficients to be <em>either</em> positive <em>or</em> negative. Such analysis can be achieved using the <code>fps_lm()</code> function of <strong>powdR</strong>. This function uses linear regression to compute the scaling factor and allows you to set a p-value that can help omit unnecessary patterns from the fit. Whilst the full pattern summation outlined in Chapter <a href="quant.html#quant">2</a> results in phase quantification, <code>fps_lm()</code> is only intended to help with the identification of reference library patterns contributing to a given pattern and therefore does not require or use Reference Intensity Ratios. Below <code>fps_lm()</code> is used to model the loading of Dim.1:</p>
<div class="sourceCode" id="cb174"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb174-1"><a href="cluster-analysis.html#cb174-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Load the rockjock library</span></span>
<span id="cb174-2"><a href="cluster-analysis.html#cb174-2" aria-hidden="true" tabindex="-1"></a><span class="fu">data</span>(rockjock)</span>
<span id="cb174-3"><a href="cluster-analysis.html#cb174-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb174-4"><a href="cluster-analysis.html#cb174-4" aria-hidden="true" tabindex="-1"></a><span class="co">#Merge the rockjock and afsis libraries</span></span>
<span id="cb174-5"><a href="cluster-analysis.html#cb174-5" aria-hidden="true" tabindex="-1"></a>rockjock_afsis <span class="ot">&lt;-</span> <span class="fu">merge</span>(rockjock, afsis)</span>
<span id="cb174-6"><a href="cluster-analysis.html#cb174-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb174-7"><a href="cluster-analysis.html#cb174-7" aria-hidden="true" tabindex="-1"></a><span class="co">#All patterns in the library need to be square root transformed</span></span>
<span id="cb174-8"><a href="cluster-analysis.html#cb174-8" aria-hidden="true" tabindex="-1"></a><span class="co">#because this transformation was applied to the soil data</span></span>
<span id="cb174-9"><a href="cluster-analysis.html#cb174-9" aria-hidden="true" tabindex="-1"></a><span class="co">#during the use of xrpd_pca(). In order to avoid errors with the square</span></span>
<span id="cb174-10"><a href="cluster-analysis.html#cb174-10" aria-hidden="true" tabindex="-1"></a><span class="co">#root transforms, any reference pattern with negative counts</span></span>
<span id="cb174-11"><a href="cluster-analysis.html#cb174-11" aria-hidden="true" tabindex="-1"></a><span class="co">#must be removed from the library</span></span>
<span id="cb174-12"><a href="cluster-analysis.html#cb174-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb174-13"><a href="cluster-analysis.html#cb174-13" aria-hidden="true" tabindex="-1"></a>remove_index <span class="ot">&lt;-</span> <span class="fu">which</span>(<span class="fu">unlist</span>(<span class="fu">lapply</span>(rockjock<span class="sc">$</span>xrd, min)) <span class="sc">&lt;</span> <span class="dv">0</span>)</span>
<span id="cb174-14"><a href="cluster-analysis.html#cb174-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb174-15"><a href="cluster-analysis.html#cb174-15" aria-hidden="true" tabindex="-1"></a>rockjock_afsis <span class="ot">&lt;-</span> <span class="fu">subset</span>(rockjock_afsis,</span>
<span id="cb174-16"><a href="cluster-analysis.html#cb174-16" aria-hidden="true" tabindex="-1"></a>                         <span class="at">refs =</span> <span class="fu">names</span>(rockjock_afsis<span class="sc">$</span>xrd)[remove_index],</span>
<span id="cb174-17"><a href="cluster-analysis.html#cb174-17" aria-hidden="true" tabindex="-1"></a>                         <span class="at">mode =</span> <span class="st">&quot;remove&quot;</span>)</span>
<span id="cb174-18"><a href="cluster-analysis.html#cb174-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb174-19"><a href="cluster-analysis.html#cb174-19" aria-hidden="true" tabindex="-1"></a><span class="co">#Square root transform the counts</span></span>
<span id="cb174-20"><a href="cluster-analysis.html#cb174-20" aria-hidden="true" tabindex="-1"></a>rockjock_afsis_sqrt <span class="ot">&lt;-</span> rockjock_afsis</span>
<span id="cb174-21"><a href="cluster-analysis.html#cb174-21" aria-hidden="true" tabindex="-1"></a>rockjock_afsis_sqrt<span class="sc">$</span>xrd <span class="ot">&lt;-</span> <span class="fu">sqrt</span>(rockjock_afsis_sqrt<span class="sc">$</span>xrd)</span>
<span id="cb174-22"><a href="cluster-analysis.html#cb174-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb174-23"><a href="cluster-analysis.html#cb174-23" aria-hidden="true" tabindex="-1"></a><span class="co">#Produce a fit using a subset of common soil minerals</span></span>
<span id="cb174-24"><a href="cluster-analysis.html#cb174-24" aria-hidden="true" tabindex="-1"></a>dim1_fit <span class="ot">&lt;-</span> <span class="fu">fps_lm</span>(rockjock_afsis_sqrt,</span>
<span id="cb174-25"><a href="cluster-analysis.html#cb174-25" aria-hidden="true" tabindex="-1"></a>                   <span class="at">smpl =</span> <span class="fu">data.frame</span>(pca<span class="sc">$</span>loadings<span class="sc">$</span>tth,</span>
<span id="cb174-26"><a href="cluster-analysis.html#cb174-26" aria-hidden="true" tabindex="-1"></a>                                     pca<span class="sc">$</span>loadings<span class="sc">$</span>Dim<span class="fl">.1</span>),</span>
<span id="cb174-27"><a href="cluster-analysis.html#cb174-27" aria-hidden="true" tabindex="-1"></a>                   <span class="at">refs =</span> <span class="fu">c</span>(<span class="st">&quot;Quartz&quot;</span>,</span>
<span id="cb174-28"><a href="cluster-analysis.html#cb174-28" aria-hidden="true" tabindex="-1"></a>                            <span class="st">&quot;Organic matter&quot;</span>,</span>
<span id="cb174-29"><a href="cluster-analysis.html#cb174-29" aria-hidden="true" tabindex="-1"></a>                            <span class="st">&quot;Plagioclase&quot;</span>,</span>
<span id="cb174-30"><a href="cluster-analysis.html#cb174-30" aria-hidden="true" tabindex="-1"></a>                            <span class="st">&quot;K-feldspar&quot;</span>,</span>
<span id="cb174-31"><a href="cluster-analysis.html#cb174-31" aria-hidden="true" tabindex="-1"></a>                            <span class="st">&quot;Goethite&quot;</span>,</span>
<span id="cb174-32"><a href="cluster-analysis.html#cb174-32" aria-hidden="true" tabindex="-1"></a>                            <span class="st">&quot;Illite&quot;</span>,</span>
<span id="cb174-33"><a href="cluster-analysis.html#cb174-33" aria-hidden="true" tabindex="-1"></a>                            <span class="st">&quot;Mica (Di)&quot;</span>,</span>
<span id="cb174-34"><a href="cluster-analysis.html#cb174-34" aria-hidden="true" tabindex="-1"></a>                            <span class="st">&quot;Kaolinite&quot;</span>,</span>
<span id="cb174-35"><a href="cluster-analysis.html#cb174-35" aria-hidden="true" tabindex="-1"></a>                            <span class="st">&quot;Halloysite&quot;</span>,</span>
<span id="cb174-36"><a href="cluster-analysis.html#cb174-36" aria-hidden="true" tabindex="-1"></a>                            <span class="st">&quot;Dickite&quot;</span>,</span>
<span id="cb174-37"><a href="cluster-analysis.html#cb174-37" aria-hidden="true" tabindex="-1"></a>                            <span class="st">&quot;Smectite (Di)&quot;</span>,</span>
<span id="cb174-38"><a href="cluster-analysis.html#cb174-38" aria-hidden="true" tabindex="-1"></a>                            <span class="st">&quot;Smectite (ML)&quot;</span>,</span>
<span id="cb174-39"><a href="cluster-analysis.html#cb174-39" aria-hidden="true" tabindex="-1"></a>                            <span class="st">&quot;Goethite&quot;</span>,</span>
<span id="cb174-40"><a href="cluster-analysis.html#cb174-40" aria-hidden="true" tabindex="-1"></a>                            <span class="st">&quot;Gibbsite&quot;</span>,</span>
<span id="cb174-41"><a href="cluster-analysis.html#cb174-41" aria-hidden="true" tabindex="-1"></a>                            <span class="st">&quot;Amphibole&quot;</span>,</span>
<span id="cb174-42"><a href="cluster-analysis.html#cb174-42" aria-hidden="true" tabindex="-1"></a>                            <span class="st">&quot;Calcite&quot;</span>,</span>
<span id="cb174-43"><a href="cluster-analysis.html#cb174-43" aria-hidden="true" tabindex="-1"></a>                            <span class="st">&quot;Ferrihydrite&quot;</span>),</span>
<span id="cb174-44"><a href="cluster-analysis.html#cb174-44" aria-hidden="true" tabindex="-1"></a>                     <span class="at">std =</span> <span class="st">&quot;QUARTZ_1_AFSIS&quot;</span>,</span>
<span id="cb174-45"><a href="cluster-analysis.html#cb174-45" aria-hidden="true" tabindex="-1"></a>                     <span class="at">align =</span> <span class="dv">0</span>, <span class="co">#No alignment needed</span></span>
<span id="cb174-46"><a href="cluster-analysis.html#cb174-46" aria-hidden="true" tabindex="-1"></a>                     <span class="at">p =</span> <span class="fl">0.01</span>)</span></code></pre></div>
<pre><code>## 
## -Harmonising sample to the same 2theta resolution as the library
## -Applying linear regression
## -Removing coefficients with p-value greater than 0.01
## -Removing coefficients with p-value greater than 0.01
## -Removing coefficients with p-value greater than 0.01
## ***Full pattern summation complete***</code></pre>
<div class="sourceCode" id="cb176"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb176-1"><a href="cluster-analysis.html#cb176-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(dim1_fit, <span class="at">wavelength =</span> <span class="st">&quot;Cu&quot;</span>, <span class="at">group =</span> <span class="cn">TRUE</span>)</span></code></pre></div>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:unnamed-chunk-104"></span>
<img src="DigiMinR_files/figure-html/unnamed-chunk-104-1.png" alt="Full pattern summation applied to the loading of Dim.1." width="100%" />
<p class="caption">
Figure 4.3: Full pattern summation applied to the loading of Dim.1.
</p>
</div>
<div class="sourceCode" id="cb177"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb177-1"><a href="cluster-analysis.html#cb177-1" aria-hidden="true" tabindex="-1"></a>dim1_fit<span class="sc">$</span>phases_grouped[<span class="fu">order</span>(dim1_fit<span class="sc">$</span>phases_grouped<span class="sc">$</span>coefficient),]</span></code></pre></div>
<pre><code>##        phase_name   coefficient
## 11         Quartz -3.081022e-03
## 8      K-feldspar -3.169293e-05
## 12  Smectite (Di) -2.213481e-05
## 9  Organic matter  1.171259e-05
## 7          Illite  1.672584e-05
## 4    Ferrihydrite  1.692329e-05
## 1       Amphibole  2.371968e-05
## 5        Gibbsite  2.664863e-05
## 6        Goethite  3.529204e-05
## 3         Dickite  3.673291e-05
## 2         Calcite  6.545188e-05
## 10    Plagioclase  1.048826e-04
## 13  Smectite (ML)  2.813015e-04</code></pre>
<p>By interpreting the plot (particularly using <code>interactive = TRUE</code>) and the coefficients it can be seen that more negative Dim.1 scores are promoted by increased intensity of quartz peaks, whereas more positive Dim.1 scores are promoted by increased intensity of Smectite peaks. Dim.1 can therefore be interpreted to broadly represent the acid-basic gradient of soil parent materials. Applying the same analysis to the loading of Dim.2 yields a very different interpretation:</p>
<div class="sourceCode" id="cb179"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb179-1"><a href="cluster-analysis.html#cb179-1" aria-hidden="true" tabindex="-1"></a>dim2_fit <span class="ot">&lt;-</span> <span class="fu">fps_lm</span>(rockjock_afsis_sqrt,</span>
<span id="cb179-2"><a href="cluster-analysis.html#cb179-2" aria-hidden="true" tabindex="-1"></a>                   <span class="at">smpl =</span> <span class="fu">data.frame</span>(pca<span class="sc">$</span>loadings<span class="sc">$</span>tth,</span>
<span id="cb179-3"><a href="cluster-analysis.html#cb179-3" aria-hidden="true" tabindex="-1"></a>                                     pca<span class="sc">$</span>loadings<span class="sc">$</span>Dim<span class="fl">.2</span>),</span>
<span id="cb179-4"><a href="cluster-analysis.html#cb179-4" aria-hidden="true" tabindex="-1"></a>                   <span class="at">refs =</span> <span class="fu">c</span>(<span class="st">&quot;Quartz&quot;</span>,</span>
<span id="cb179-5"><a href="cluster-analysis.html#cb179-5" aria-hidden="true" tabindex="-1"></a>                            <span class="st">&quot;Organic matter&quot;</span>,</span>
<span id="cb179-6"><a href="cluster-analysis.html#cb179-6" aria-hidden="true" tabindex="-1"></a>                            <span class="st">&quot;Plagioclase&quot;</span>,</span>
<span id="cb179-7"><a href="cluster-analysis.html#cb179-7" aria-hidden="true" tabindex="-1"></a>                            <span class="st">&quot;K-feldspar&quot;</span>,</span>
<span id="cb179-8"><a href="cluster-analysis.html#cb179-8" aria-hidden="true" tabindex="-1"></a>                            <span class="st">&quot;Goethite&quot;</span>,</span>
<span id="cb179-9"><a href="cluster-analysis.html#cb179-9" aria-hidden="true" tabindex="-1"></a>                            <span class="st">&quot;Illite&quot;</span>,</span>
<span id="cb179-10"><a href="cluster-analysis.html#cb179-10" aria-hidden="true" tabindex="-1"></a>                            <span class="st">&quot;Mica (Di)&quot;</span>,</span>
<span id="cb179-11"><a href="cluster-analysis.html#cb179-11" aria-hidden="true" tabindex="-1"></a>                            <span class="st">&quot;Kaolinite&quot;</span>,</span>
<span id="cb179-12"><a href="cluster-analysis.html#cb179-12" aria-hidden="true" tabindex="-1"></a>                            <span class="st">&quot;Halloysite&quot;</span>,</span>
<span id="cb179-13"><a href="cluster-analysis.html#cb179-13" aria-hidden="true" tabindex="-1"></a>                            <span class="st">&quot;Dickite&quot;</span>,</span>
<span id="cb179-14"><a href="cluster-analysis.html#cb179-14" aria-hidden="true" tabindex="-1"></a>                            <span class="st">&quot;Smectite (Di)&quot;</span>,</span>
<span id="cb179-15"><a href="cluster-analysis.html#cb179-15" aria-hidden="true" tabindex="-1"></a>                            <span class="st">&quot;Smectite (ML)&quot;</span>,</span>
<span id="cb179-16"><a href="cluster-analysis.html#cb179-16" aria-hidden="true" tabindex="-1"></a>                            <span class="st">&quot;Goethite&quot;</span>,</span>
<span id="cb179-17"><a href="cluster-analysis.html#cb179-17" aria-hidden="true" tabindex="-1"></a>                            <span class="st">&quot;Gibbsite&quot;</span>,</span>
<span id="cb179-18"><a href="cluster-analysis.html#cb179-18" aria-hidden="true" tabindex="-1"></a>                            <span class="st">&quot;Amphibole&quot;</span>,</span>
<span id="cb179-19"><a href="cluster-analysis.html#cb179-19" aria-hidden="true" tabindex="-1"></a>                            <span class="st">&quot;Calcite&quot;</span>,</span>
<span id="cb179-20"><a href="cluster-analysis.html#cb179-20" aria-hidden="true" tabindex="-1"></a>                            <span class="st">&quot;Ferrihydrite&quot;</span>),</span>
<span id="cb179-21"><a href="cluster-analysis.html#cb179-21" aria-hidden="true" tabindex="-1"></a>                     <span class="at">std =</span> <span class="st">&quot;QUARTZ_1_AFSIS&quot;</span>,</span>
<span id="cb179-22"><a href="cluster-analysis.html#cb179-22" aria-hidden="true" tabindex="-1"></a>                     <span class="at">align =</span> <span class="dv">0</span>, <span class="co">#No alignment needed</span></span>
<span id="cb179-23"><a href="cluster-analysis.html#cb179-23" aria-hidden="true" tabindex="-1"></a>                     <span class="at">p =</span> <span class="fl">0.01</span>)</span></code></pre></div>
<pre><code>## 
## -Harmonising sample to the same 2theta resolution as the library
## -Applying linear regression
## -Removing coefficients with p-value greater than 0.01
## -Removing coefficients with p-value greater than 0.01
## ***Full pattern summation complete***</code></pre>
<div class="sourceCode" id="cb181"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb181-1"><a href="cluster-analysis.html#cb181-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(dim2_fit, <span class="at">wavelength =</span> <span class="st">&quot;Cu&quot;</span>, <span class="at">group =</span> <span class="cn">TRUE</span>)</span></code></pre></div>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:unnamed-chunk-105"></span>
<img src="DigiMinR_files/figure-html/unnamed-chunk-105-1.png" alt="Full pattern summation applied to the loading of Dim.2." width="100%" />
<p class="caption">
Figure 4.4: Full pattern summation applied to the loading of Dim.2.
</p>
</div>
<div class="sourceCode" id="cb182"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb182-1"><a href="cluster-analysis.html#cb182-1" aria-hidden="true" tabindex="-1"></a>dim2_fit<span class="sc">$</span>phases_grouped[<span class="fu">order</span>(dim2_fit<span class="sc">$</span>phases_grouped<span class="sc">$</span>coefficient),]</span></code></pre></div>
<pre><code>##        phase_name   coefficient
## 12    Plagioclase -1.209673e-03
## 9      K-feldspar -9.533729e-04
## 2         Calcite -4.138665e-04
## 8          Illite -3.952620e-04
## 15  Smectite (ML) -3.182366e-04
## 7      Halloysite -1.450224e-04
## 11 Organic matter -7.906963e-05
## 4    Ferrihydrite -5.087144e-05
## 1       Amphibole -3.251187e-05
## 13         Quartz  1.990181e-05
## 6        Goethite  4.349864e-05
## 14  Smectite (Di)  1.256807e-04
## 3         Dickite  1.287611e-04
## 5        Gibbsite  1.935992e-04
## 10      Kaolinite  9.066849e-04</code></pre>
<p>with more negative scores associated with increased plagioclase and K-feldspar peak intensities, and more positive scores associated with increased kaolinite and gibbsite peak intensities. Dim.2 can therefore be interpreted to represent an index of chemical alteration, with higher values representing a greater degree of alteration (i.e. the weathering of feldspars to kaolinite and gibbsite and associated loss of base cations). The same analysis can be applied for the interpretation of subsequent PCA dimensions, but can become increasingly challenging when the loading vector becomes comprised of minor or diffuse features of the XRPD data.</p>
</div>
</div>
<div id="fuzzy-clustering" class="section level2 hasAnchor" number="4.3">
<h2><span class="header-section-number">4.3</span> Fuzzy clustering<a href="cluster-analysis.html#fuzzy-clustering" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p align="center">
<iframe width="560" height="315" src="https://www.youtube.com/embed/dmkzs-sdIZ4" frameborder="0" allowfullscreen>
</iframe>
</p>
<p>Cluster analysis will be now applied to the 5 PCs plotted in Figure <a href="cluster-analysis.html#fig:pc-fig">4.1</a> using fuzzy-c-means clustering algorithm implemented in the <strong>e1071</strong> package <span class="citation">(<a href="#ref-e1071" role="doc-biblioref">Meyer et al. 2021</a>)</span>.</p>
<p>When applying cluster analysis, the selection of the most appropriate number of clusters can prove to be subjective and, in some cases, difficult. There are a number of approaches that can be used to objectively define the most appropriate number of clusters <span class="citation">(<a href="#ref-Rossel2016" role="doc-biblioref">Rossel et al. 2016</a>; <a href="#ref-Butler2020" role="doc-biblioref">Butler et al. 2020</a>)</span>, but for simplicity the number of clusters used in this example will be manually defined as 9:</p>
<div class="sourceCode" id="cb184"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb184-1"><a href="cluster-analysis.html#cb184-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Apply the fuzzy-c-means algorithm to the PCs</span></span>
<span id="cb184-2"><a href="cluster-analysis.html#cb184-2" aria-hidden="true" tabindex="-1"></a>fcm <span class="ot">&lt;-</span> <span class="fu">cmeans</span>(pca<span class="sc">$</span>coords[<span class="sc">-</span><span class="dv">1</span>],</span>
<span id="cb184-3"><a href="cluster-analysis.html#cb184-3" aria-hidden="true" tabindex="-1"></a>              <span class="at">center =</span> <span class="dv">9</span>)</span>
<span id="cb184-4"><a href="cluster-analysis.html#cb184-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb184-5"><a href="cluster-analysis.html#cb184-5" aria-hidden="true" tabindex="-1"></a><span class="co">#check the data are in the same order</span></span>
<span id="cb184-6"><a href="cluster-analysis.html#cb184-6" aria-hidden="true" tabindex="-1"></a><span class="fu">identical</span>(<span class="fu">names</span>(fcm<span class="sc">$</span>cluster), pca<span class="sc">$</span>coords<span class="sc">$</span>sample_id)</span></code></pre></div>
<pre><code>## [1] TRUE</code></pre>
<div class="sourceCode" id="cb186"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb186-1"><a href="cluster-analysis.html#cb186-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Join the data together</span></span>
<span id="cb186-2"><a href="cluster-analysis.html#cb186-2" aria-hidden="true" tabindex="-1"></a>clusters <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="st">&quot;SSN&quot;</span> <span class="ot">=</span> <span class="fu">names</span>(fcm<span class="sc">$</span>cluster),</span>
<span id="cb186-3"><a href="cluster-analysis.html#cb186-3" aria-hidden="true" tabindex="-1"></a>                       <span class="st">&quot;CLUSTER&quot;</span> <span class="ot">=</span> <span class="fu">paste0</span>(<span class="st">&quot;C&quot;</span>, <span class="fu">unname</span>(fcm<span class="sc">$</span>cluster)),</span>
<span id="cb186-4"><a href="cluster-analysis.html#cb186-4" aria-hidden="true" tabindex="-1"></a>                       pca<span class="sc">$</span>coords[<span class="sc">-</span><span class="dv">1</span>])</span>
<span id="cb186-5"><a href="cluster-analysis.html#cb186-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb186-6"><a href="cluster-analysis.html#cb186-6" aria-hidden="true" tabindex="-1"></a><span class="co">#Reorder the clusters based on Dim.1</span></span>
<span id="cb186-7"><a href="cluster-analysis.html#cb186-7" aria-hidden="true" tabindex="-1"></a><span class="co">#Lowest mean Dim.1 will be Cluster 1</span></span>
<span id="cb186-8"><a href="cluster-analysis.html#cb186-8" aria-hidden="true" tabindex="-1"></a><span class="co">#Highest mean Dim.1 will be Cluster 9</span></span>
<span id="cb186-9"><a href="cluster-analysis.html#cb186-9" aria-hidden="true" tabindex="-1"></a>dim1_mean <span class="ot">&lt;-</span> <span class="fu">aggregate</span>(Dim<span class="fl">.1</span> <span class="sc">~</span> CLUSTER,</span>
<span id="cb186-10"><a href="cluster-analysis.html#cb186-10" aria-hidden="true" tabindex="-1"></a>                       <span class="at">data =</span> clusters,</span>
<span id="cb186-11"><a href="cluster-analysis.html#cb186-11" aria-hidden="true" tabindex="-1"></a>                       <span class="at">FUN =</span> mean)</span>
<span id="cb186-12"><a href="cluster-analysis.html#cb186-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb186-13"><a href="cluster-analysis.html#cb186-13" aria-hidden="true" tabindex="-1"></a><span class="co">#Order so that the Dim.1 mean is ascending</span></span>
<span id="cb186-14"><a href="cluster-analysis.html#cb186-14" aria-hidden="true" tabindex="-1"></a>dim1_mean <span class="ot">&lt;-</span> dim1_mean[<span class="fu">order</span>(dim1_mean<span class="sc">$</span>Dim<span class="fl">.1</span>),]</span>
<span id="cb186-15"><a href="cluster-analysis.html#cb186-15" aria-hidden="true" tabindex="-1"></a>dim1_mean<span class="sc">$</span>NEW_CLUSTER <span class="ot">&lt;-</span> <span class="fu">paste0</span>(<span class="st">&quot;C&quot;</span>, <span class="dv">1</span><span class="sc">:</span><span class="fu">nrow</span>(dim1_mean))</span>
<span id="cb186-16"><a href="cluster-analysis.html#cb186-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb186-17"><a href="cluster-analysis.html#cb186-17" aria-hidden="true" tabindex="-1"></a><span class="co">#Create a named vector that will be used to revalue cluster names</span></span>
<span id="cb186-18"><a href="cluster-analysis.html#cb186-18" aria-hidden="true" tabindex="-1"></a><span class="co">#Values of the vector are the new values, and old values are the names</span></span>
<span id="cb186-19"><a href="cluster-analysis.html#cb186-19" aria-hidden="true" tabindex="-1"></a>rv <span class="ot">&lt;-</span> <span class="fu">setNames</span>(dim1_mean<span class="sc">$</span>NEW_CLUSTER, <span class="co"># the vector values</span></span>
<span id="cb186-20"><a href="cluster-analysis.html#cb186-20" aria-hidden="true" tabindex="-1"></a>               dim1_mean<span class="sc">$</span>CLUSTER) <span class="co">#the vector names </span></span>
<span id="cb186-21"><a href="cluster-analysis.html#cb186-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb186-22"><a href="cluster-analysis.html#cb186-22" aria-hidden="true" tabindex="-1"></a><span class="co">#use the revalue function to create a new cluster column</span></span>
<span id="cb186-23"><a href="cluster-analysis.html#cb186-23" aria-hidden="true" tabindex="-1"></a>clusters<span class="sc">$</span>NEW_CLUSTER <span class="ot">&lt;-</span> <span class="fu">revalue</span>(clusters<span class="sc">$</span>CLUSTER,</span>
<span id="cb186-24"><a href="cluster-analysis.html#cb186-24" aria-hidden="true" tabindex="-1"></a>                                rv)</span>
<span id="cb186-25"><a href="cluster-analysis.html#cb186-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb186-26"><a href="cluster-analysis.html#cb186-26" aria-hidden="true" tabindex="-1"></a><span class="co">#Create an empty list</span></span>
<span id="cb186-27"><a href="cluster-analysis.html#cb186-27" aria-hidden="true" tabindex="-1"></a>p <span class="ot">&lt;-</span> <span class="fu">list</span>()</span>
<span id="cb186-28"><a href="cluster-analysis.html#cb186-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb186-29"><a href="cluster-analysis.html#cb186-29" aria-hidden="true" tabindex="-1"></a><span class="co">#Populate each item in the list using the dimension already</span></span>
<span id="cb186-30"><a href="cluster-analysis.html#cb186-30" aria-hidden="true" tabindex="-1"></a><span class="co">#defined in x and y above</span></span>
<span id="cb186-31"><a href="cluster-analysis.html#cb186-31" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(x)) {</span>
<span id="cb186-32"><a href="cluster-analysis.html#cb186-32" aria-hidden="true" tabindex="-1"></a>   </span>
<span id="cb186-33"><a href="cluster-analysis.html#cb186-33" aria-hidden="true" tabindex="-1"></a>   p[[i]] <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(<span class="at">data =</span> clusters) <span class="sc">+</span></span>
<span id="cb186-34"><a href="cluster-analysis.html#cb186-34" aria-hidden="true" tabindex="-1"></a>             <span class="fu">geom_point</span>(<span class="fu">aes_string</span>(<span class="at">x =</span> <span class="fu">paste0</span>(<span class="st">&quot;Dim.&quot;</span>, x[i]),</span>
<span id="cb186-35"><a href="cluster-analysis.html#cb186-35" aria-hidden="true" tabindex="-1"></a>                                   <span class="at">y =</span> <span class="fu">paste0</span>(<span class="st">&quot;Dim.&quot;</span>, y[i]),</span>
<span id="cb186-36"><a href="cluster-analysis.html#cb186-36" aria-hidden="true" tabindex="-1"></a>                                   <span class="at">fill =</span> <span class="st">&quot;NEW_CLUSTER&quot;</span>),</span>
<span id="cb186-37"><a href="cluster-analysis.html#cb186-37" aria-hidden="true" tabindex="-1"></a>                        <span class="at">shape =</span> <span class="dv">21</span>,</span>
<span id="cb186-38"><a href="cluster-analysis.html#cb186-38" aria-hidden="true" tabindex="-1"></a>                        <span class="at">size =</span> <span class="dv">3</span>,</span>
<span id="cb186-39"><a href="cluster-analysis.html#cb186-39" aria-hidden="true" tabindex="-1"></a>                        <span class="at">alpha =</span> <span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb186-40"><a href="cluster-analysis.html#cb186-40" aria-hidden="true" tabindex="-1"></a>             <span class="fu">guides</span>(<span class="at">fill =</span> <span class="fu">guide_legend</span>(<span class="at">title=</span><span class="st">&quot;Cluster&quot;</span>))</span>
<span id="cb186-41"><a href="cluster-analysis.html#cb186-41" aria-hidden="true" tabindex="-1"></a>   </span>
<span id="cb186-42"><a href="cluster-analysis.html#cb186-42" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb186-43"><a href="cluster-analysis.html#cb186-43" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb186-44"><a href="cluster-analysis.html#cb186-44" aria-hidden="true" tabindex="-1"></a><span class="fu">grid.arrange</span>(<span class="at">grobs =</span> p,</span>
<span id="cb186-45"><a href="cluster-analysis.html#cb186-45" aria-hidden="true" tabindex="-1"></a>             <span class="at">ncol =</span> <span class="dv">2</span>)</span></code></pre></div>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:cluster-fig"></span>
<img src="DigiMinR_files/figure-html/cluster-fig-1.png" alt="Pre-treated XRPD data clustered into 9 groups." width="100%" />
<p class="caption">
Figure 4.5: Pre-treated XRPD data clustered into 9 groups.
</p>
</div>
<div id="cluster-membership" class="section level3 hasAnchor" number="4.3.1">
<h3><span class="header-section-number">4.3.1</span> Cluster membership<a href="cluster-analysis.html#cluster-membership" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Use of the fuzzy-c-means clustering algorithm results in every sample having a membership coefficient for each cluster. These membership coefficients range from 0 to 1, with 1 being the highest degree of membership. Below these membership coefficients will be plotted using the first 2 PCs in order to help visualise the ‘fuzzy’ nature of the clustering:</p>
<div class="sourceCode" id="cb187"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb187-1"><a href="cluster-analysis.html#cb187-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Extract the membership coefficients</span></span>
<span id="cb187-2"><a href="cluster-analysis.html#cb187-2" aria-hidden="true" tabindex="-1"></a>members <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(fcm<span class="sc">$</span>membership, <span class="at">check.names =</span> <span class="cn">FALSE</span>)</span>
<span id="cb187-3"><a href="cluster-analysis.html#cb187-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb187-4"><a href="cluster-analysis.html#cb187-4" aria-hidden="true" tabindex="-1"></a><span class="co">#Add C to all the names to match that used above.</span></span>
<span id="cb187-5"><a href="cluster-analysis.html#cb187-5" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(members) <span class="ot">&lt;-</span> <span class="fu">paste0</span>(<span class="st">&quot;C&quot;</span>, <span class="fu">names</span>(members))</span>
<span id="cb187-6"><a href="cluster-analysis.html#cb187-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb187-7"><a href="cluster-analysis.html#cb187-7" aria-hidden="true" tabindex="-1"></a><span class="co">#revalue the names based on the new clustering order</span></span>
<span id="cb187-8"><a href="cluster-analysis.html#cb187-8" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(members) <span class="ot">&lt;-</span> <span class="fu">revalue</span>(<span class="fu">names</span>(members), rv)</span>
<span id="cb187-9"><a href="cluster-analysis.html#cb187-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb187-10"><a href="cluster-analysis.html#cb187-10" aria-hidden="true" tabindex="-1"></a><span class="co">#Add membership to the name</span></span>
<span id="cb187-11"><a href="cluster-analysis.html#cb187-11" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(members) <span class="ot">&lt;-</span> <span class="fu">paste0</span>(<span class="st">&quot;Membership_&quot;</span>, <span class="fu">names</span>(members))</span>
<span id="cb187-12"><a href="cluster-analysis.html#cb187-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb187-13"><a href="cluster-analysis.html#cb187-13" aria-hidden="true" tabindex="-1"></a><span class="co">#Join clusters and members</span></span>
<span id="cb187-14"><a href="cluster-analysis.html#cb187-14" aria-hidden="true" tabindex="-1"></a>members <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(clusters,</span>
<span id="cb187-15"><a href="cluster-analysis.html#cb187-15" aria-hidden="true" tabindex="-1"></a>                      members)</span>
<span id="cb187-16"><a href="cluster-analysis.html#cb187-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb187-17"><a href="cluster-analysis.html#cb187-17" aria-hidden="true" tabindex="-1"></a><span class="co">#Create and empty list for the plots</span></span>
<span id="cb187-18"><a href="cluster-analysis.html#cb187-18" aria-hidden="true" tabindex="-1"></a>p <span class="ot">&lt;-</span> <span class="fu">list</span>()</span>
<span id="cb187-19"><a href="cluster-analysis.html#cb187-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb187-20"><a href="cluster-analysis.html#cb187-20" aria-hidden="true" tabindex="-1"></a><span class="co">#Populate each item in the list using the dimension defined</span></span>
<span id="cb187-21"><a href="cluster-analysis.html#cb187-21" aria-hidden="true" tabindex="-1"></a><span class="co">#in x and y</span></span>
<span id="cb187-22"><a href="cluster-analysis.html#cb187-22" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">9</span>) {</span>
<span id="cb187-23"><a href="cluster-analysis.html#cb187-23" aria-hidden="true" tabindex="-1"></a>   </span>
<span id="cb187-24"><a href="cluster-analysis.html#cb187-24" aria-hidden="true" tabindex="-1"></a>   p[[i]] <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(<span class="at">data =</span> members) <span class="sc">+</span></span>
<span id="cb187-25"><a href="cluster-analysis.html#cb187-25" aria-hidden="true" tabindex="-1"></a>             <span class="fu">geom_point</span>(<span class="fu">aes_string</span>(<span class="at">x =</span> <span class="st">&quot;Dim.1&quot;</span>,</span>
<span id="cb187-26"><a href="cluster-analysis.html#cb187-26" aria-hidden="true" tabindex="-1"></a>                                   <span class="at">y =</span> <span class="st">&quot;Dim.2&quot;</span>,</span>
<span id="cb187-27"><a href="cluster-analysis.html#cb187-27" aria-hidden="true" tabindex="-1"></a>                                   <span class="at">fill =</span> <span class="fu">paste0</span>(<span class="st">&quot;Membership_C&quot;</span>,</span>
<span id="cb187-28"><a href="cluster-analysis.html#cb187-28" aria-hidden="true" tabindex="-1"></a>                                                 i)),</span>
<span id="cb187-29"><a href="cluster-analysis.html#cb187-29" aria-hidden="true" tabindex="-1"></a>                        <span class="at">shape =</span> <span class="dv">21</span>,</span>
<span id="cb187-30"><a href="cluster-analysis.html#cb187-30" aria-hidden="true" tabindex="-1"></a>                        <span class="at">size =</span> <span class="dv">3</span>,</span>
<span id="cb187-31"><a href="cluster-analysis.html#cb187-31" aria-hidden="true" tabindex="-1"></a>                        <span class="at">alpha =</span> <span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb187-32"><a href="cluster-analysis.html#cb187-32" aria-hidden="true" tabindex="-1"></a>             <span class="fu">ggtitle</span>(<span class="fu">paste</span>(<span class="st">&quot;Cluster&quot;</span>, i)) <span class="sc">+</span></span>
<span id="cb187-33"><a href="cluster-analysis.html#cb187-33" aria-hidden="true" tabindex="-1"></a>             <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">&quot;None&quot;</span>) <span class="sc">+</span></span>
<span id="cb187-34"><a href="cluster-analysis.html#cb187-34" aria-hidden="true" tabindex="-1"></a>             <span class="fu">scale_fill_gradient</span>(<span class="at">low =</span> <span class="st">&quot;blue&quot;</span>,</span>
<span id="cb187-35"><a href="cluster-analysis.html#cb187-35" aria-hidden="true" tabindex="-1"></a>                                 <span class="at">high =</span> <span class="st">&quot;red&quot;</span>)</span>
<span id="cb187-36"><a href="cluster-analysis.html#cb187-36" aria-hidden="true" tabindex="-1"></a>   </span>
<span id="cb187-37"><a href="cluster-analysis.html#cb187-37" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb187-38"><a href="cluster-analysis.html#cb187-38" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb187-39"><a href="cluster-analysis.html#cb187-39" aria-hidden="true" tabindex="-1"></a><span class="fu">grid.arrange</span>(<span class="at">grobs =</span> p,</span>
<span id="cb187-40"><a href="cluster-analysis.html#cb187-40" aria-hidden="true" tabindex="-1"></a>             <span class="at">ncol =</span> <span class="dv">3</span>)</span></code></pre></div>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:membership-fig"></span>
<img src="DigiMinR_files/figure-html/membership-fig-1.png" alt="Membership coefficients for the nine clusters plotted for the first two PCs. Blue symbols have low membership (~0), whilst red symbols have high membership (~1)." width="100%" />
<p class="caption">
Figure 4.6: Membership coefficients for the nine clusters plotted for the first two PCs. Blue symbols have low membership (~0), whilst red symbols have high membership (~1).
</p>
</div>
<p>Together Figures <a href="cluster-analysis.html#fig:cluster-fig">4.5</a> and <a href="cluster-analysis.html#fig:membership-fig">4.6</a> illustrate how the soil XRPD data in this data set reflect the soil mineralogy continuum, and as such can be challenging to cluster into a discrete number of groups. In particular the membership coefficients in Figure <a href="cluster-analysis.html#fig:membership-fig">4.6</a> help highlight how soils can exist on the boundary of two or more clusters and therefore have similar membership coefficients to numerous clusters. This property is characteristic of most large soil data sets, and can make it challenging to define very distinct clusters. However, the membership coefficients data can be used so that only samples with the highest coefficients are retained, resulting in more distinct mineralogical groups that do no overlap.</p>
</div>
<div id="subsetting-clusters" class="section level3 hasAnchor" number="4.3.2">
<h3><span class="header-section-number">4.3.2</span> Subsetting Clusters<a href="cluster-analysis.html#subsetting-clusters" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Here, more mineralogically distinct clusters will be created by only retaining samples within each cluster that have a membership coefficient exceeding the 75<sup>th</sup> percentile:</p>
<div class="sourceCode" id="cb188"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb188-1"><a href="cluster-analysis.html#cb188-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Create a blank name to populate with the unique SSNs</span></span>
<span id="cb188-2"><a href="cluster-analysis.html#cb188-2" aria-hidden="true" tabindex="-1"></a>member_ssn <span class="ot">&lt;-</span> <span class="fu">list</span>()</span>
<span id="cb188-3"><a href="cluster-analysis.html#cb188-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb188-4"><a href="cluster-analysis.html#cb188-4" aria-hidden="true" tabindex="-1"></a><span class="co">#A loop to omit samples from each cluster with low membership coefficient</span></span>
<span id="cb188-5"><a href="cluster-analysis.html#cb188-5" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">9</span>) {</span>
<span id="cb188-6"><a href="cluster-analysis.html#cb188-6" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb188-7"><a href="cluster-analysis.html#cb188-7" aria-hidden="true" tabindex="-1"></a>  memberships <span class="ot">&lt;-</span> members[<span class="fu">which</span>(members<span class="sc">$</span>NEW_CLUSTER <span class="sc">==</span> <span class="fu">paste0</span>(<span class="st">&quot;C&quot;</span>, i)),</span>
<span id="cb188-8"><a href="cluster-analysis.html#cb188-8" aria-hidden="true" tabindex="-1"></a>                         <span class="fu">c</span>(<span class="st">&quot;SSN&quot;</span>, <span class="fu">paste0</span>(<span class="st">&quot;Membership_C&quot;</span>, i))]</span>
<span id="cb188-9"><a href="cluster-analysis.html#cb188-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb188-10"><a href="cluster-analysis.html#cb188-10" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb188-11"><a href="cluster-analysis.html#cb188-11" aria-hidden="true" tabindex="-1"></a>  <span class="co">#Extract the samples with top 25 % of membership coefficient for each cluster</span></span>
<span id="cb188-12"><a href="cluster-analysis.html#cb188-12" aria-hidden="true" tabindex="-1"></a>  memberships_75 <span class="ot">&lt;-</span> <span class="fu">which</span>(memberships[[<span class="dv">2</span>]] <span class="sc">&gt;</span> <span class="fu">quantile</span>(memberships[[<span class="dv">2</span>]],</span>
<span id="cb188-13"><a href="cluster-analysis.html#cb188-13" aria-hidden="true" tabindex="-1"></a>                                                      <span class="at">probs =</span> <span class="fl">0.75</span>))</span>
<span id="cb188-14"><a href="cluster-analysis.html#cb188-14" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb188-15"><a href="cluster-analysis.html#cb188-15" aria-hidden="true" tabindex="-1"></a>  member_ssn[[i]] <span class="ot">&lt;-</span> memberships<span class="sc">$</span>SSN[memberships_75]</span>
<span id="cb188-16"><a href="cluster-analysis.html#cb188-16" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb188-17"><a href="cluster-analysis.html#cb188-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">names</span>(member_ssn)[i] <span class="ot">&lt;-</span> <span class="fu">paste0</span>(<span class="st">&quot;C&quot;</span>, i)</span>
<span id="cb188-18"><a href="cluster-analysis.html#cb188-18" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb188-19"><a href="cluster-analysis.html#cb188-19" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb188-20"><a href="cluster-analysis.html#cb188-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb188-21"><a href="cluster-analysis.html#cb188-21" aria-hidden="true" tabindex="-1"></a><span class="co">#Unlist the indexes</span></span>
<span id="cb188-22"><a href="cluster-analysis.html#cb188-22" aria-hidden="true" tabindex="-1"></a>member_ssn <span class="ot">&lt;-</span> <span class="fu">unname</span>(<span class="fu">unlist</span>(member_ssn))</span>
<span id="cb188-23"><a href="cluster-analysis.html#cb188-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb188-24"><a href="cluster-analysis.html#cb188-24" aria-hidden="true" tabindex="-1"></a>members_sub <span class="ot">&lt;-</span> members[<span class="fu">which</span>(members<span class="sc">$</span>SSN <span class="sc">%in%</span> member_ssn),]</span>
<span id="cb188-25"><a href="cluster-analysis.html#cb188-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb188-26"><a href="cluster-analysis.html#cb188-26" aria-hidden="true" tabindex="-1"></a><span class="co">#Plot the results</span></span>
<span id="cb188-27"><a href="cluster-analysis.html#cb188-27" aria-hidden="true" tabindex="-1"></a><span class="co">#Create and empty list</span></span>
<span id="cb188-28"><a href="cluster-analysis.html#cb188-28" aria-hidden="true" tabindex="-1"></a>p <span class="ot">&lt;-</span> <span class="fu">list</span>()</span>
<span id="cb188-29"><a href="cluster-analysis.html#cb188-29" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb188-30"><a href="cluster-analysis.html#cb188-30" aria-hidden="true" tabindex="-1"></a><span class="co">#Populate each item in the list using the dimension defined</span></span>
<span id="cb188-31"><a href="cluster-analysis.html#cb188-31" aria-hidden="true" tabindex="-1"></a><span class="co">#in x and y</span></span>
<span id="cb188-32"><a href="cluster-analysis.html#cb188-32" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(x)) {</span>
<span id="cb188-33"><a href="cluster-analysis.html#cb188-33" aria-hidden="true" tabindex="-1"></a>   </span>
<span id="cb188-34"><a href="cluster-analysis.html#cb188-34" aria-hidden="true" tabindex="-1"></a>   p[[i]] <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(<span class="at">data =</span> members_sub) <span class="sc">+</span></span>
<span id="cb188-35"><a href="cluster-analysis.html#cb188-35" aria-hidden="true" tabindex="-1"></a>             <span class="fu">geom_point</span>(<span class="fu">aes_string</span>(<span class="at">x =</span> <span class="fu">paste0</span>(<span class="st">&quot;Dim.&quot;</span>, x[i]),</span>
<span id="cb188-36"><a href="cluster-analysis.html#cb188-36" aria-hidden="true" tabindex="-1"></a>                                   <span class="at">y =</span> <span class="fu">paste0</span>(<span class="st">&quot;Dim.&quot;</span>, y[i]),</span>
<span id="cb188-37"><a href="cluster-analysis.html#cb188-37" aria-hidden="true" tabindex="-1"></a>                                   <span class="at">fill =</span> <span class="st">&quot;NEW_CLUSTER&quot;</span>),</span>
<span id="cb188-38"><a href="cluster-analysis.html#cb188-38" aria-hidden="true" tabindex="-1"></a>                        <span class="at">shape =</span> <span class="dv">21</span>,</span>
<span id="cb188-39"><a href="cluster-analysis.html#cb188-39" aria-hidden="true" tabindex="-1"></a>                        <span class="at">size =</span> <span class="dv">3</span>,</span>
<span id="cb188-40"><a href="cluster-analysis.html#cb188-40" aria-hidden="true" tabindex="-1"></a>                        <span class="at">alpha =</span> <span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb188-41"><a href="cluster-analysis.html#cb188-41" aria-hidden="true" tabindex="-1"></a>             <span class="fu">guides</span>(<span class="at">fill =</span> <span class="fu">guide_legend</span>(<span class="at">title=</span><span class="st">&quot;Cluster&quot;</span>))</span>
<span id="cb188-42"><a href="cluster-analysis.html#cb188-42" aria-hidden="true" tabindex="-1"></a>   </span>
<span id="cb188-43"><a href="cluster-analysis.html#cb188-43" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb188-44"><a href="cluster-analysis.html#cb188-44" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb188-45"><a href="cluster-analysis.html#cb188-45" aria-hidden="true" tabindex="-1"></a><span class="fu">grid.arrange</span>(<span class="at">grobs =</span> p,</span>
<span id="cb188-46"><a href="cluster-analysis.html#cb188-46" aria-hidden="true" tabindex="-1"></a>             <span class="at">ncol =</span> <span class="dv">2</span>)</span></code></pre></div>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:unnamed-chunk-108"></span>
<img src="DigiMinR_files/figure-html/unnamed-chunk-108-1.png" alt="The formation of distinct clusters by retaining the samples within each cluster that have membership coefficients greater than the 75% percentile." width="100%" />
<p class="caption">
Figure 4.7: The formation of distinct clusters by retaining the samples within each cluster that have membership coefficients greater than the 75% percentile.
</p>
</div>
</div>
</div>
<div id="exploring-results" class="section level2 hasAnchor" number="4.4">
<h2><span class="header-section-number">4.4</span> Exploring results<a href="cluster-analysis.html#exploring-results" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p align="center">
<iframe width="560" height="315" src="https://www.youtube.com/embed/9zMK7wJGopU" frameborder="0" allowfullscreen>
</iframe>
</p>
<p>Now that a set of mineralogically distinct clusters have been defined from the data, there are a number of ways that the data can be explored in order to relate the soil mineral composition to the nutrient concentrations. Firstly, since these data are geo-referenced, the spatial distribution of each cluster can be visualised, for example:</p>
<div class="sourceCode" id="cb189"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb189-1"><a href="cluster-analysis.html#cb189-1" aria-hidden="true" tabindex="-1"></a>clust_sub <span class="ot">&lt;-</span> <span class="fu">join</span>(members_sub[<span class="fu">c</span>(<span class="st">&quot;SSN&quot;</span>, <span class="st">&quot;NEW_CLUSTER&quot;</span>)],</span>
<span id="cb189-2"><a href="cluster-analysis.html#cb189-2" aria-hidden="true" tabindex="-1"></a>                  props, <span class="at">by =</span> <span class="st">&quot;SSN&quot;</span>) </span>
<span id="cb189-3"><a href="cluster-analysis.html#cb189-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb189-4"><a href="cluster-analysis.html#cb189-4" aria-hidden="true" tabindex="-1"></a><span class="co">#Plot cluster 9</span></span>
<span id="cb189-5"><a href="cluster-analysis.html#cb189-5" aria-hidden="true" tabindex="-1"></a><span class="fu">leaflet</span>(clust_sub[<span class="fu">which</span>(clust_sub<span class="sc">$</span>NEW_CLUSTER <span class="sc">==</span> <span class="st">&quot;C1&quot;</span>), ]) <span class="sc">%&gt;%</span> </span>
<span id="cb189-6"><a href="cluster-analysis.html#cb189-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">addTiles</span>() <span class="sc">%&gt;%</span></span>
<span id="cb189-7"><a href="cluster-analysis.html#cb189-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">addCircleMarkers</span>(<span class="sc">~</span>Longitude, <span class="sc">~</span>Latitude)</span></code></pre></div>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:unnamed-chunk-109"></span>
<div id="htmlwidget-9b1fd5247dd791a26165" style="width:80%;height:480px;" class="leaflet html-widget"></div>
<script type="application/json" data-for="htmlwidget-9b1fd5247dd791a26165">{"x":{"options":{"crs":{"crsClass":"L.CRS.EPSG3857","code":null,"proj4def":null,"projectedBounds":null,"options":{}}},"calls":[{"method":"addTiles","args":["https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png",null,null,{"minZoom":0,"maxZoom":18,"tileSize":256,"subdomains":"abc","errorTileUrl":"","tms":false,"noWrap":false,"zoomOffset":0,"zoomReverse":false,"opacity":1,"zIndex":1,"detectRetina":false,"attribution":"&copy; <a href=\"https://openstreetmap.org\">OpenStreetMap<\/a> contributors, <a href=\"https://creativecommons.org/licenses/by-sa/2.0/\">CC-BY-SA<\/a>"}]},{"method":"addCircleMarkers","args":[[-6.04692984,-6.11749,-6.07987,-5.30757999,-3.06374502,-3.0296979,-3.00909805,-3.06098199,-8.07075501,-22.80366,-24.24041833,-24.21673333,-24.19569833,-24.16965333,-24.24200667,14.809575,14.83139,14.83103333,14.858365,14.869855,14.80238833,14.83648167,14.853915,9.217246667,-7.337718333,-7.31389,-16.221305,-21.7232,-15.897394,-15.867407,-15.85138333],[36.4438591,36.4577,36.5067,37.47093964,33.01008606,33.01520157,33.01538086,33.03066254,37.33062744,35.31284167,34.33520333,34.37512,34.37663333,34.38194667,34.39977333,-7.843511667,-7.843868333,-7.823068333,-7.82084,-7.819491667,-7.802876667,-7.809873333,-7.781675,5.73423,15.73058833,15.76066667,14.94596167,26.4957,26.093142,26.098539,26.095875],10,null,null,{"interactive":true,"className":"","stroke":true,"color":"#03F","weight":5,"opacity":0.5,"fill":true,"fillColor":"#03F","fillOpacity":0.2},null,null,null,null,null,{"interactive":false,"permanent":false,"direction":"auto","opacity":1,"offset":[0,0],"textsize":"10px","textOnly":false,"className":"","sticky":true},null]}],"limits":{"lat":[-24.24200667,14.869855],"lng":[-7.843868333,37.47093964]}},"evals":[],"jsHooks":[]}</script>
<p class="caption">
Figure 4.8: Interactive map of the soil samples associated with Cluster 9.
</p>
</div>
<p>returns a map of the locations of all samples within Cluster 9. Even though samples within this cluster are dispersed across sub-Saharan Africa, their XRPD signals (and, hence mineralogies) are very similar, which can readily be plotted with a little manipulation of the data:</p>
<div class="sourceCode" id="cb190"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb190-1"><a href="cluster-analysis.html#cb190-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Create a blank list to populate</span></span>
<span id="cb190-2"><a href="cluster-analysis.html#cb190-2" aria-hidden="true" tabindex="-1"></a>cluster_xrpd <span class="ot">&lt;-</span> <span class="fu">list</span>()</span>
<span id="cb190-3"><a href="cluster-analysis.html#cb190-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb190-4"><a href="cluster-analysis.html#cb190-4" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">9</span>) {</span>
<span id="cb190-5"><a href="cluster-analysis.html#cb190-5" aria-hidden="true" tabindex="-1"></a>cluster_xrpd[[i]] <span class="ot">&lt;-</span> xrpd_aligned[clust_sub<span class="sc">$</span>SSN[clust_sub<span class="sc">$</span>NEW_CLUSTER <span class="sc">==</span> <span class="fu">paste0</span>(<span class="st">&quot;C&quot;</span>,i)]]</span>
<span id="cb190-6"><a href="cluster-analysis.html#cb190-6" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(cluster_xrpd)[i] <span class="ot">&lt;-</span> <span class="fu">paste0</span>(<span class="st">&quot;C&quot;</span>, i)</span>
<span id="cb190-7"><a href="cluster-analysis.html#cb190-7" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb190-8"><a href="cluster-analysis.html#cb190-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb190-9"><a href="cluster-analysis.html#cb190-9" aria-hidden="true" tabindex="-1"></a><span class="co">#Plot cluster 9</span></span>
<span id="cb190-10"><a href="cluster-analysis.html#cb190-10" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(<span class="fu">as_multi_xy</span>(cluster_xrpd<span class="sc">$</span>C1), <span class="at">wavelength =</span> <span class="st">&quot;Cu&quot;</span>, <span class="at">normalise =</span> <span class="cn">TRUE</span>)</span></code></pre></div>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:unnamed-chunk-110"></span>
<img src="DigiMinR_files/figure-html/unnamed-chunk-110-1.png" alt="Clustered pre-treated XRPD from Cluster 9." width="100%" />
<p class="caption">
Figure 4.9: Clustered pre-treated XRPD from Cluster 9.
</p>
</div>
<p>Given that the soil mineral composition ultimately governs the total concentrations of nutrients and their phyto-availability, the nine mineralogically different clusters defined here should display contrasting geochemical properties. These geochemical properties are present in the <code>props</code> data that has already been combined with the clustering data in <code>clust_sub</code>. Here the relative enrichments and deficiencies of each cluster with respect to total nutrient concentrations will be visualised using barplots <span class="citation">(<a href="#ref-Montero2010" role="doc-biblioref">Montero-Serrano et al. 2010</a>; <a href="#ref-Butler2020" role="doc-biblioref">Butler et al. 2020</a>)</span>:</p>
<div class="sourceCode" id="cb191"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb191-1"><a href="cluster-analysis.html#cb191-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Select the variables of interest</span></span>
<span id="cb191-2"><a href="cluster-analysis.html#cb191-2" aria-hidden="true" tabindex="-1"></a>total_nutrients <span class="ot">&lt;-</span> <span class="fu">subset</span>(clust_sub,</span>
<span id="cb191-3"><a href="cluster-analysis.html#cb191-3" aria-hidden="true" tabindex="-1"></a>                          <span class="at">select =</span> <span class="fu">c</span>(NEW_CLUSTER,</span>
<span id="cb191-4"><a href="cluster-analysis.html#cb191-4" aria-hidden="true" tabindex="-1"></a>                                     TOC, K, Ca,</span>
<span id="cb191-5"><a href="cluster-analysis.html#cb191-5" aria-hidden="true" tabindex="-1"></a>                                     Mn, Fe, Ni,</span>
<span id="cb191-6"><a href="cluster-analysis.html#cb191-6" aria-hidden="true" tabindex="-1"></a>                                     Cu, Zn))</span>
<span id="cb191-7"><a href="cluster-analysis.html#cb191-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb191-8"><a href="cluster-analysis.html#cb191-8" aria-hidden="true" tabindex="-1"></a><span class="co">#Create geometric mean function</span></span>
<span id="cb191-9"><a href="cluster-analysis.html#cb191-9" aria-hidden="true" tabindex="-1"></a>gmean <span class="ot">&lt;-</span> <span class="cf">function</span>(x) {<span class="fu">exp</span>(<span class="fu">mean</span>(<span class="fu">log</span>(x)))}</span>
<span id="cb191-10"><a href="cluster-analysis.html#cb191-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb191-11"><a href="cluster-analysis.html#cb191-11" aria-hidden="true" tabindex="-1"></a><span class="co">#Compute overall geometric means for each nutrient (i.e. column)</span></span>
<span id="cb191-12"><a href="cluster-analysis.html#cb191-12" aria-hidden="true" tabindex="-1"></a>total_nutrients_gmeans <span class="ot">&lt;-</span> <span class="fu">apply</span>(total_nutrients[<span class="sc">-</span><span class="dv">1</span>], <span class="dv">2</span>, gmean) </span>
<span id="cb191-13"><a href="cluster-analysis.html#cb191-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb191-14"><a href="cluster-analysis.html#cb191-14" aria-hidden="true" tabindex="-1"></a><span class="co">#Compute the geometric mean for each nutrient by cluster</span></span>
<span id="cb191-15"><a href="cluster-analysis.html#cb191-15" aria-hidden="true" tabindex="-1"></a>cluster_gmeans <span class="ot">&lt;-</span> <span class="fu">by</span>(total_nutrients[<span class="sc">-</span><span class="dv">1</span>],</span>
<span id="cb191-16"><a href="cluster-analysis.html#cb191-16" aria-hidden="true" tabindex="-1"></a>                     <span class="fu">as.factor</span>(total_nutrients<span class="sc">$</span>NEW_CLUSTER),</span>
<span id="cb191-17"><a href="cluster-analysis.html#cb191-17" aria-hidden="true" tabindex="-1"></a>                     <span class="cf">function</span>(x) <span class="fu">apply</span>(x, <span class="dv">2</span>, gmean))</span>
<span id="cb191-18"><a href="cluster-analysis.html#cb191-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb191-19"><a href="cluster-analysis.html#cb191-19" aria-hidden="true" tabindex="-1"></a><span class="co">#Bind the data by row</span></span>
<span id="cb191-20"><a href="cluster-analysis.html#cb191-20" aria-hidden="true" tabindex="-1"></a>cluster_gmeans <span class="ot">&lt;-</span> <span class="fu">do.call</span>(rbind, cluster_gmeans)</span>
<span id="cb191-21"><a href="cluster-analysis.html#cb191-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb191-22"><a href="cluster-analysis.html#cb191-22" aria-hidden="true" tabindex="-1"></a><span class="co">#Calculate log-ratios by dividing by the geometric mean</span></span>
<span id="cb191-23"><a href="cluster-analysis.html#cb191-23" aria-hidden="true" tabindex="-1"></a><span class="co">#of each nutrient</span></span>
<span id="cb191-24"><a href="cluster-analysis.html#cb191-24" aria-hidden="true" tabindex="-1"></a>bp <span class="ot">&lt;-</span> <span class="fu">apply</span>(cluster_gmeans,<span class="dv">1</span>,</span>
<span id="cb191-25"><a href="cluster-analysis.html#cb191-25" aria-hidden="true" tabindex="-1"></a>            <span class="cf">function</span>(x) <span class="fu">log</span>(x<span class="sc">/</span>total_nutrients_gmeans))</span>
<span id="cb191-26"><a href="cluster-analysis.html#cb191-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb191-27"><a href="cluster-analysis.html#cb191-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb191-28"><a href="cluster-analysis.html#cb191-28" aria-hidden="true" tabindex="-1"></a><span class="co">#Use melt from the reshape2 package so that the data are</span></span>
<span id="cb191-29"><a href="cluster-analysis.html#cb191-29" aria-hidden="true" tabindex="-1"></a><span class="co">#in the right format for ggplot2:</span></span>
<span id="cb191-30"><a href="cluster-analysis.html#cb191-30" aria-hidden="true" tabindex="-1"></a>bpm <span class="ot">&lt;-</span> <span class="fu">melt</span>(bp)</span>
<span id="cb191-31"><a href="cluster-analysis.html#cb191-31" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb191-32"><a href="cluster-analysis.html#cb191-32" aria-hidden="true" tabindex="-1"></a><span class="co">#Create a barplot using ggplot2</span></span>
<span id="cb191-33"><a href="cluster-analysis.html#cb191-33" aria-hidden="true" tabindex="-1"></a>g1 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(bpm,</span>
<span id="cb191-34"><a href="cluster-analysis.html#cb191-34" aria-hidden="true" tabindex="-1"></a>             <span class="fu">aes</span>(<span class="at">fill=</span>Var1, <span class="at">y=</span>value, <span class="at">x=</span>Var2)) <span class="sc">+</span></span>
<span id="cb191-35"><a href="cluster-analysis.html#cb191-35" aria-hidden="true" tabindex="-1"></a>      <span class="fu">geom_bar</span>(<span class="at">position=</span><span class="st">&quot;dodge&quot;</span>, <span class="at">stat=</span><span class="st">&quot;identity&quot;</span>) <span class="sc">+</span></span>
<span id="cb191-36"><a href="cluster-analysis.html#cb191-36" aria-hidden="true" tabindex="-1"></a>      <span class="fu">theme</span>(<span class="at">legend.title =</span> <span class="fu">element_blank</span>()) <span class="sc">+</span></span>
<span id="cb191-37"><a href="cluster-analysis.html#cb191-37" aria-hidden="true" tabindex="-1"></a>      <span class="fu">xlab</span>(<span class="st">&quot;Cluster&quot;</span>) <span class="sc">+</span></span>
<span id="cb191-38"><a href="cluster-analysis.html#cb191-38" aria-hidden="true" tabindex="-1"></a>      <span class="fu">ylab</span>(<span class="st">&quot;&quot;</span>)</span>
<span id="cb191-39"><a href="cluster-analysis.html#cb191-39" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb191-40"><a href="cluster-analysis.html#cb191-40" aria-hidden="true" tabindex="-1"></a><span class="co">#Make the barplot interactive</span></span>
<span id="cb191-41"><a href="cluster-analysis.html#cb191-41" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplotly</span>(g1)</span></code></pre></div>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:cluster-geochem-barplot"></span>
<div id="htmlwidget-50bd9275556c6d0f4cfd" style="width:100%;height:504px;" class="plotly html-widget"></div>
<script type="application/json" data-for="htmlwidget-50bd9275556c6d0f4cfd">{"x":{"data":[{"orientation":"v","width":[0.1125,0.1125,0.1125,0.1125,0.112500000000001,0.112500000000001,0.112500000000001,0.112500000000001,0.112500000000001],"base":[-0.996725520209118,-0.546369159709549,0,-0.517485429752705,0,0,0,0,0],"x":[0.60625,1.60625,2.60625,3.60625,4.60625,5.60625,6.60625,7.60625,8.60625],"y":[0.996725520209118,0.546369159709549,0.0977692537571251,0.517485429752705,0.289150999947436,0.482590430633451,0.254402435332866,0.501101537930291,1.05986476316513],"text":["Var2: C1<br />value: 0.99672552<br />Var1: TOC","Var2: C2<br />value: 0.54636916<br />Var1: TOC","Var2: C3<br />value: 0.09776925<br />Var1: TOC","Var2: C4<br />value: 0.51748543<br />Var1: TOC","Var2: C5<br />value: 0.28915100<br />Var1: TOC","Var2: C6<br />value: 0.48259043<br />Var1: TOC","Var2: C7<br />value: 0.25440244<br />Var1: TOC","Var2: C8<br />value: 0.50110154<br />Var1: TOC","Var2: C9<br />value: 1.05986476<br />Var1: TOC"],"type":"bar","marker":{"autocolorscale":false,"color":"rgba(248,118,109,1)","line":{"width":1.88976377952756,"color":"transparent"}},"name":"TOC","legendgroup":"TOC","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"orientation":"v","width":[0.1125,0.1125,0.1125,0.1125,0.112500000000001,0.112500000000001,0.112500000000001,0.112500000000001,0.112500000000001],"base":[-0.752533902850223,-0.987870586803528,-0.720872519570444,0,0,-0.470347268039122,0,0,-0.632556313924512],"x":[0.71875,1.71875,2.71875,3.71875,4.71875,5.71875,6.71875,7.71875,8.71875],"y":[0.752533902850223,0.987870586803528,0.720872519570444,1.59481068400969,0.523338579018736,0.470347268039122,0.951403735587228,1.07223477219537,0.632556313924512],"text":["Var2: C1<br />value: 0.75253390<br />Var1: K","Var2: C2<br />value: 0.98787059<br />Var1: K","Var2: C3<br />value: 0.72087252<br />Var1: K","Var2: C4<br />value: 1.59481068<br />Var1: K","Var2: C5<br />value: 0.52333858<br />Var1: K","Var2: C6<br />value: 0.47034727<br />Var1: K","Var2: C7<br />value: 0.95140374<br />Var1: K","Var2: C8<br />value: 1.07223477<br />Var1: K","Var2: C9<br />value: 0.63255631<br />Var1: K"],"type":"bar","marker":{"autocolorscale":false,"color":"rgba(205,150,0,1)","line":{"width":1.88976377952756,"color":"transparent"}},"name":"K","legendgroup":"K","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"orientation":"v","width":[0.1125,0.1125,0.1125,0.1125,0.112500000000001,0.112500000000001,0.112500000000001,0.112500000000001,0.112500000000001],"base":[-1.1803189926719,-1.45100333464795,-1.11137789539835,0,0,-0.117431957347936,0,0,0],"x":[0.83125,1.83125,2.83125,3.83125,4.83125,5.83125,6.83125,7.83125,8.83125],"y":[1.1803189926719,1.45100333464795,1.11137789539835,0.550409337181399,0.174543312203865,0.117431957347936,1.32379113018138,2.88912908428018,0.679653909239825],"text":["Var2: C1<br />value: 1.18031899<br />Var1: Ca","Var2: C2<br />value: 1.45100333<br />Var1: Ca","Var2: C3<br />value: 1.11137790<br />Var1: Ca","Var2: C4<br />value: 0.55040934<br />Var1: Ca","Var2: C5<br />value: 0.17454331<br />Var1: Ca","Var2: C6<br />value: 0.11743196<br />Var1: Ca","Var2: C7<br />value: 1.32379113<br />Var1: Ca","Var2: C8<br />value: 2.88912908<br />Var1: Ca","Var2: C9<br />value: 0.67965391<br />Var1: Ca"],"type":"bar","marker":{"autocolorscale":false,"color":"rgba(124,174,0,1)","line":{"width":1.88976377952756,"color":"transparent"}},"name":"Ca","legendgroup":"Ca","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"orientation":"v","width":[0.1125,0.1125,0.1125,0.1125,0.112500000000001,0.112500000000001,0.112500000000001,0.112500000000001,0.112500000000001],"base":[-1.63940665042772,-1.32861326839028,-0.397173648149448,-0.139628770626153,0,0,0,0,0],"x":[0.94375,1.94375,2.94375,3.94375,4.94375,5.94375,6.94375,7.94375,8.94375],"y":[1.63940665042772,1.32861326839028,0.397173648149448,0.139628770626153,0.490552988850141,0.635751617732024,0.995697246789877,1.08725927763782,1.53341576963249],"text":["Var2: C1<br />value: 1.63940665<br />Var1: Mn","Var2: C2<br />value: 1.32861327<br />Var1: Mn","Var2: C3<br />value: 0.39717365<br />Var1: Mn","Var2: C4<br />value: 0.13962877<br />Var1: Mn","Var2: C5<br />value: 0.49055299<br />Var1: Mn","Var2: C6<br />value: 0.63575162<br />Var1: Mn","Var2: C7<br />value: 0.99569725<br />Var1: Mn","Var2: C8<br />value: 1.08725928<br />Var1: Mn","Var2: C9<br />value: 1.53341577<br />Var1: Mn"],"type":"bar","marker":{"autocolorscale":false,"color":"rgba(0,190,103,1)","line":{"width":1.88976377952756,"color":"transparent"}},"name":"Mn","legendgroup":"Mn","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"orientation":"v","width":[0.1125,0.1125,0.1125,0.112500000000001,0.112500000000001,0.112500000000001,0.112500000000001,0.112500000000001,0.112500000000001],"base":[-1.63016953945352,-1.5545041734449,0,-0.460786021789129,0,0,0,0,0],"x":[1.05625,2.05625,3.05625,4.05625,5.05625,6.05625,7.05625,8.05625,9.05625],"y":[1.63016953945352,1.5545041734449,0.143236888401237,0.460786021789129,0.375159206508807,0.853709899438739,0.955657736635441,0.80286503623123,1.78058232938774],"text":["Var2: C1<br />value: 1.63016954<br />Var1: Fe","Var2: C2<br />value: 1.55450417<br />Var1: Fe","Var2: C3<br />value: 0.14323689<br />Var1: Fe","Var2: C4<br />value: 0.46078602<br />Var1: Fe","Var2: C5<br />value: 0.37515921<br />Var1: Fe","Var2: C6<br />value: 0.85370990<br />Var1: Fe","Var2: C7<br />value: 0.95565774<br />Var1: Fe","Var2: C8<br />value: 0.80286504<br />Var1: Fe","Var2: C9<br />value: 1.78058233<br />Var1: Fe"],"type":"bar","marker":{"autocolorscale":false,"color":"rgba(0,191,196,1)","line":{"width":1.88976377952756,"color":"transparent"}},"name":"Fe","legendgroup":"Fe","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"orientation":"v","width":[0.1125,0.1125,0.1125,0.112500000000001,0.112500000000001,0.112500000000001,0.112500000000001,0.112500000000001,0.112500000000001],"base":[-1.33198036601215,-1.17333306687078,-0.122829306270074,-0.776932829114543,0,0,0,0,0],"x":[1.16875,2.16875,3.16875,4.16875,5.16875,6.16875,7.16875,8.16875,9.16875],"y":[1.33198036601215,1.17333306687078,0.122829306270074,0.776932829114543,0.225809136184909,0.725674564624467,0.907136930633386,1.74518308739116,1.1521980290656],"text":["Var2: C1<br />value: 1.33198037<br />Var1: Ni","Var2: C2<br />value: 1.17333307<br />Var1: Ni","Var2: C3<br />value: 0.12282931<br />Var1: Ni","Var2: C4<br />value: 0.77693283<br />Var1: Ni","Var2: C5<br />value: 0.22580914<br />Var1: Ni","Var2: C6<br />value: 0.72567456<br />Var1: Ni","Var2: C7<br />value: 0.90713693<br />Var1: Ni","Var2: C8<br />value: 1.74518309<br />Var1: Ni","Var2: C9<br />value: 1.15219803<br />Var1: Ni"],"type":"bar","marker":{"autocolorscale":false,"color":"rgba(0,169,255,1)","line":{"width":1.88976377952756,"color":"transparent"}},"name":"Ni","legendgroup":"Ni","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"orientation":"v","width":[0.1125,0.1125,0.1125,0.112500000000001,0.112500000000001,0.112500000000001,0.112500000000001,0.112500000000001,0.112500000000001],"base":[-1.22116627156505,-0.908798309748981,0,-0.659918577954067,0,0,0,0,0],"x":[1.28125,2.28125,3.28125,4.28125,5.28125,6.28125,7.28125,8.28125,9.28125],"y":[1.22116627156505,0.908798309748981,0.0315954172510939,0.659918577954067,0.251239592677972,0.645334777167163,0.792484863743166,0.713882989183437,1.27538194307727],"text":["Var2: C1<br />value: 1.22116627<br />Var1: Cu","Var2: C2<br />value: 0.90879831<br />Var1: Cu","Var2: C3<br />value: 0.03159542<br />Var1: Cu","Var2: C4<br />value: 0.65991858<br />Var1: Cu","Var2: C5<br />value: 0.25123959<br />Var1: Cu","Var2: C6<br />value: 0.64533478<br />Var1: Cu","Var2: C7<br />value: 0.79248486<br />Var1: Cu","Var2: C8<br />value: 0.71388299<br />Var1: Cu","Var2: C9<br />value: 1.27538194<br />Var1: Cu"],"type":"bar","marker":{"autocolorscale":false,"color":"rgba(199,124,255,1)","line":{"width":1.88976377952756,"color":"transparent"}},"name":"Cu","legendgroup":"Cu","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"orientation":"v","width":[0.1125,0.1125,0.1125,0.112500000000001,0.112500000000001,0.112500000000001,0.112500000000001,0.112500000000001,0.112500000000001],"base":[-1.32278359495955,-1.01487753153374,0,-0.239174869950094,0,0,0,0,0],"x":[1.39375,2.39375,3.39375,4.39375,5.39375,6.39375,7.39375,8.39375,9.39375],"y":[1.32278359495955,1.01487753153374,0.0319208287288153,0.239174869950094,0.260831925055618,0.378370836291401,0.877957168577227,1.19009359246145,0.904842056083548],"text":["Var2: C1<br />value: 1.32278359<br />Var1: Zn","Var2: C2<br />value: 1.01487753<br />Var1: Zn","Var2: C3<br />value: 0.03192083<br />Var1: Zn","Var2: C4<br />value: 0.23917487<br />Var1: Zn","Var2: C5<br />value: 0.26083193<br />Var1: Zn","Var2: C6<br />value: 0.37837084<br />Var1: Zn","Var2: C7<br />value: 0.87795717<br />Var1: Zn","Var2: C8<br />value: 1.19009359<br />Var1: Zn","Var2: C9<br />value: 0.90484206<br />Var1: Zn"],"type":"bar","marker":{"autocolorscale":false,"color":"rgba(255,97,204,1)","line":{"width":1.88976377952756,"color":"transparent"}},"name":"Zn","legendgroup":"Zn","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null}],"layout":{"margin":{"t":25.7412480974125,"r":7.30593607305936,"b":39.6955859969559,"l":22.648401826484},"plot_bgcolor":"rgba(235,235,235,1)","paper_bgcolor":"rgba(255,255,255,1)","font":{"color":"rgba(0,0,0,1)","family":"","size":14.6118721461187},"xaxis":{"domain":[0,1],"automargin":true,"type":"linear","autorange":false,"range":[0.4,9.6],"tickmode":"array","ticktext":["C1","C2","C3","C4","C5","C6","C7","C8","C9"],"tickvals":[1,2,3,4,5,6,7,8,9],"categoryorder":"array","categoryarray":["C1","C2","C3","C4","C5","C6","C7","C8","C9"],"nticks":null,"ticks":"outside","tickcolor":"rgba(51,51,51,1)","ticklen":3.65296803652968,"tickwidth":0.66417600664176,"showticklabels":true,"tickfont":{"color":"rgba(77,77,77,1)","family":"","size":11.689497716895},"tickangle":-0,"showline":false,"linecolor":null,"linewidth":0,"showgrid":true,"gridcolor":"rgba(255,255,255,1)","gridwidth":0.66417600664176,"zeroline":false,"anchor":"y","title":{"text":"Cluster","font":{"color":"rgba(0,0,0,1)","family":"","size":14.6118721461187}},"hoverformat":".2f"},"yaxis":{"domain":[0,1],"automargin":true,"type":"linear","autorange":false,"range":[-1.86583343716311,3.11555587101557],"tickmode":"array","ticktext":["-1","0","1","2","3"],"tickvals":[-1,-2.22044604925031e-16,1,2,3],"categoryorder":"array","categoryarray":["-1","0","1","2","3"],"nticks":null,"ticks":"outside","tickcolor":"rgba(51,51,51,1)","ticklen":3.65296803652968,"tickwidth":0.66417600664176,"showticklabels":true,"tickfont":{"color":"rgba(77,77,77,1)","family":"","size":11.689497716895},"tickangle":-0,"showline":false,"linecolor":null,"linewidth":0,"showgrid":true,"gridcolor":"rgba(255,255,255,1)","gridwidth":0.66417600664176,"zeroline":false,"anchor":"x","title":{"text":"","font":{"color":"rgba(0,0,0,1)","family":"","size":14.6118721461187}},"hoverformat":".2f"},"shapes":[{"type":"rect","fillcolor":null,"line":{"color":null,"width":0,"linetype":[]},"yref":"paper","xref":"paper","x0":0,"x1":1,"y0":0,"y1":1}],"showlegend":true,"legend":{"bgcolor":"rgba(255,255,255,1)","bordercolor":"transparent","borderwidth":1.88976377952756,"font":{"color":"rgba(0,0,0,1)","family":"","size":11.689497716895},"y":1},"hovermode":"closest","barmode":"relative"},"config":{"doubleClick":"reset","showSendToCloud":false},"source":"A","attrs":{"3d14317d8f2":{"x":{},"y":{},"fill":{},"type":"bar"}},"cur_data":"3d14317d8f2","visdat":{"3d14317d8f2":["function (y) ","x"]},"highlight":{"on":"plotly_click","persistent":false,"dynamic":false,"selectize":false,"opacityDim":0.2,"selected":{"opacity":1},"debounce":0},"shinyEvents":["plotly_hover","plotly_click","plotly_selected","plotly_relayout","plotly_brushed","plotly_brushing","plotly_clickannotation","plotly_doubleclick","plotly_deselect","plotly_afterplot","plotly_sunburstclick"],"base_url":"https://plot.ly"},"evals":[],"jsHooks":[]}</script>
<p class="caption">
Figure 4.10: Average total nutrient concentrations of each cluster expressed as deviation in log-ratio scale from the geometric mean. Values below zero represent average concentrations lower than that for the entire dataset, whilst values above zero represent the opposite.
</p>
</div>
<p>The resulting barplot illustrates how the nine clusters defined by the XRPD data are characterised by contrasting geochemical compositions. Clusters 8 and 9 are by far the most deficient in all nutrients, whilst Clusters 1, 2 and 3 are enriched in all nutrients (with the exception of K in Cluster 1). Interestingly, soils in Cluster 6 have the highest concentrations of total K on average, but are generally deficient in other nutrients. The relationships between the geochemical compositions of each cluster and the mineralogy can be interpreted by quantifying the mean diffractogram of each cluster using the full pattern summation functions outlined in Chapter <a href="quant.html#quant">2</a>:</p>
<div class="sourceCode" id="cb192"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb192-1"><a href="cluster-analysis.html#cb192-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Create a blank list to be populated</span></span>
<span id="cb192-2"><a href="cluster-analysis.html#cb192-2" aria-hidden="true" tabindex="-1"></a>xrpd_clusters <span class="ot">&lt;-</span> <span class="fu">list</span>()</span>
<span id="cb192-3"><a href="cluster-analysis.html#cb192-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb192-4"><a href="cluster-analysis.html#cb192-4" aria-hidden="true" tabindex="-1"></a><span class="co">#Calculate the mean diffractogram of each cluster</span></span>
<span id="cb192-5"><a href="cluster-analysis.html#cb192-5" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">9</span>) {</span>
<span id="cb192-6"><a href="cluster-analysis.html#cb192-6" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb192-7"><a href="cluster-analysis.html#cb192-7" aria-hidden="true" tabindex="-1"></a>  <span class="co">#Extract the SSN for the cluster</span></span>
<span id="cb192-8"><a href="cluster-analysis.html#cb192-8" aria-hidden="true" tabindex="-1"></a>  ssns <span class="ot">&lt;-</span> clust_sub<span class="sc">$</span>SSN[<span class="fu">which</span>(clust_sub<span class="sc">$</span>NEW_CLUSTER <span class="sc">==</span> <span class="fu">paste0</span>(<span class="st">&quot;C&quot;</span>, i))]</span>
<span id="cb192-9"><a href="cluster-analysis.html#cb192-9" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb192-10"><a href="cluster-analysis.html#cb192-10" aria-hidden="true" tabindex="-1"></a>  <span class="co">#Extract the aligned xrpd data and make sure it is a multiXY object</span></span>
<span id="cb192-11"><a href="cluster-analysis.html#cb192-11" aria-hidden="true" tabindex="-1"></a>  xrpd_clusters[[i]] <span class="ot">&lt;-</span> <span class="fu">as_multi_xy</span>(xrpd_aligned[ssns])</span>
<span id="cb192-12"><a href="cluster-analysis.html#cb192-12" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb192-13"><a href="cluster-analysis.html#cb192-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">names</span>(xrpd_clusters)[i] <span class="ot">&lt;-</span> <span class="fu">paste0</span>(<span class="st">&quot;C&quot;</span>, i)</span>
<span id="cb192-14"><a href="cluster-analysis.html#cb192-14" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb192-15"><a href="cluster-analysis.html#cb192-15" aria-hidden="true" tabindex="-1"></a>  <span class="co">#Convert to a data frame</span></span>
<span id="cb192-16"><a href="cluster-analysis.html#cb192-16" aria-hidden="true" tabindex="-1"></a>  xrpd_clusters[[i]] <span class="ot">&lt;-</span> <span class="fu">multi_xy_to_df</span>(xrpd_clusters[[i]],</span>
<span id="cb192-17"><a href="cluster-analysis.html#cb192-17" aria-hidden="true" tabindex="-1"></a>                                       <span class="at">tth =</span> <span class="cn">TRUE</span>)</span>
<span id="cb192-18"><a href="cluster-analysis.html#cb192-18" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb192-19"><a href="cluster-analysis.html#cb192-19" aria-hidden="true" tabindex="-1"></a>  <span class="co">#Calculate mean diffractogram</span></span>
<span id="cb192-20"><a href="cluster-analysis.html#cb192-20" aria-hidden="true" tabindex="-1"></a>  xrpd_clusters[[i]] <span class="ot">&lt;-</span> <span class="fu">as_xy</span>(<span class="fu">data.frame</span>(<span class="st">&quot;tth&quot;</span> <span class="ot">=</span> xrpd_clusters[[i]]<span class="sc">$</span>tth,</span>
<span id="cb192-21"><a href="cluster-analysis.html#cb192-21" aria-hidden="true" tabindex="-1"></a>                                         <span class="st">&quot;counts&quot;</span> <span class="ot">=</span> <span class="fu">rowMeans</span>(xrpd_clusters[[i]][<span class="sc">-</span><span class="dv">1</span>])))</span>
<span id="cb192-22"><a href="cluster-analysis.html#cb192-22" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb192-23"><a href="cluster-analysis.html#cb192-23" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb192-24"><a href="cluster-analysis.html#cb192-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb192-25"><a href="cluster-analysis.html#cb192-25" aria-hidden="true" tabindex="-1"></a><span class="co">#Plot the mean diffractogram of Cluster 9</span></span>
<span id="cb192-26"><a href="cluster-analysis.html#cb192-26" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(xrpd_clusters<span class="sc">$</span>C1, <span class="at">wavelength =</span> <span class="st">&quot;Cu&quot;</span>)</span></code></pre></div>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:unnamed-chunk-111"></span>
<img src="DigiMinR_files/figure-html/unnamed-chunk-111-1.png" alt="The mean diffractogram of Cluster 9." width="100%" />
<p class="caption">
Figure 4.11: The mean diffractogram of Cluster 9.
</p>
</div>
<p>Now that the mean diffractogram of each cluster has been computed. The mineralogy of each diffractogram can be quantified <a href="quant.html#afps">using <code>afps()</code></a> using the<code>rockjock_afsis</code> library created above, yielding an approximate average of the mineral composition of each cluster:</p>
<div class="sourceCode" id="cb193"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb193-1"><a href="cluster-analysis.html#cb193-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Define the names of the minerals to supply to afps</span></span>
<span id="cb193-2"><a href="cluster-analysis.html#cb193-2" aria-hidden="true" tabindex="-1"></a>usuals <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;Quartz&quot;</span>, <span class="st">&quot;Kaolinite&quot;</span>,</span>
<span id="cb193-3"><a href="cluster-analysis.html#cb193-3" aria-hidden="true" tabindex="-1"></a>            <span class="st">&quot;Halloysite&quot;</span>, <span class="st">&quot;Dickite&quot;</span>,</span>
<span id="cb193-4"><a href="cluster-analysis.html#cb193-4" aria-hidden="true" tabindex="-1"></a>            <span class="st">&quot;Smectite (Di)&quot;</span>, <span class="st">&quot;Smectite (ML)&quot;</span>,</span>
<span id="cb193-5"><a href="cluster-analysis.html#cb193-5" aria-hidden="true" tabindex="-1"></a>            <span class="st">&quot;Illite&quot;</span>, <span class="st">&quot;Mica (Di)&quot;</span>, <span class="st">&quot;Muscovite&quot;</span>,</span>
<span id="cb193-6"><a href="cluster-analysis.html#cb193-6" aria-hidden="true" tabindex="-1"></a>            <span class="st">&quot;K-feldspar&quot;</span>, <span class="st">&quot;Plagioclase&quot;</span>,</span>
<span id="cb193-7"><a href="cluster-analysis.html#cb193-7" aria-hidden="true" tabindex="-1"></a>            <span class="st">&quot;Goethite&quot;</span>, <span class="st">&quot;Maghemite&quot;</span>, <span class="st">&quot;Ilmenite&quot;</span>,</span>
<span id="cb193-8"><a href="cluster-analysis.html#cb193-8" aria-hidden="true" tabindex="-1"></a>            <span class="st">&quot;Hematite&quot;</span>, <span class="st">&quot;Gibbsite&quot;</span>, <span class="st">&quot;Magnetite&quot;</span>,</span>
<span id="cb193-9"><a href="cluster-analysis.html#cb193-9" aria-hidden="true" tabindex="-1"></a>            <span class="st">&quot;Anatase&quot;</span>, <span class="st">&quot;Amphibole&quot;</span>, <span class="st">&quot;Pyroxene&quot;</span>,</span>
<span id="cb193-10"><a href="cluster-analysis.html#cb193-10" aria-hidden="true" tabindex="-1"></a>            <span class="st">&quot;Calcite&quot;</span>, <span class="st">&quot;Gypsum&quot;</span>, <span class="st">&quot;Organic matter&quot;</span>,</span>
<span id="cb193-11"><a href="cluster-analysis.html#cb193-11" aria-hidden="true" tabindex="-1"></a>            <span class="st">&quot;HUMIC_ACID&quot;</span>, <span class="st">&quot;FERRIHYDRITE_HUMBUG_CREEK&quot;</span>,</span>
<span id="cb193-12"><a href="cluster-analysis.html#cb193-12" aria-hidden="true" tabindex="-1"></a>            <span class="st">&quot;FERRIHYDRITE&quot;</span>,</span>
<span id="cb193-13"><a href="cluster-analysis.html#cb193-13" aria-hidden="true" tabindex="-1"></a>            <span class="st">&quot;BACK_POS&quot;</span>)</span>
<span id="cb193-14"><a href="cluster-analysis.html#cb193-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb193-15"><a href="cluster-analysis.html#cb193-15" aria-hidden="true" tabindex="-1"></a><span class="co">#Define the amorphous phases</span></span>
<span id="cb193-16"><a href="cluster-analysis.html#cb193-16" aria-hidden="true" tabindex="-1"></a>amorph <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;ORGANIC_MATTER&quot;</span>, <span class="st">&quot;ORGANIC_AFSIS&quot;</span>,</span>
<span id="cb193-17"><a href="cluster-analysis.html#cb193-17" aria-hidden="true" tabindex="-1"></a>            <span class="st">&quot;HUMIC_ACID&quot;</span>, <span class="st">&quot;FERRIHYDRITE_HUMBUG_CREEK&quot;</span>,</span>
<span id="cb193-18"><a href="cluster-analysis.html#cb193-18" aria-hidden="true" tabindex="-1"></a>            <span class="st">&quot;FERRIHYDRITE&quot;</span>)</span>
<span id="cb193-19"><a href="cluster-analysis.html#cb193-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb193-20"><a href="cluster-analysis.html#cb193-20" aria-hidden="true" tabindex="-1"></a>clusters_quant <span class="ot">&lt;-</span> <span class="fu">lapply</span>(xrpd_clusters, afps,</span>
<span id="cb193-21"><a href="cluster-analysis.html#cb193-21" aria-hidden="true" tabindex="-1"></a>                         <span class="at">lib =</span> rockjock_afsis,</span>
<span id="cb193-22"><a href="cluster-analysis.html#cb193-22" aria-hidden="true" tabindex="-1"></a>                         <span class="at">std =</span> <span class="st">&quot;QUARTZ_1_AFSIS&quot;</span>,</span>
<span id="cb193-23"><a href="cluster-analysis.html#cb193-23" aria-hidden="true" tabindex="-1"></a>                         <span class="at">refs =</span> usuals,</span>
<span id="cb193-24"><a href="cluster-analysis.html#cb193-24" aria-hidden="true" tabindex="-1"></a>                         <span class="at">amorphous =</span> amorph,</span>
<span id="cb193-25"><a href="cluster-analysis.html#cb193-25" aria-hidden="true" tabindex="-1"></a>                         <span class="at">align =</span> <span class="fl">0.2</span>,</span>
<span id="cb193-26"><a href="cluster-analysis.html#cb193-26" aria-hidden="true" tabindex="-1"></a>                         <span class="at">lod =</span> <span class="fl">0.05</span>,</span>
<span id="cb193-27"><a href="cluster-analysis.html#cb193-27" aria-hidden="true" tabindex="-1"></a>                         <span class="at">amorphous_lod =</span> <span class="dv">0</span>,</span>
<span id="cb193-28"><a href="cluster-analysis.html#cb193-28" aria-hidden="true" tabindex="-1"></a>                         <span class="at">force =</span> <span class="st">&quot;BACK_POS&quot;</span>)</span>
<span id="cb193-29"><a href="cluster-analysis.html#cb193-29" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb193-30"><a href="cluster-analysis.html#cb193-30" aria-hidden="true" tabindex="-1"></a><span class="co">#Load the regrouping structures for rockjock and afsis</span></span>
<span id="cb193-31"><a href="cluster-analysis.html#cb193-31" aria-hidden="true" tabindex="-1"></a><span class="fu">data</span>(rockjock_regroup)</span>
<span id="cb193-32"><a href="cluster-analysis.html#cb193-32" aria-hidden="true" tabindex="-1"></a><span class="fu">data</span>(afsis_regroup)</span>
<span id="cb193-33"><a href="cluster-analysis.html#cb193-33" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb193-34"><a href="cluster-analysis.html#cb193-34" aria-hidden="true" tabindex="-1"></a><span class="co">#lapply the regrouping structure</span></span>
<span id="cb193-35"><a href="cluster-analysis.html#cb193-35" aria-hidden="true" tabindex="-1"></a>clusters_quant_rg <span class="ot">&lt;-</span> <span class="fu">lapply</span>(clusters_quant,</span>
<span id="cb193-36"><a href="cluster-analysis.html#cb193-36" aria-hidden="true" tabindex="-1"></a>                            regroup,</span>
<span id="cb193-37"><a href="cluster-analysis.html#cb193-37" aria-hidden="true" tabindex="-1"></a>                            <span class="at">y =</span> <span class="fu">rbind</span>(rockjock_regroup[<span class="dv">1</span><span class="sc">:</span><span class="dv">2</span>],</span>
<span id="cb193-38"><a href="cluster-analysis.html#cb193-38" aria-hidden="true" tabindex="-1"></a>                                      afsis_regroup[<span class="dv">1</span><span class="sc">:</span><span class="dv">2</span>]))</span>
<span id="cb193-39"><a href="cluster-analysis.html#cb193-39" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb193-40"><a href="cluster-analysis.html#cb193-40" aria-hidden="true" tabindex="-1"></a><span class="co">#Extract the quantitative data</span></span>
<span id="cb193-41"><a href="cluster-analysis.html#cb193-41" aria-hidden="true" tabindex="-1"></a>quant_table <span class="ot">&lt;-</span> <span class="fu">summarise_mineralogy</span>(clusters_quant_rg,</span>
<span id="cb193-42"><a href="cluster-analysis.html#cb193-42" aria-hidden="true" tabindex="-1"></a>                                    <span class="at">type =</span> <span class="st">&quot;grouped&quot;</span>,</span>
<span id="cb193-43"><a href="cluster-analysis.html#cb193-43" aria-hidden="true" tabindex="-1"></a>                                    <span class="at">order =</span> <span class="cn">TRUE</span>)</span>
<span id="cb193-44"><a href="cluster-analysis.html#cb193-44" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb193-45"><a href="cluster-analysis.html#cb193-45" aria-hidden="true" tabindex="-1"></a><span class="co">#Reduce to the 10 most common phases for a barplot</span></span>
<span id="cb193-46"><a href="cluster-analysis.html#cb193-46" aria-hidden="true" tabindex="-1"></a>quant_table <span class="ot">&lt;-</span> quant_table[<span class="dv">2</span><span class="sc">:</span><span class="dv">11</span>]</span></code></pre></div>
<p>The resulting quantification can then be plotted:</p>
<div class="sourceCode" id="cb194"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb194-1"><a href="cluster-analysis.html#cb194-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Rename clusters C1 to C9</span></span>
<span id="cb194-2"><a href="cluster-analysis.html#cb194-2" aria-hidden="true" tabindex="-1"></a><span class="fu">rownames</span>(quant_table) <span class="ot">&lt;-</span> <span class="fu">paste0</span>(<span class="st">&quot;C&quot;</span>, <span class="fu">rownames</span>(quant_table))</span>
<span id="cb194-3"><a href="cluster-analysis.html#cb194-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-4"><a href="cluster-analysis.html#cb194-4" aria-hidden="true" tabindex="-1"></a><span class="co">#Use melt from the reshape2 package so that the data are</span></span>
<span id="cb194-5"><a href="cluster-analysis.html#cb194-5" aria-hidden="true" tabindex="-1"></a><span class="co">#in the right format for ggplot2:</span></span>
<span id="cb194-6"><a href="cluster-analysis.html#cb194-6" aria-hidden="true" tabindex="-1"></a>quant_table_m <span class="ot">&lt;-</span> <span class="fu">melt</span>(<span class="fu">as.matrix</span>(quant_table))</span>
<span id="cb194-7"><a href="cluster-analysis.html#cb194-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-8"><a href="cluster-analysis.html#cb194-8" aria-hidden="true" tabindex="-1"></a><span class="co">#Create a barplot using ggplot2</span></span>
<span id="cb194-9"><a href="cluster-analysis.html#cb194-9" aria-hidden="true" tabindex="-1"></a>g2 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(quant_table_m,</span>
<span id="cb194-10"><a href="cluster-analysis.html#cb194-10" aria-hidden="true" tabindex="-1"></a>             <span class="fu">aes</span>(<span class="at">fill=</span>Var2, <span class="at">y=</span>value, <span class="at">x=</span>Var1)) <span class="sc">+</span></span>
<span id="cb194-11"><a href="cluster-analysis.html#cb194-11" aria-hidden="true" tabindex="-1"></a>      <span class="fu">geom_bar</span>(<span class="at">position=</span><span class="st">&quot;dodge&quot;</span>, <span class="at">stat=</span><span class="st">&quot;identity&quot;</span>) <span class="sc">+</span></span>
<span id="cb194-12"><a href="cluster-analysis.html#cb194-12" aria-hidden="true" tabindex="-1"></a>      <span class="fu">theme</span>(<span class="at">legend.title =</span> <span class="fu">element_blank</span>()) <span class="sc">+</span></span>
<span id="cb194-13"><a href="cluster-analysis.html#cb194-13" aria-hidden="true" tabindex="-1"></a>      <span class="fu">xlab</span>(<span class="st">&quot;Cluster&quot;</span>) <span class="sc">+</span></span>
<span id="cb194-14"><a href="cluster-analysis.html#cb194-14" aria-hidden="true" tabindex="-1"></a>      <span class="fu">ylab</span>(<span class="st">&quot;&quot;</span>)</span>
<span id="cb194-15"><a href="cluster-analysis.html#cb194-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-16"><a href="cluster-analysis.html#cb194-16" aria-hidden="true" tabindex="-1"></a><span class="co">#Make the barplot interactive</span></span>
<span id="cb194-17"><a href="cluster-analysis.html#cb194-17" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplotly</span>(g2)</span></code></pre></div>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:cluster-quant-barplot"></span>
<div id="htmlwidget-c7843cb18d559c641d71" style="width:100%;height:504px;" class="plotly html-widget"></div>
<script type="application/json" data-for="htmlwidget-c7843cb18d559c641d71">{"x":{"data":[{"orientation":"v","width":[0.0900000000000001,0.0899999999999999,0.0899999999999999,0.0899999999999999,0.0899999999999999,0.0899999999999999,0.0899999999999999,0.0899999999999999,0.0899999999999999],"base":[0,0,0,0,0,0,0,0,0],"x":[0.595,1.595,2.595,3.595,4.595,5.595,6.595,7.595,8.595],"y":[94.625,83.3554,66.9307,64.2034,58.2496,38.0596,30.5609,14.6162,12.0402],"text":["Var1: C1<br />value: 94.6250<br />Var2: Quartz","Var1: C2<br />value: 83.3554<br />Var2: Quartz","Var1: C3<br />value: 66.9307<br />Var2: Quartz","Var1: C4<br />value: 64.2034<br />Var2: Quartz","Var1: C5<br />value: 58.2496<br />Var2: Quartz","Var1: C6<br />value: 38.0596<br />Var2: Quartz","Var1: C7<br />value: 30.5609<br />Var2: Quartz","Var1: C8<br />value: 14.6162<br />Var2: Quartz","Var1: C9<br />value: 12.0402<br />Var2: Quartz"],"type":"bar","marker":{"autocolorscale":false,"color":"rgba(248,118,109,1)","line":{"width":1.88976377952756,"color":"transparent"}},"name":"Quartz","legendgroup":"Quartz","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"orientation":"v","width":[0.0900000000000001,0.0899999999999999,0.0899999999999999,0.0899999999999999,0.0899999999999999,0.0899999999999999,0.0899999999999999,0.0899999999999999,0.0899999999999999],"base":[0,0,0,0,0,0,0,0,0],"x":[0.685,1.685,2.685,3.685,4.685,5.685,6.685,7.685,8.685],"y":[2.0485,5.7053,16.1461,6.357,10.4351,26.4047,11.3428,3.7601,26.7168],"text":["Var1: C1<br />value:  2.0485<br />Var2: Kaolin","Var1: C2<br />value:  5.7053<br />Var2: Kaolin","Var1: C3<br />value: 16.1461<br />Var2: Kaolin","Var1: C4<br />value:  6.3570<br />Var2: Kaolin","Var1: C5<br />value: 10.4351<br />Var2: Kaolin","Var1: C6<br />value: 26.4047<br />Var2: Kaolin","Var1: C7<br />value: 11.3428<br />Var2: Kaolin","Var1: C8<br />value:  3.7601<br />Var2: Kaolin","Var1: C9<br />value: 26.7168<br />Var2: Kaolin"],"type":"bar","marker":{"autocolorscale":false,"color":"rgba(216,144,0,1)","line":{"width":1.88976377952756,"color":"transparent"}},"name":"Kaolin","legendgroup":"Kaolin","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"orientation":"v","width":[0.0900000000000001,0.0899999999999999,0.0899999999999999,0.0899999999999999,0.0899999999999999,0.0899999999999999,0.0899999999999999,0.0899999999999999,0.0899999999999999],"base":[null,0,0,0,0,0,0,0,0],"x":[0.775,1.775,2.775,3.775,4.775,5.775,6.775,7.775,8.775],"y":[null,3.6906,8.0007,4.1452,9.0032,17.8262,8.7586,8.2395,32.3145],"text":["Var1: C1<br />value:      NA<br />Var2: Fe/Ti-(hydr)oxide","Var1: C2<br />value:  3.6906<br />Var2: Fe/Ti-(hydr)oxide","Var1: C3<br />value:  8.0007<br />Var2: Fe/Ti-(hydr)oxide","Var1: C4<br />value:  4.1452<br />Var2: Fe/Ti-(hydr)oxide","Var1: C5<br />value:  9.0032<br />Var2: Fe/Ti-(hydr)oxide","Var1: C6<br />value: 17.8262<br />Var2: Fe/Ti-(hydr)oxide","Var1: C7<br />value:  8.7586<br />Var2: Fe/Ti-(hydr)oxide","Var1: C8<br />value:  8.2395<br />Var2: Fe/Ti-(hydr)oxide","Var1: C9<br />value: 32.3145<br />Var2: Fe/Ti-(hydr)oxide"],"type":"bar","marker":{"autocolorscale":false,"color":"rgba(163,165,0,1)","line":{"width":1.88976377952756,"color":"transparent"}},"name":"Fe/Ti-(hydr)oxide","legendgroup":"Fe/Ti-(hydr)oxide","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"orientation":"v","width":[0.0900000000000001,0.0899999999999999,0.0899999999999999,0.0899999999999999,0.0899999999999999,0.0899999999999999,0.0899999999999999,0.0899999999999999,0.0899999999999999],"base":[null,0,null,0,0,0,0,0,0],"x":[0.865,1.865,2.865,3.865,4.865,5.865,6.865,7.865,8.865],"y":[null,0.6432,null,1.2358,3.0404,2.6002,12.558,27.6727,5.4281],"text":["Var1: C1<br />value:      NA<br />Var2: Expandable/ML Dioct.","Var1: C2<br />value:  0.6432<br />Var2: Expandable/ML Dioct.","Var1: C3<br />value:      NA<br />Var2: Expandable/ML Dioct.","Var1: C4<br />value:  1.2358<br />Var2: Expandable/ML Dioct.","Var1: C5<br />value:  3.0404<br />Var2: Expandable/ML Dioct.","Var1: C6<br />value:  2.6002<br />Var2: Expandable/ML Dioct.","Var1: C7<br />value: 12.5580<br />Var2: Expandable/ML Dioct.","Var1: C8<br />value: 27.6727<br />Var2: Expandable/ML Dioct.","Var1: C9<br />value:  5.4281<br />Var2: Expandable/ML Dioct."],"type":"bar","marker":{"autocolorscale":false,"color":"rgba(57,182,0,1)","line":{"width":1.88976377952756,"color":"transparent"}},"name":"Expandable/ML Dioct.","legendgroup":"Expandable/ML Dioct.","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"orientation":"v","width":[0.09,0.0899999999999999,0.0899999999999999,0.0899999999999999,0.0899999999999999,0.0899999999999999,0.0899999999999999,0.0899999999999999,0.0899999999999999],"base":[null,0,0,null,0,0,0,0,0],"x":[0.955,1.955,2.955,3.955,4.955,5.955,6.955,7.955,8.955],"y":[null,2.1911,2.5072,null,10.0296,3.8071,13.0219,7.1498,3.5058],"text":["Var1: C1<br />value:      NA<br />Var2: Illitic/Micaceous Dioct.","Var1: C2<br />value:  2.1911<br />Var2: Illitic/Micaceous Dioct.","Var1: C3<br />value:  2.5072<br />Var2: Illitic/Micaceous Dioct.","Var1: C4<br />value:      NA<br />Var2: Illitic/Micaceous Dioct.","Var1: C5<br />value: 10.0296<br />Var2: Illitic/Micaceous Dioct.","Var1: C6<br />value:  3.8071<br />Var2: Illitic/Micaceous Dioct.","Var1: C7<br />value: 13.0219<br />Var2: Illitic/Micaceous Dioct.","Var1: C8<br />value:  7.1498<br />Var2: Illitic/Micaceous Dioct.","Var1: C9<br />value:  3.5058<br />Var2: Illitic/Micaceous Dioct."],"type":"bar","marker":{"autocolorscale":false,"color":"rgba(0,191,125,1)","line":{"width":1.88976377952756,"color":"transparent"}},"name":"Illitic/Micaceous Dioct.","legendgroup":"Illitic/Micaceous Dioct.","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"orientation":"v","width":[0.09,0.0899999999999999,0.0899999999999999,0.0899999999999999,0.0899999999999999,0.0899999999999999,0.0899999999999999,0.0899999999999999,0.0899999999999999],"base":[0,0,0,0,0,0,0,0,0],"x":[1.045,2.045,3.045,4.045,5.045,6.045,7.045,8.045,9.045],"y":[1.4911,1.4353,0.6909,17.31,2.2944,1.4018,3.0203,8.2945,1.9083],"text":["Var1: C1<br />value:  1.4911<br />Var2: K-feldspar","Var1: C2<br />value:  1.4353<br />Var2: K-feldspar","Var1: C3<br />value:  0.6909<br />Var2: K-feldspar","Var1: C4<br />value: 17.3100<br />Var2: K-feldspar","Var1: C5<br />value:  2.2944<br />Var2: K-feldspar","Var1: C6<br />value:  1.4018<br />Var2: K-feldspar","Var1: C7<br />value:  3.0203<br />Var2: K-feldspar","Var1: C8<br />value:  8.2945<br />Var2: K-feldspar","Var1: C9<br />value:  1.9083<br />Var2: K-feldspar"],"type":"bar","marker":{"autocolorscale":false,"color":"rgba(0,191,196,1)","line":{"width":1.88976377952756,"color":"transparent"}},"name":"K-feldspar","legendgroup":"K-feldspar","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"orientation":"v","width":[0.0899999999999999,0.0899999999999999,0.0899999999999999,0.0899999999999999,0.0899999999999999,0.0899999999999999,0.0899999999999999,0.0899999999999999,0.0899999999999999],"base":[0,0,0,0,0,0,0,0,0],"x":[1.135,2.135,3.135,4.135,5.135,6.135,7.135,8.135,9.135],"y":[0.8898,1.3347,1.738,1.8445,3.1213,4.2905,4.6186,5.8211,5.259],"text":["Var1: C1<br />value:  0.8898<br />Var2: Amorphous-O","Var1: C2<br />value:  1.3347<br />Var2: Amorphous-O","Var1: C3<br />value:  1.7380<br />Var2: Amorphous-O","Var1: C4<br />value:  1.8445<br />Var2: Amorphous-O","Var1: C5<br />value:  3.1213<br />Var2: Amorphous-O","Var1: C6<br />value:  4.2905<br />Var2: Amorphous-O","Var1: C7<br />value:  4.6186<br />Var2: Amorphous-O","Var1: C8<br />value:  5.8211<br />Var2: Amorphous-O","Var1: C9<br />value:  5.2590<br />Var2: Amorphous-O"],"type":"bar","marker":{"autocolorscale":false,"color":"rgba(0,176,246,1)","line":{"width":1.88976377952756,"color":"transparent"}},"name":"Amorphous-O","legendgroup":"Amorphous-O","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"orientation":"v","width":[0.0899999999999999,0.0899999999999999,0.0899999999999999,0.0899999999999999,0.0899999999999999,0.0899999999999999,0.0899999999999999,0.0899999999999999,0.0899999999999999],"base":[null,0,0,0,0,0,0,0,0],"x":[1.225,2.225,3.225,4.225,5.225,6.225,7.225,8.225,9.225],"y":[null,0.6654,0.5687,3.9932,1.3789,1.0143,6.9564,12.1606,1.5915],"text":["Var1: C1<br />value:      NA<br />Var2: Plagioclase","Var1: C2<br />value:  0.6654<br />Var2: Plagioclase","Var1: C3<br />value:  0.5687<br />Var2: Plagioclase","Var1: C4<br />value:  3.9932<br />Var2: Plagioclase","Var1: C5<br />value:  1.3789<br />Var2: Plagioclase","Var1: C6<br />value:  1.0143<br />Var2: Plagioclase","Var1: C7<br />value:  6.9564<br />Var2: Plagioclase","Var1: C8<br />value: 12.1606<br />Var2: Plagioclase","Var1: C9<br />value:  1.5915<br />Var2: Plagioclase"],"type":"bar","marker":{"autocolorscale":false,"color":"rgba(149,144,255,1)","line":{"width":1.88976377952756,"color":"transparent"}},"name":"Plagioclase","legendgroup":"Plagioclase","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"orientation":"v","width":[0.0899999999999999,0.0899999999999999,0.0899999999999999,0.0899999999999999,0.0899999999999999,0.0899999999999999,0.0899999999999999,0.0899999999999999,0.0899999999999999],"base":[0,0,0,0,0,0,0,0,0],"x":[1.315,2.315,3.315,4.315,5.315,6.315,7.315,8.315,9.315],"y":[0.9455,0.9793,1.9873,0.9111,1.8559,2.0946,7.6003,3.5415,3.5613],"text":["Var1: C1<br />value:  0.9455<br />Var2: Amorphous-I","Var1: C2<br />value:  0.9793<br />Var2: Amorphous-I","Var1: C3<br />value:  1.9873<br />Var2: Amorphous-I","Var1: C4<br />value:  0.9111<br />Var2: Amorphous-I","Var1: C5<br />value:  1.8559<br />Var2: Amorphous-I","Var1: C6<br />value:  2.0946<br />Var2: Amorphous-I","Var1: C7<br />value:  7.6003<br />Var2: Amorphous-I","Var1: C8<br />value:  3.5415<br />Var2: Amorphous-I","Var1: C9<br />value:  3.5613<br />Var2: Amorphous-I"],"type":"bar","marker":{"autocolorscale":false,"color":"rgba(231,107,243,1)","line":{"width":1.88976377952756,"color":"transparent"}},"name":"Amorphous-I","legendgroup":"Amorphous-I","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"orientation":"v","width":[0.0899999999999999,0.0899999999999999,0.0899999999999999,0.0899999999999999,0.0899999999999999,0.0899999999999999,0.0899999999999999,0.0899999999999999,0.0899999999999999],"base":[null,null,0,null,0,0,null,null,0],"x":[1.405,2.405,3.405,4.405,5.405,6.405,7.405,8.405,9.405],"y":[null,null,1.4302,null,0.1795,1.8777,null,null,5.3339],"text":["Var1: C1<br />value:      NA<br />Var2: Gibbsite","Var1: C2<br />value:      NA<br />Var2: Gibbsite","Var1: C3<br />value:  1.4302<br />Var2: Gibbsite","Var1: C4<br />value:      NA<br />Var2: Gibbsite","Var1: C5<br />value:  0.1795<br />Var2: Gibbsite","Var1: C6<br />value:  1.8777<br />Var2: Gibbsite","Var1: C7<br />value:      NA<br />Var2: Gibbsite","Var1: C8<br />value:      NA<br />Var2: Gibbsite","Var1: C9<br />value:  5.3339<br />Var2: Gibbsite"],"type":"bar","marker":{"autocolorscale":false,"color":"rgba(255,98,188,1)","line":{"width":1.88976377952756,"color":"transparent"}},"name":"Gibbsite","legendgroup":"Gibbsite","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null}],"layout":{"margin":{"t":25.7412480974125,"r":7.30593607305936,"b":39.6955859969559,"l":22.648401826484},"plot_bgcolor":"rgba(235,235,235,1)","paper_bgcolor":"rgba(255,255,255,1)","font":{"color":"rgba(0,0,0,1)","family":"","size":14.6118721461187},"xaxis":{"domain":[0,1],"automargin":true,"type":"linear","autorange":false,"range":[0.4,9.6],"tickmode":"array","ticktext":["C1","C2","C3","C4","C5","C6","C7","C8","C9"],"tickvals":[1,2,3,4,5,6,7,8,9],"categoryorder":"array","categoryarray":["C1","C2","C3","C4","C5","C6","C7","C8","C9"],"nticks":null,"ticks":"outside","tickcolor":"rgba(51,51,51,1)","ticklen":3.65296803652968,"tickwidth":0.66417600664176,"showticklabels":true,"tickfont":{"color":"rgba(77,77,77,1)","family":"","size":11.689497716895},"tickangle":-0,"showline":false,"linecolor":null,"linewidth":0,"showgrid":true,"gridcolor":"rgba(255,255,255,1)","gridwidth":0.66417600664176,"zeroline":false,"anchor":"y","title":{"text":"Cluster","font":{"color":"rgba(0,0,0,1)","family":"","size":14.6118721461187}},"hoverformat":".2f"},"yaxis":{"domain":[0,1],"automargin":true,"type":"linear","autorange":false,"range":[-4.73125,99.35625],"tickmode":"array","ticktext":["0","25","50","75"],"tickvals":[0,25,50,75],"categoryorder":"array","categoryarray":["0","25","50","75"],"nticks":null,"ticks":"outside","tickcolor":"rgba(51,51,51,1)","ticklen":3.65296803652968,"tickwidth":0.66417600664176,"showticklabels":true,"tickfont":{"color":"rgba(77,77,77,1)","family":"","size":11.689497716895},"tickangle":-0,"showline":false,"linecolor":null,"linewidth":0,"showgrid":true,"gridcolor":"rgba(255,255,255,1)","gridwidth":0.66417600664176,"zeroline":false,"anchor":"x","title":{"text":"","font":{"color":"rgba(0,0,0,1)","family":"","size":14.6118721461187}},"hoverformat":".2f"},"shapes":[{"type":"rect","fillcolor":null,"line":{"color":null,"width":0,"linetype":[]},"yref":"paper","xref":"paper","x0":0,"x1":1,"y0":0,"y1":1}],"showlegend":true,"legend":{"bgcolor":"rgba(255,255,255,1)","bordercolor":"transparent","borderwidth":1.88976377952756,"font":{"color":"rgba(0,0,0,1)","family":"","size":11.689497716895},"y":1},"hovermode":"closest","barmode":"relative"},"config":{"doubleClick":"reset","showSendToCloud":false},"source":"A","attrs":{"3d145cbd74de":{"x":{},"y":{},"fill":{},"type":"bar"}},"cur_data":"3d145cbd74de","visdat":{"3d145cbd74de":["function (y) ","x"]},"highlight":{"on":"plotly_click","persistent":false,"dynamic":false,"selectize":false,"opacityDim":0.2,"selected":{"opacity":1},"debounce":0},"shinyEvents":["plotly_hover","plotly_click","plotly_selected","plotly_relayout","plotly_brushed","plotly_brushing","plotly_clickannotation","plotly_doubleclick","plotly_deselect","plotly_afterplot","plotly_sunburstclick"],"base_url":"https://plot.ly"},"evals":[],"jsHooks":[]}</script>
<p class="caption">
Figure 4.12: Mineral compositions of the nine clusters based on the mean diffractogram
</p>
</div>
<p>Together the geochemical (Figure <a href="cluster-analysis.html#fig:cluster-geochem-barplot">4.10</a>) and mineralogical (Figure <a href="cluster-analysis.html#fig:cluster-quant-barplot">4.12</a>) barplots can be used to interpret a range of relationships between the soil mineral composition and the nutrient concentrations, for instance:</p>
<ol style="list-style-type: decimal">
<li>The notable K enrichment in the soils of Cluster 6 most likely results from the relatively high concentrations of K-feldspar minerals in these soils.</li>
<li>Soils in Clusters 8 and 9 are deficient in all nutrients due to the dominance of quartz in combination with a near absence of clay minerals and/or Fe/Ti(hydr)oxides</li>
<li>Soils in Cluster 2 are particularly enriched in Ca due to the high concentrations of plagioclase, expandable/ML clays and calcite (not plotted but can be observed in the tabulated data) minerals.</li>
</ol>
<p>This example ultimately acts to highlight the utility of ‘Digital’ methods of analysis applied to soil XRPD data. Whilst this example focuses on total nutrient concentrations, the method can also be applied to the Mehlich-3 extractable element concentrations that are also included within the <code>props</code> data. For further analysis and discussion on the application of cluster analysis to this dataset, along with additional methods of compositional data analysis, see <span class="citation">Butler et al. (<a href="#ref-Butler2020" role="doc-biblioref">2020</a>)</span> and the accompanying Supplementary Material.</p>

</div>
</div>
<h3>References<a href="references.html#references" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div id="refs" class="references csl-bib-body hanging-indent">
<div id="ref-Butler2020" class="csl-entry">
Butler, Benjamin M, Javier Palarea-Albaladejo, Keith D Shepherd, Kamau M Nyambura, Erick K Towett, Andrew M Sila, and Stephen Hillier. 2020. <span>“Mineral–Nutrient Relationships in <span class="nocase">African soils assessed using cluster analysis of X-ray powder diffraction patterns and compositional methods</span>.”</span> <em>Geoderma</em> 375: 114474. <a href="https://doi.org/10.1016/j.geoderma.2020.114474">https://doi.org/10.1016/j.geoderma.2020.114474</a>.
</div>
<div id="ref-Jolliffe1986" class="csl-entry">
Jolliffe, IT. 1986. <span>“Principal Component Analysis. Series: Springer Series in Statistics.”</span> Springer, NY.
</div>
<div id="ref-e1071" class="csl-entry">
Meyer, David, Evgenia Dimitriadou, Kurt Hornik, Andreas Weingessel, and Friedrich Leisch. 2021. <em>E1071: Misc Functions of the Department of Statistics, Probability Theory Group (Formerly: E1071), TU Wien</em>. <a href="https://CRAN.R-project.org/package=e1071">https://CRAN.R-project.org/package=e1071</a>.
</div>
<div id="ref-Montero2010" class="csl-entry">
Montero-Serrano, Jean Carlos, Javier Palarea-Albaladejo, Josep A Martı́n-Fernández, Manuel Martı́nez-Santana, and José Vicente Gutiérrez-Martı́n. 2010. <span>“Sedimentary Chemofacies Characterization by Means of Multivariate Analysis.”</span> <em>Sedimentary Geology</em> 228 (3-4): 218–28.
</div>
<div id="ref-Rossel2016" class="csl-entry">
Rossel, RA Viscarra, T Behrens, E Ben-Dor, DJ Brown, JAM Demattê, Keith D Shepherd, Z Shi, et al. 2016. <span>“A Global Spectral Library to Characterize the World’s Soil.”</span> <em>Earth-Science Reviews</em> 155: 198–230. <a href="https://doi.org/10.1016/j.earscirev.2016.01.012">https://doi.org/10.1016/j.earscirev.2016.01.012</a>.
</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="machine-learning.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="mars.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": null,
"search": {
"engine": "fuse",
"options": null
},
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
