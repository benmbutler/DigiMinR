<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Chapter 5 From Mars to Mull: Interplanetary comparison of soil XRPD data | Digital Soil Mineralogy with R</title>
  <meta name="description" content="An online course detailing various methods for data-driven analysis of X-ray powder diffraction using R" />
  <meta name="generator" content="bookdown 0.22 and GitBook 2.6.7" />

  <meta property="og:title" content="Chapter 5 From Mars to Mull: Interplanetary comparison of soil XRPD data | Digital Soil Mineralogy with R" />
  <meta property="og:type" content="book" />
  
  <meta property="og:image" content="/figures/dsm_graphic.png" />
  <meta property="og:description" content="An online course detailing various methods for data-driven analysis of X-ray powder diffraction using R" />
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Chapter 5 From Mars to Mull: Interplanetary comparison of soil XRPD data | Digital Soil Mineralogy with R" />
  
  <meta name="twitter:description" content="An online course detailing various methods for data-driven analysis of X-ray powder diffraction using R" />
  <meta name="twitter:image" content="/figures/dsm_graphic.png" />

<meta name="author" content="Benjamin Butler and Steve Hillier" />


<meta name="date" content="2021-09-08" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="cluster-analysis.html"/>
<link rel="next" href="references.html"/>
<script src="libs/header-attrs-2.10/header-attrs.js"></script>
<script src="libs/jquery-3.5.1/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />









<link href="libs/anchor-sections-1.0.1/anchor-sections.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.0.1/anchor-sections.js"></script>
<script src="libs/font-awesome-5.13.0/js/script.js"></script>
<script src="libs/htmlwidgets-1.5.3/htmlwidgets.js"></script>
<link href="libs/leaflet-1.3.1/leaflet.css" rel="stylesheet" />
<script src="libs/leaflet-1.3.1/leaflet.js"></script>
<link href="libs/leafletfix-1.0.0/leafletfix.css" rel="stylesheet" />
<script src="libs/proj4-2.6.2/proj4.min.js"></script>
<script src="libs/Proj4Leaflet-1.0.1/proj4leaflet.js"></script>
<link href="libs/rstudio_leaflet-1.3.1/rstudio_leaflet.css" rel="stylesheet" />
<script src="libs/leaflet-binding-2.0.4.1/leaflet.js"></script>
<script src="libs/plotly-binding-4.9.4.1/plotly.js"></script>
<script src="libs/typedarray-0.1/typedarray.min.js"></script>
<link href="libs/crosstalk-1.1.1/css/crosstalk.css" rel="stylesheet" />
<script src="libs/crosstalk-1.1.1/js/crosstalk.min.js"></script>
<link href="libs/plotly-htmlwidgets-css-1.57.1/plotly-htmlwidgets.css" rel="stylesheet" />
<script src="libs/plotly-main-1.57.1/plotly-latest.min.js"></script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<style type="text/css">
/* Used with Pandoc 2.11+ new --citeproc when CSL is used */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
}
.hanging div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">Digital Soil Mineralogy with R</a></li>

<li class="divider"></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Preface</a>
<ul>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#prerequisites"><i class="fa fa-check"></i>Prerequisites</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#code-conventions"><i class="fa fa-check"></i>Code Conventions</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#what-to-expect"><i class="fa fa-check"></i>What to expect</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#about-the-authors"><i class="fa fa-check"></i>About the authors</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#acknowledgments"><i class="fa fa-check"></i>Acknowledgments</a></li>
</ul></li>
<li class="chapter" data-level="1" data-path="intro.html"><a href="intro.html"><i class="fa fa-check"></i><b>1</b> Working with XRPD data in R</a>
<ul>
<li class="chapter" data-level="1.1" data-path="intro.html"><a href="intro.html#basic-form"><i class="fa fa-check"></i><b>1.1</b> The basic form of XRPD data</a></li>
<li class="chapter" data-level="1.2" data-path="intro.html"><a href="intro.html#loading-data"><i class="fa fa-check"></i><b>1.2</b> Loading XRPD data</a>
<ul>
<li class="chapter" data-level="1.2.1" data-path="intro.html"><a href="intro.html#powDLL"><i class="fa fa-check"></i><b>1.2.1</b> Option 1: PowDLL</a></li>
<li class="chapter" data-level="1.2.2" data-path="intro.html"><a href="intro.html#loading-directly"><i class="fa fa-check"></i><b>1.2.2</b> Option 2: Loading directly into R</a></li>
<li class="chapter" data-level="1.2.3" data-path="intro.html"><a href="intro.html#loading-multiple"><i class="fa fa-check"></i><b>1.2.3</b> Loading multiple files</a></li>
</ul></li>
<li class="chapter" data-level="1.3" data-path="intro.html"><a href="intro.html#plotting-data"><i class="fa fa-check"></i><b>1.3</b> Plotting XRPD data</a>
<ul>
<li class="chapter" data-level="1.3.1" data-path="intro.html"><a href="intro.html#plotting-xy-objects"><i class="fa fa-check"></i><b>1.3.1</b> Plotting <code>XY</code> objects</a></li>
<li class="chapter" data-level="1.3.2" data-path="intro.html"><a href="intro.html#plotting-multixy-objects"><i class="fa fa-check"></i><b>1.3.2</b> Plotting <code>multiXY</code> objects</a></li>
<li class="chapter" data-level="1.3.3" data-path="intro.html"><a href="intro.html#ggplot2-intro"><i class="fa fa-check"></i><b>1.3.3</b> Modifying plots with <strong>ggplot2</strong></a></li>
</ul></li>
<li class="chapter" data-level="1.4" data-path="intro.html"><a href="intro.html#manipulating-data"><i class="fa fa-check"></i><b>1.4</b> Manipulating XRPD data</a>
<ul>
<li class="chapter" data-level="1.4.1" data-path="intro.html"><a href="intro.html#subsetting"><i class="fa fa-check"></i><b>1.4.1</b> Subsetting XRPD data</a></li>
<li class="chapter" data-level="1.4.2" data-path="intro.html"><a href="intro.html#transformations"><i class="fa fa-check"></i><b>1.4.2</b> Transformations of count intensities</a></li>
<li class="chapter" data-level="1.4.3" data-path="intro.html"><a href="intro.html#interpolation"><i class="fa fa-check"></i><b>1.4.3</b> Interpolation</a></li>
<li class="chapter" data-level="1.4.4" data-path="intro.html"><a href="intro.html#alignment"><i class="fa fa-check"></i><b>1.4.4</b> Alignment</a></li>
<li class="chapter" data-level="1.4.5" data-path="intro.html"><a href="intro.html#background"><i class="fa fa-check"></i><b>1.4.5</b> Background fitting</a></li>
<li class="chapter" data-level="1.4.6" data-path="intro.html"><a href="intro.html#to-data-frame"><i class="fa fa-check"></i><b>1.4.6</b> Converting to and from data frames</a></li>
<li class="chapter" data-level="1.4.7" data-path="intro.html"><a href="intro.html#two-theta-transform"><i class="fa fa-check"></i><b>1.4.7</b> 2θ transformation</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="2" data-path="quant.html"><a href="quant.html"><i class="fa fa-check"></i><b>2</b> Quantitative phase analysis</a>
<ul>
<li class="chapter" data-level="2.1" data-path="quant.html"><a href="quant.html#full-pattern-summation-with-powdr"><i class="fa fa-check"></i><b>2.1</b> Full pattern summation with <strong>powdR</strong></a>
<ul>
<li class="chapter" data-level="2.1.1" data-path="quant.html"><a href="quant.html#powdRlib"><i class="fa fa-check"></i><b>2.1.1</b> The <code>powdRlib</code> object</a></li>
<li class="chapter" data-level="2.1.2" data-path="quant.html"><a href="quant.html#full-pattern-summation-with-fps"><i class="fa fa-check"></i><b>2.1.2</b> Full pattern summation with <code>fps()</code></a></li>
<li class="chapter" data-level="2.1.3" data-path="quant.html"><a href="quant.html#afps"><i class="fa fa-check"></i><b>2.1.3</b> Automated full pattern summation with <code>afps()</code></a></li>
<li class="chapter" data-level="2.1.4" data-path="quant.html"><a href="quant.html#additional-fps-and-afps-functionality"><i class="fa fa-check"></i><b>2.1.4</b> Additional <code>fps()</code> and <code>afps()</code> functionality</a></li>
</ul></li>
<li class="chapter" data-level="2.2" data-path="quant.html"><a href="quant.html#plotting-powdrfps-and-powdrafps-objects"><i class="fa fa-check"></i><b>2.2</b> Plotting <code>powdRfps</code> and <code>powdRafps</code> objects</a></li>
<li class="chapter" data-level="2.3" data-path="quant.html"><a href="quant.html#quantifying-multiple-samples"><i class="fa fa-check"></i><b>2.3</b> Quantifying multiple samples</a>
<ul>
<li class="chapter" data-level="2.3.1" data-path="quant.html"><a href="quant.html#lapply"><i class="fa fa-check"></i><b>2.3.1</b> <code>lapply()</code></a></li>
<li class="chapter" data-level="2.3.2" data-path="quant.html"><a href="quant.html#parallel-processing"><i class="fa fa-check"></i><b>2.3.2</b> Parallel processing</a></li>
</ul></li>
<li class="chapter" data-level="2.4" data-path="quant.html"><a href="quant.html#summarising-mineralogy"><i class="fa fa-check"></i><b>2.4</b> Summarising mineralogy</a></li>
<li class="chapter" data-level="2.5" data-path="quant.html"><a href="quant.html#the-powdr-shiny-app"><i class="fa fa-check"></i><b>2.5</b> The powdR Shiny app</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="machine-learning.html"><a href="machine-learning.html"><i class="fa fa-check"></i><b>3</b> Machine learning with soil XRPD data</a>
<ul>
<li class="chapter" data-level="3.1" data-path="machine-learning.html"><a href="machine-learning.html#loading-packages-and-data"><i class="fa fa-check"></i><b>3.1</b> Loading packages and data</a></li>
<li class="chapter" data-level="3.2" data-path="machine-learning.html"><a href="machine-learning.html#cubist-exploration"><i class="fa fa-check"></i><b>3.2</b> Data exploration</a>
<ul>
<li class="chapter" data-level="3.2.1" data-path="machine-learning.html"><a href="machine-learning.html#spatial-data"><i class="fa fa-check"></i><b>3.2.1</b> Spatial data</a></li>
<li class="chapter" data-level="3.2.2" data-path="machine-learning.html"><a href="machine-learning.html#geochemical-data"><i class="fa fa-check"></i><b>3.2.2</b> Geochemical data</a></li>
<li class="chapter" data-level="3.2.3" data-path="machine-learning.html"><a href="machine-learning.html#xrpd-data"><i class="fa fa-check"></i><b>3.2.3</b> XRPD data</a></li>
</ul></li>
<li class="chapter" data-level="3.3" data-path="machine-learning.html"><a href="machine-learning.html#cubist-pretreatment"><i class="fa fa-check"></i><b>3.3</b> Data pre-treatment</a>
<ul>
<li class="chapter" data-level="3.3.1" data-path="machine-learning.html"><a href="machine-learning.html#alignment-1"><i class="fa fa-check"></i><b>3.3.1</b> Alignment</a></li>
<li class="chapter" data-level="3.3.2" data-path="machine-learning.html"><a href="machine-learning.html#subsetting-1"><i class="fa fa-check"></i><b>3.3.2</b> Subsetting</a></li>
<li class="chapter" data-level="3.3.3" data-path="machine-learning.html"><a href="machine-learning.html#mean-centering"><i class="fa fa-check"></i><b>3.3.3</b> Mean centering</a></li>
</ul></li>
<li class="chapter" data-level="3.4" data-path="machine-learning.html"><a href="machine-learning.html#creation-of-training-and-test-datasets"><i class="fa fa-check"></i><b>3.4</b> Creation of training and test datasets</a></li>
<li class="chapter" data-level="3.5" data-path="machine-learning.html"><a href="machine-learning.html#using-cubist"><i class="fa fa-check"></i><b>3.5</b> Using Cubist</a></li>
<li class="chapter" data-level="3.6" data-path="machine-learning.html"><a href="machine-learning.html#inspection-of-cubist-models"><i class="fa fa-check"></i><b>3.6</b> Inspection of Cubist models</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="cluster-analysis.html"><a href="cluster-analysis.html"><i class="fa fa-check"></i><b>4</b> Cluster analysis of soil XRPD data</a>
<ul>
<li class="chapter" data-level="4.1" data-path="cluster-analysis.html"><a href="cluster-analysis.html#loading-packages-and-data-1"><i class="fa fa-check"></i><b>4.1</b> Loading packages and data</a></li>
<li class="chapter" data-level="4.2" data-path="cluster-analysis.html"><a href="cluster-analysis.html#clustering-pca"><i class="fa fa-check"></i><b>4.2</b> Principal component analysis</a>
<ul>
<li class="chapter" data-level="4.2.1" data-path="cluster-analysis.html"><a href="cluster-analysis.html#interpreting-principal-components"><i class="fa fa-check"></i><b>4.2.1</b> Interpreting principal components</a></li>
</ul></li>
<li class="chapter" data-level="4.3" data-path="cluster-analysis.html"><a href="cluster-analysis.html#fuzzy-clustering"><i class="fa fa-check"></i><b>4.3</b> Fuzzy clustering</a>
<ul>
<li class="chapter" data-level="4.3.1" data-path="cluster-analysis.html"><a href="cluster-analysis.html#cluster-membership"><i class="fa fa-check"></i><b>4.3.1</b> Cluster membership</a></li>
<li class="chapter" data-level="4.3.2" data-path="cluster-analysis.html"><a href="cluster-analysis.html#subsetting-clusters"><i class="fa fa-check"></i><b>4.3.2</b> Subsetting Clusters</a></li>
</ul></li>
<li class="chapter" data-level="4.4" data-path="cluster-analysis.html"><a href="cluster-analysis.html#exploring-results"><i class="fa fa-check"></i><b>4.4</b> Exploring results</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="mars.html"><a href="mars.html"><i class="fa fa-check"></i><b>5</b> From Mars to Mull: Interplanetary comparison of soil XRPD data</a>
<ul>
<li class="chapter" data-level="5.1" data-path="mars.html"><a href="mars.html#mars-package"><i class="fa fa-check"></i><b>5.1</b> Required packages</a></li>
<li class="chapter" data-level="5.2" data-path="mars.html"><a href="mars.html#datasets"><i class="fa fa-check"></i><b>5.2</b> Datasets</a>
<ul>
<li class="chapter" data-level="5.2.1" data-path="mars.html"><a href="mars.html#mars-data"><i class="fa fa-check"></i><b>5.2.1</b> Mars Science Laboratory XRPD Data</a></li>
<li class="chapter" data-level="5.2.2" data-path="mars.html"><a href="mars.html#mars-scotland-data"><i class="fa fa-check"></i><b>5.2.2</b> Scottish Soil XRPD data</a></li>
</ul></li>
<li class="chapter" data-level="5.3" data-path="mars.html"><a href="mars.html#mars-manipulation"><i class="fa fa-check"></i><b>5.3</b> Data manipulation</a>
<ul>
<li class="chapter" data-level="5.3.1" data-path="mars.html"><a href="mars.html#θ-transformation"><i class="fa fa-check"></i><b>5.3.1</b> 2θ transformation</a></li>
<li class="chapter" data-level="5.3.2" data-path="mars.html"><a href="mars.html#θ-interpolation"><i class="fa fa-check"></i><b>5.3.2</b> 2θ interpolation</a></li>
</ul></li>
<li class="chapter" data-level="5.4" data-path="mars.html"><a href="mars.html#comparison-of-xrpd-data"><i class="fa fa-check"></i><b>5.4</b> Comparison of XRPD data</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="references.html"><a href="references.html"><i class="fa fa-check"></i>References</a></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Digital Soil Mineralogy with R</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="mars" class="section level1" number="5">
<h1><span class="header-section-number">Chapter 5</span> From Mars to Mull: Interplanetary comparison of soil XRPD data</h1>
<p>This chapter will use <a href="https://pds.nasa.gov/ds-view/pds/viewDataset.jsp?dsid=MSL-M-CHEMIN-4-RDR-V1.0">data</a> from the Mars Science Laboratory (MSL) onboard NASA’s Curiosity Rover. The MSL XRPD data were obtained from the <a href="https://pds-geosciences.wustl.edu/msl/msl-m-chemin-4-rdr-v1/">Geosciences Data Volume Online</a> as ASCII ‘.csv’ files on the 17<sup>th</sup> July 2021 and loaded into R <span class="citation">(<a href="#ref-Vaniman2012" role="doc-biblioref">Vaniman 2012</a>)</span> using <code>read.csv()</code>.</p>
<p>The mineral compositions of the samples in the MSL dataset are described and discussed in numerous publications <span class="citation">(<a href="#ref-Bish2013" role="doc-biblioref">Bish et al. 2013</a>; <a href="#ref-Grotzinger2014" role="doc-biblioref">Grotzinger et al. 2014</a>; <a href="#ref-Vaniman2014" role="doc-biblioref">Vaniman et al. 2014</a>; <a href="#ref-Bristow2015" role="doc-biblioref">Bristow et al. 2015</a>, <a href="#ref-Bristow2018" role="doc-biblioref">2018</a>)</span>. The many clay minerals identified and quantified from the XRPD data provides compelling evidence that the Martian surface material has been altered by water, which has profound implications for the potential existence of microbial life on Mars.</p>
<p>Qualitative and quantitative analysis of clay minerals is a notoriously challenging undertaking, often requiring separation of the clay fraction onto oriented slides combined with several ethylene-glycol and heat treatments. The MSL cannot separate the clay fraction from Martian samples and is limited to bulk sample analysis, where clay minerals are analysed in a randomly oriented powder along with all other crystalline and amorphous components within the sample. This has acted to create uncertainty in the analysis of clay minerals from MSL XRPD data <span class="citation">(<a href="#ref-Bish2013" role="doc-biblioref">Bish et al. 2013</a>; <a href="#ref-Grotzinger2014" role="doc-biblioref">Grotzinger et al. 2014</a>; <a href="#ref-Vaniman2014" role="doc-biblioref">Vaniman et al. 2014</a>; <a href="#ref-Bristow2018" role="doc-biblioref">Bristow et al. 2018</a>)</span>. Identification of Earth based analogues for Martian soil mineralogy therefore represent an opportunity to facilitate more accurate interpretation of the clay mineralogy encoded within MSL XRPD data. Further, understanding the development of mineralogically analogous soils on Earth has potential to aid the development of hypotheses for the environmental properties of aqueous systems on ancient Mars <span class="citation">(<a href="#ref-Marlow2008" role="doc-biblioref">Marlow, Martins, and Sephton 2008</a>)</span>.</p>
<p>Here, soil XRPD data from across Scotland <span class="citation">(<a href="#ref-Butler2018" role="doc-biblioref">Butler, O’Rourke, and Hillier 2018</a>)</span> will be compared to the MSL XRPD data in the aim of identifying potential soil analogues for Martian mineralogy.</p>
<div id="mars-package" class="section level2" number="5.1">
<h2><span class="header-section-number">5.1</span> Required packages</h2>
<p>Data for this chapter are stored within a <strong>mars2mull</strong> R package <a href="https://github.com/benmbutler/mars2mull/">hosted on GitHub</a>. The package can be installed using the <strong>devtools</strong> package</p>
<div class="sourceCode" id="cb196"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb196-1"><a href="mars.html#cb196-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Install devtools if it&#39;s not already on your machine</span></span>
<span id="cb196-2"><a href="mars.html#cb196-2" aria-hidden="true" tabindex="-1"></a><span class="fu">install.packages</span>(<span class="st">&quot;devtools&quot;</span>)</span>
<span id="cb196-3"><a href="mars.html#cb196-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb196-4"><a href="mars.html#cb196-4" aria-hidden="true" tabindex="-1"></a><span class="co">#Use devtools to install the mars2mull package from GitHub</span></span>
<span id="cb196-5"><a href="mars.html#cb196-5" aria-hidden="true" tabindex="-1"></a>devtools<span class="sc">::</span><span class="fu">install_github</span>(<span class="st">&quot;benmbutler/mars2mull&quot;</span>)</span></code></pre></div>
<p>Running the code for this chapter requires the <strong>mars2mull</strong> package along with a few other packages that have already been introduced and used in previous Chapters of this course:</p>
<div class="sourceCode" id="cb197"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb197-1"><a href="mars.html#cb197-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(mars2mull)</span>
<span id="cb197-2"><a href="mars.html#cb197-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(powdR)</span>
<span id="cb197-3"><a href="mars.html#cb197-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb197-4"><a href="mars.html#cb197-4" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(leaflet)</span></code></pre></div>
</div>
<div id="datasets" class="section level2" number="5.2">
<h2><span class="header-section-number">5.2</span> Datasets</h2>
<p align="center">
<iframe width="560" height="315" src="https://www.youtube.com/embed/fNLmy-yROeo" frameborder="0" allowfullscreen>
</iframe>
</p>
<div id="mars-data" class="section level3" number="5.2.1">
<h3><span class="header-section-number">5.2.1</span> Mars Science Laboratory XRPD Data</h3>
<p>Martian XRPD data within the package have been extracted from NASA’s <a href="https://pds-geosciences.wustl.edu/msl/msl-m-chemin-4-rdr-v1/">Geosciences Data Volume Online</a> <span class="citation">(<a href="#ref-Vaniman2012" role="doc-biblioref">Vaniman 2012</a>)</span> and renamed according to the various sites that were sampled. The diffractograms of 31 Martian samples are contained within the <code>mars_xrpd</code> data in <a href="intro.html#loading-multiple"><code>multiXY</code> format</a>. All diffractograms were collected using Co-Kα radiation, with further details of the data collection and instrumental parameters provided elsewhere <span class="citation">(<a href="#ref-Bish2013" role="doc-biblioref">Bish et al. 2013</a>; <a href="#ref-Grotzinger2014" role="doc-biblioref">Grotzinger et al. 2014</a>; <a href="#ref-Vaniman2014" role="doc-biblioref">Vaniman et al. 2014</a>; <a href="#ref-Bristow2015" role="doc-biblioref">Bristow et al. 2015</a>, <a href="#ref-Bristow2018" role="doc-biblioref">2018</a>)</span>. Upon loading the <code>mars_xrpd</code> data here, we will subset the diffractograms to 2θ &gt;= 4.5 degrees in order to remove the contributions from the sample holder at low angles:</p>
<div class="sourceCode" id="cb198"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb198-1"><a href="mars.html#cb198-1" aria-hidden="true" tabindex="-1"></a><span class="co">#load the Martian XRPD data</span></span>
<span id="cb198-2"><a href="mars.html#cb198-2" aria-hidden="true" tabindex="-1"></a><span class="fu">data</span>(mars_xrpd)</span>
<span id="cb198-3"><a href="mars.html#cb198-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb198-4"><a href="mars.html#cb198-4" aria-hidden="true" tabindex="-1"></a><span class="co">#Subset the Martian XRPD data to &gt;4.5</span></span>
<span id="cb198-5"><a href="mars.html#cb198-5" aria-hidden="true" tabindex="-1"></a><span class="co">#to avoid single from sample holder</span></span>
<span id="cb198-6"><a href="mars.html#cb198-6" aria-hidden="true" tabindex="-1"></a>mars_xrpd <span class="ot">&lt;-</span> <span class="fu">as_multi_xy</span>(<span class="fu">lapply</span>(mars_xrpd, subset,</span>
<span id="cb198-7"><a href="mars.html#cb198-7" aria-hidden="true" tabindex="-1"></a>                                tth <span class="sc">&gt;=</span> <span class="fl">4.5</span>))</span>
<span id="cb198-8"><a href="mars.html#cb198-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb198-9"><a href="mars.html#cb198-9" aria-hidden="true" tabindex="-1"></a><span class="co">#plot the 31 Martian diffractograms</span></span>
<span id="cb198-10"><a href="mars.html#cb198-10" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(mars_xrpd, <span class="at">wavelength =</span> <span class="st">&quot;Co&quot;</span>,</span>
<span id="cb198-11"><a href="mars.html#cb198-11" aria-hidden="true" tabindex="-1"></a>     <span class="at">normalise =</span> <span class="cn">TRUE</span>, <span class="at">interactive =</span> <span class="cn">FALSE</span>)</span></code></pre></div>
<div class="figure" style="text-align: center"><span id="fig:unnamed-chunk-114"></span>
<img src="DigiMinR_files/figure-html/unnamed-chunk-114-1.png" alt="The 31 diffractograms within the mars_xrpd data. Using interactive = TRUE in the function call will allow for easier interpretation." width="100%" />
<p class="caption">
Figure 5.1: The 31 diffractograms within the mars_xrpd data. Using interactive = TRUE in the function call will allow for easier interpretation.
</p>
</div>
<p>Further to the XRPD data, additional information about each of the samples is provided in the <code>mars_id</code> data, and more help can be accessed via <code>?mars_id</code>:</p>
<div class="sourceCode" id="cb199"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb199-1"><a href="mars.html#cb199-1" aria-hidden="true" tabindex="-1"></a><span class="co">#load the extra information about the samples interactively</span></span>
<span id="cb199-2"><a href="mars.html#cb199-2" aria-hidden="true" tabindex="-1"></a><span class="fu">data</span>(mars_id)</span>
<span id="cb199-3"><a href="mars.html#cb199-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb199-4"><a href="mars.html#cb199-4" aria-hidden="true" tabindex="-1"></a><span class="co">#View the first 6 rows of the mars_id data</span></span>
<span id="cb199-5"><a href="mars.html#cb199-5" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(mars_id)</span></code></pre></div>
<pre><code>##          SITE_NAME                           PRODUCT_ID SAMPLE_TYPE SOL_START
## 1       Rocknest_4 cma_404470826rda00790050104ch11503p1       Scoop        77
## 2       Rocknest_5 cma_405889312rda00950050104ch11504p1       Scoop        94
## 3       Cumberland cmb_434685266rda04190180786ch00113p1       Drill       418
## 4       John_Klein cmb_439549561rda04740240192ch00111p1       Drill       473
## 5         Windjana cmb_452848863rda06240311330ch00111p1       Drill       623
## 6 Confidence_Hills cmb_465487684rda07660421020ch00113p2       Drill       765
##   SOL_END
## 1      88
## 2     119
## 3     432
## 4     488
## 5     632
## 6     785</code></pre>
<p>The locations of the 31 samples can be explored using the <code>SOL_START</code> and <code>SOL_END</code> columns in the <code>mars_id</code> data in combination with <a href="https://mars.nasa.gov/maps/location/?mission=Curiosity">NASA’s online map for Curiosity’s location</a> (screenshot below).</p>
<center>
<a href="https://mars.nasa.gov/maps/location/?mission=Curiosity"><img src="figures/curiosity-screenshot_small.png" />
</p>
</a>
</center>
</div>
<div id="mars-scotland-data" class="section level3" number="5.2.2">
<h3><span class="header-section-number">5.2.2</span> Scottish Soil XRPD data</h3>
<p>The Scottish soil diffractograms relate to 703 samples collected by horizon from 186 sites across Scotland. Samples were collected primarily as part of the second National Soil Inventory of Scotland <span class="citation">(NSIS, <a href="#ref-Butler2018" role="doc-biblioref">Butler, O’Rourke, and Hillier 2018</a>)</span> and are supplemented by additional samples of rare Scottish soils. Information about the samples is provided in the <code>scotland_locations</code> data:</p>
<div class="sourceCode" id="cb201"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb201-1"><a href="mars.html#cb201-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Load the scotland_locations data</span></span>
<span id="cb201-2"><a href="mars.html#cb201-2" aria-hidden="true" tabindex="-1"></a><span class="fu">data</span>(scotland_locations)</span>
<span id="cb201-3"><a href="mars.html#cb201-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb201-4"><a href="mars.html#cb201-4" aria-hidden="true" tabindex="-1"></a><span class="co">#Show the first 6 rows of the data</span></span>
<span id="cb201-5"><a href="mars.html#cb201-5" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(scotland_locations)</span></code></pre></div>
<pre><code>##    SAMPLE_ID PROFILE_ID PROFILE_LONGITUDE PROFILE_LATITUDE
## 72   S891338     S13735         -3.004763         57.62634
## 73   S891345     S13516         -3.004763         57.62620
## 74   S891346     S13516         -3.004763         57.62620
## 75   S891347     S13516         -3.004763         57.62620
## 76   S891355     S13517         -2.666556         57.44877
## 77   S891356     S13517         -2.666556         57.44877</code></pre>
<div class="sourceCode" id="cb203"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb203-1"><a href="mars.html#cb203-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Plot the data spatially</span></span>
<span id="cb203-2"><a href="mars.html#cb203-2" aria-hidden="true" tabindex="-1"></a><span class="fu">leaflet</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb203-3"><a href="mars.html#cb203-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">addTiles</span>() <span class="sc">%&gt;%</span></span>
<span id="cb203-4"><a href="mars.html#cb203-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">addCircleMarkers</span>(<span class="at">data =</span> scotland_locations,</span>
<span id="cb203-5"><a href="mars.html#cb203-5" aria-hidden="true" tabindex="-1"></a>                   <span class="sc">~</span>PROFILE_LONGITUDE, <span class="sc">~</span>PROFILE_LATITUDE,</span>
<span id="cb203-6"><a href="mars.html#cb203-6" aria-hidden="true" tabindex="-1"></a>                   <span class="at">color =</span> <span class="st">&quot;blue&quot;</span>,</span>
<span id="cb203-7"><a href="mars.html#cb203-7" aria-hidden="true" tabindex="-1"></a>                   <span class="at">opacity =</span> <span class="dv">1</span>)</span></code></pre></div>
<div class="figure" style="text-align: center"><span id="fig:unnamed-chunk-116"></span>
<div id="htmlwidget-c56f9c37c00ed0cb3527" style="width:80%;height:480px;" class="leaflet html-widget"></div>
<script type="application/json" data-for="htmlwidget-c56f9c37c00ed0cb3527">{"x":{"options":{"crs":{"crsClass":"L.CRS.EPSG3857","code":null,"proj4def":null,"projectedBounds":null,"options":{}}},"calls":[{"method":"addTiles","args":["//{s}.tile.openstreetmap.org/{z}/{x}/{y}.png",null,null,{"minZoom":0,"maxZoom":18,"tileSize":256,"subdomains":"abc","errorTileUrl":"","tms":false,"noWrap":false,"zoomOffset":0,"zoomReverse":false,"opacity":1,"zIndex":1,"detectRetina":false,"attribution":"&copy; <a href=\"http://openstreetmap.org\">OpenStreetMap<\/a> contributors, <a href=\"http://creativecommons.org/licenses/by-sa/2.0/\">CC-BY-SA<\/a>"}]},{"method":"addCircleMarkers","args":[[57.62633895874,57.626197814941,57.626197814941,57.626197814941,57.448768615722,57.448768615722,57.448768615722,57.628425598144,57.628425598144,57.628425598144,57.628425598144,56.361595153808,56.361595153808,56.361595153808,56.361595153808,56.361595153808,56.545337677001,56.545337677001,56.545337677001,56.545337677001,56.365699768066,56.365699768066,56.365699768066,56.365699768066,56.910827636718,56.910827636718,56.910827636718,56.910827636718,56.910827636718,56.910827636718,57.270225524902,57.270225524902,57.270225524902,57.270225524902,57.090770721435,57.090770721435,57.090770721435,57.090770721435,57.623104095458,57.623104095458,57.623104095458,57.623104095458,57.623104095458,56.548461914062,56.548461914062,56.548461914062,56.548461914062,56.548461914062,56.172042846679,56.172042846679,56.172042846679,56.172042846679,56.368633270263,56.368633270263,56.368633270263,56.368633270263,56.185428619384,56.185428619384,56.185428619384,56.185428619384,56.185428619384,56.185428619384,57.45006942749,57.45006942749,57.45006942749,57.45006942749,57.45006942749,57.45006942749,57.630187988281,57.630187988281,57.630187988281,57.629604339599,57.629604339599,57.629604339599,57.619224548339,57.619224548339,57.619224548339,57.619224548339,57.619224548339,57.619224548339,57.269187927246,57.269187927246,57.269187927246,57.089397430419,57.089397430419,57.089397430419,57.263858795166,57.263858795166,57.447315216064,57.447315216064,57.447315216064,57.447315216064,56.727798461914,56.727798461914,56.727798461914,56.727798461914,56.727798461914,56.357059478759,56.357059478759,56.357059478759,56.178050994873,56.178050994873,56.178050994873,56.178050994873,56.724956512451,56.724956512451,56.724956512451,56.724956512451,57.608139038085,57.608283996582,57.608283996582,57.608283996582,57.608283996582,57.428306579589,57.428306579589,57.428306579589,57.428306579589,57.428306579589,57.428306579589,57.601615905761,57.601615905761,57.601615905761,57.601615905761,57.601615905761,57.595024108886,57.595024108886,57.595024108886,57.595024108886,56.907417297363,56.907417297363,56.907417297363,56.907417297363,57.449466705322,57.449466705322,57.449466705322,57.449466705322,57.449466705322,57.449466705322,56.868461608886,56.868461608886,56.868461608886,56.868461608886,56.876476287841,56.876476287841,56.876476287841,56.876476287841,56.876476287841,56.876476287841,56.876476287841,56.876476287841,56.883903503417,56.883903503417,56.883903503417,56.883903503417,56.883903503417,56.696849822998,56.696849822998,56.696849822998,56.696849822998,56.696849822998,56.9097366333,56.9097366333,56.9097366333,57.084197998046,57.084197998046,57.084197998046,57.084197998046,57.084197998046,57.084197998046,56.904766082763,56.904766082763,56.904766082763,56.904766082763,57.259952545166,57.259952545166,57.259952545166,57.259952545166,57.259952545166,56.900600433349,56.900600433349,56.900600433349,56.900600433349,56.889339447021,56.889339447021,56.721080780029,56.721080780029,56.721080780029,56.721080780029,56.721080780029,56.721080780029,56.721080780029,56.896011352539,56.896011352539,56.896011352539,56.896011352539,56.896011352539,57.070232391357,57.075672149658,57.075672149658,57.075672149658,57.075672149658,57.075672149658,57.075672149658,57.249362945556,57.249362945556,57.249362945556,57.249362945556,57.249362945556,57.435283660888,57.435283660888,57.435283660888,57.435283660888,57.435283660888,57.435283660888,57.266998291015,57.266998291015,57.266998291015,57.266998291015,57.266998291015,56.704792022705,56.704792022705,56.704792022705,56.704792022705,56.710948944091,56.710948944091,56.710948944091,56.710948944091,56.710948944091,56.710948944091,56.716106414794,56.716106414794,56.716106414794,56.716106414794,56.165493011474,56.165493011474,56.165493011474,56.165493011474,56.34549331665,56.34549331665,56.351806640625,56.351806640625,56.351806640625,56.351806640625,57.255111694335,57.255111694335,57.255111694335,57.255111694335,57.443397521972,57.443397521972,57.443397521972,57.443397521972,57.443397521972,57.439022064208,57.439022064208,57.439022064208,57.439022064208,57.439022064208,56.540779113769,56.540779113769,56.540779113769,56.540779113769,56.540779113769,56.540779113769,56.540779113769,56.536643981933,56.536643981933,56.536643981933,56.536643981933,56.536643981933,57.088092803955,57.088092803955,57.088092803955,56.550136566162,56.550136566162,56.550136566162,56.550136566162,55.651786804199,55.651786804199,55.651786804199,55.472248077392,55.472248077392,55.472248077392,55.473114013671,55.473114013671,55.104145050048,55.104145050048,55.104145050048,54.920333862304,54.920333862304,54.920333862304,54.920333862304,55.107975006103,55.107975006103,55.107975006103,55.110374450683,55.110374450683,55.110374450683,55.110374450683,56.011699676513,56.011699676513,56.011699676513,56.011699676513,56.011699676513,55.831371307373,55.831371307373,55.831371307373,55.831371307373,55.831371307373,55.832771301269,55.832771301269,55.832771301269,55.2795753479,55.2795753479,55.2795753479,55.2795753479,54.915103912353,54.915103912353,54.915103912353,55.099815368652,55.099815368652,55.099815368652,55.627208709716,55.627208709716,55.627208709716,55.627208709716,55.268081665039,55.268081665039,55.268081665039,55.268081665039,55.470314025878,55.470314025878,55.470314025878,55.292118072509,55.292118072509,55.292118072509,55.292118072509,55.292118072509,55.292118072509,55.649814605712,55.649814605712,55.649814605712,55.649814605712,55.44750213623,55.44750213623,55.44750213623,55.44750213623,55.453792572021,55.453792572021,55.453792572021,55.453792572021,55.638694763183,55.638694763183,55.638694763183,55.646816253662,55.646816253662,55.646816253662,55.643257141113,55.643257141113,55.643257141113,55.081607818603,55.081607818603,55.081607818603,55.088821411132,55.088821411132,55.088821411132,55.094509124755,55.094509124755,55.094509124755,55.094509124755,56.647956848144,56.647956848144,56.647956848144,56.647956848144,56.647956848144,56.838371276855,56.838371276855,56.838371276855,56.838371276855,56.838371276855,55.274181365966,55.274181365966,55.274181365966,55.459114074707,55.459114074707,55.459114074707,55.633518218994,55.633518218994,55.633518218994,54.894584655761,54.894584655761,54.894584655761,54.894584655761,54.901836395263,54.901836395263,54.901836395263,54.901836395263,54.909275054931,54.909275054931,54.909275054931,54.729820251464,55.826976776123,55.826976776123,55.826976776123,55.822891235351,55.822891235351,55.822891235351,55.829460144042,55.829460144042,55.829460144042,55.818279266357,55.818279266357,55.818279266357,55.986038208007,55.986038208007,55.986038208007,55.997760772705,55.997905731201,55.997905731201,55.997905731201,55.997905731201,55.96227645874,55.96227645874,56.320934295654,56.320934295654,56.320934295654,56.320934295654,56.329544067382,56.329544067382,56.329544067382,56.480365753173,56.480365753173,56.480365753173,56.480365753173,56.480365753173,56.491050720214,56.491050720214,56.491050720214,56.491050720214,56.300960540771,56.300960540771,56.300960540771,55.971035003662,55.971035003662,55.971035003662,55.971035003662,56.338420867919,56.338420867919,56.338420867919,56.338420867919,56.338420867919,56.150569915771,56.150569915771,56.150569915771,56.150569915771,56.150569915771,55.463241577148,55.463241577148,55.463241577148,55.463241577148,55.463241577148,55.463241577148,55.284317016601,55.284317016601,55.284317016601,55.284317016601,55.287338256835,55.287338256835,55.287338256835,55.287338256835,55.287338256835,55.467090606689,55.467090606689,55.467090606689,55.467090606689,55.782642364501,55.782642364501,55.782642364501,55.782642364501,55.603790283203,55.603790283203,55.603790283203,55.61209487915,55.61209487915,56.141551971435,57.017768859863,57.017768859863,57.017768859863,55.763217926025,55.763217926025,55.763217926025,55.953094482421,55.953094482421,55.953094482421,55.992603302001,55.992603302001,55.992603302001,55.290588378906,55.290588378906,55.290588378906,55.290588378906,56.002601623535,56.002601623535,56.002601623535,58.511768341064,58.511768341064,58.511768341064,58.511768341064,58.326122283935,58.326122283935,58.326122283935,58.326122283935,58.516971588134,58.516971588134,58.516971588134,58.516971588134,58.516971588134,58.516971588134,55.806762695312,58.140354156494,58.140354156494,58.140354156494,58.146934509277,58.146934509277,58.146934509277,57.96068572998,57.96068572998,57.96068572998,57.773693084716,57.773693084716,57.773693084716,57.773693084716,57.781311035156,57.781311035156,57.781311035156,58.337268829345,58.337268829345,58.337268829345,58.521129608154,58.521129608154,58.521129608154,58.521129608154,58.341194152832,58.341194152832,58.341194152832,58.341194152832,58.490962982177,58.490962982177,58.490962982177,58.490962982177,58.499061584472,58.499061584472,58.320068359375,58.320068359375,57.968116760253,57.968116760253,57.968116760253,57.968116760253,57.787971496582,57.787971496582,57.787971496582,57.787971496582,57.207801818847,57.207801818847,57.207801818847,57.207801818847,57.207801818847,57.364337921142,57.364337921142,57.364337921142,57.364337921142,57.555801391601,57.555801391601,57.555801391601,57.338115692138,57.338115692138,57.338115692138,57.338115692138,57.158805847167,57.158805847167,57.158805847167,57.158805847167,58.311832427978,58.311832427978,58.311832427978,58.132488250732,58.132488250732,58.132488250732,58.132488250732,57.953052520751,57.953052520751,57.953052520751,57.953052520751,57.953052520751,57.24185180664,57.235534667968,57.235534667968,57.235534667968,57.063106536865,57.063106536865,57.063106536865,57.063106536865,57.063106536865,58.152721405029,58.152721405029,58.152721405029,58.152721405029,58.331882476806,58.331882476806,58.331882476806,58.157627105712,58.157627105712,58.157627105712,57.76516342163,57.76516342163,57.76516342163,57.76516342163,57.585857391357,57.585857391357,57.585857391357,57.585857391357,57.755592346191,57.755592346191,57.755592346191,57.755592346191,57.755592346191,57.038673400878,57.038673400878,57.038673400878,56.509712219238,56.509712219238,56.509712219238,56.517505645751,56.526237487792,56.526237487792,56.526237487792,57.397518157958,57.397518157958,57.397518157958,57.397518157958,57.397518157958,57.397518157958,57.576683044433,57.576683044433,57.576683044433,57.576683044433,57.406398773193,57.406398773193,57.406398773193,57.406398773193,57.406398773193,58.092754364013,58.092754364013,58.092754364013,58.080596923828,58.080596923828,58.080596923828,57.888427734375,57.888427734375,57.888427734375,58.259407043457,58.259407043457,58.259407043457,58.259407043457,57.901596069335,57.901596069335,57.901596069335,58.271759033203,58.271759033203,58.271759033203,58.271759033203,56.859561920166,56.859561920166,56.679595947265,56.679595947265,56.679595947265,56.679595947265,58.880302429199,58.880302429199,58.880302429199,58.880302429199,59.063159942626,59.063159942626,59.063159942626,60.143115997314,60.143115997314,59.96348953247,59.96348953247,59.96348953247,60.32266998291,60.32266998291,60.32266998291,57.226833343505,57.226833343505,57.226833343505,57.226833343505,57.047840118408,57.047840118408,57.047840118408,57.047840118408,57.055843353271,57.055843353271,57.055843353271,57.055843353271],[-3.004762887954,-3.004762887954,-3.004762887954,-3.004762887954,-2.666555643081,-2.666555643081,-2.666555643081,-2.669858217239,-2.669858217239,-2.669858217239,-2.669858217239,-3.618841171264,-3.618841171264,-3.618841171264,-3.618841171264,-3.618841171264,-3.301346540451,-3.301346540451,-3.301346540451,-3.301346540451,-3.295026063919,-3.295026063919,-3.295026063919,-3.295026063919,-2.328107357025,-2.328107357025,-2.328107357025,-2.328107357025,-2.328107357025,-2.328107357025,-2.331601142883,-2.331601142883,-2.331601142883,-2.331601142883,-2.330092668533,-2.330092668533,-2.330092668533,-2.330092668533,-3.339563131332,-3.339563131332,-3.339563131332,-3.339563131332,-3.339563131332,-2.975712299346,-2.975712299346,-2.975712299346,-2.975712299346,-2.975712299346,-4.255260944366,-4.255260944366,-4.255260944366,-4.255260944366,-2.971528053283,-2.971528053283,-2.971528053283,-2.971528053283,-3.289392709732,-3.289392709732,-3.289392709732,-3.289392709732,-3.289392709732,-3.289392709732,-2.001076221466,-2.001076221466,-2.001076221466,-2.001076221466,-2.001076221466,-2.001076221466,-1.999518156051,-1.999518156051,-1.999518156051,-2.334935903549,-2.334935903549,-2.334935903549,-3.674026489257,-3.674026489257,-3.674026489257,-3.674026489257,-3.674026489257,-3.674026489257,-2.663447380065,-2.663447380065,-2.663447380065,-2.658648490905,-2.658648490905,-2.658648490905,-3.326491117477,-3.326491117477,-3.001783847808,-3.001783847808,-3.001783847808,-3.001783847808,-2.981049537658,-2.981049537658,-2.981049537658,-2.981049537658,-2.981049537658,-3.942010402679,-3.942010402679,-3.942010402679,-3.933671951293,-3.933671951293,-3.933671951293,-3.933671951293,-3.307337284088,-3.307337284088,-3.307337284088,-3.307337284088,-4.343125343322,-4.343130588531,-4.343130588531,-4.343130588531,-4.343130588531,-4.333040714263,-4.333040714263,-4.333040714263,-4.333040714263,-4.333040714263,-4.333040714263,-4.677327632904,-4.677327632904,-4.677327632904,-4.677327632904,-4.677327632904,-5.011254787445,-5.011254787445,-5.011254787445,-5.011254787445,-2.985121965408,-2.985121965408,-2.985121965408,-2.985121965408,-2.333271741867,-2.333271741867,-2.333271741867,-2.333271741867,-2.333271741867,-2.333271741867,-5.282494544982,-5.282494544982,-5.282494544982,-5.282494544982,-4.954463005065,-4.954463005065,-4.954463005065,-4.954463005065,-4.954463005065,-4.954463005065,-4.954463005065,-4.954463005065,-4.6267080307,-4.6267080307,-4.6267080307,-4.6267080307,-4.6267080307,-4.939261913299,-4.939261913299,-4.939261913299,-4.939261913299,-4.939261913299,-2.656523704528,-2.656523704528,-2.656523704528,-3.32001376152,-3.32001376152,-3.32001376152,-3.32001376152,-3.32001376152,-3.32001376152,-3.31376838684,-3.31376838684,-3.31376838684,-3.31376838684,-3.658066749572,-3.658066749572,-3.658066749572,-3.658066749572,-3.658066749572,-3.64191365242,-3.64191365242,-3.64191365242,-3.64191365242,-4.296687126159,-4.296687126159,-3.634227514266,-3.634227514266,-3.634227514266,-3.634227514266,-3.634227514266,-3.634227514266,-3.634227514266,-3.969321966171,-3.969321966171,-3.969321966171,-3.969321966171,-3.969321966171,-4.30950641632,-3.979271650314,-3.979271650314,-3.979271650314,-3.979271650314,-3.979271650314,-3.979271650314,-4.320357322692,-4.320357322692,-4.320357322692,-4.320357322692,-4.320357322692,-3.999284744262,-3.999284744262,-3.999284744262,-3.999284744262,-3.999284744262,-3.999284744262,-2.994796514511,-2.994796514511,-2.994796514511,-2.994796514511,-2.994796514511,-4.613869667053,-4.613869667053,-4.613869667053,-4.613869667053,-4.287858963012,-4.287858963012,-4.287858963012,-4.287858963012,-4.287858963012,-4.287858963012,-3.960600614547,-3.960600614547,-3.960600614547,-3.960600614547,-4.576577663421,-4.576577663421,-4.576577663421,-4.576577663421,-4.588949203491,-4.588949203491,-4.26492357254,-4.26492357254,-4.26492357254,-4.26492357254,-3.989089727401,-3.989089727401,-3.989089727401,-3.989089727401,-3.332934379577,-3.332934379577,-3.332934379577,-3.332934379577,-3.332934379577,-3.665826797485,-3.665826797485,-3.665826797485,-3.665826797485,-3.665826797485,-3.624619245529,-3.624619245529,-3.624619245529,-3.624619245529,-3.624619245529,-3.624619245529,-3.624619245529,-3.950076341629,-3.950076341629,-3.950076341629,-3.950076341629,-3.950076341629,-2.990456342697,-2.990456342697,-2.990456342697,-2.650290250778,-2.650290250778,-2.650290250778,-2.650290250778,-2.635630607604,-2.635630607604,-2.635630607604,-2.632631301879,-2.632631301879,-2.632631301879,-2.315942525863,-2.315942525863,-3.567823171615,-3.567823171615,-3.567823171615,-3.871732473373,-3.871732473373,-3.871732473373,-3.871732473373,-3.254099845886,-3.254099845886,-3.254099845886,-2.940765380859,-2.940765380859,-2.940765380859,-2.940765380859,-2.641244411468,-2.641244411468,-2.641244411468,-2.641244411468,-2.641244411468,-2.63831782341,-2.63831782341,-2.63831782341,-2.63831782341,-2.63831782341,-2.319375514984,-2.319375514984,-2.319375514984,-3.889560222625,-3.889560222625,-3.889560222625,-3.889560222625,-4.183803558349,-4.183803558349,-4.183803558349,-3.880763769149,-3.880763769149,-3.880763769149,-4.541566848754,-4.541566848754,-4.541566848754,-4.541566848754,-4.518591403961,-4.518591403961,-4.518591403961,-4.518591403961,-2.949070215225,-2.949070215225,-2.949070215225,-2.630559921264,-2.630559921264,-2.630559921264,-2.630559921264,-2.630559921264,-2.630559921264,-2.953486680984,-2.953486680984,-2.953486680984,-2.953486680984,-4.530362606048,-4.530362606048,-4.530362606048,-4.530362606048,-4.213493347167,-4.213493347167,-4.213493347167,-4.213493347167,-3.906823158264,-3.906823158264,-3.906823158264,-3.271595478057,-3.271595478057,-3.271595478057,-3.58874964714,-3.58874964714,-3.58874964714,-4.820355415344,-4.820355415344,-4.820355415344,-4.506742000579,-4.506742000579,-4.506742000579,-4.195411682128,-4.195411682128,-4.195411682128,-4.195411682128,-6.568842887878,-6.568842887878,-6.568842887878,-6.568842887878,-6.568842887878,-6.263568401336,-6.263568401336,-6.263568401336,-6.263568401336,-6.263568401336,-4.20435142517,-4.20435142517,-4.20435142517,-3.897996664047,-3.897996664047,-3.897996664047,-4.222671031951,-4.222671031951,-4.222671031951,-5.119084358215,-5.119084358215,-5.119084358215,-5.119084358215,-4.807657241821,-4.807657241821,-4.807657241821,-4.807657241821,-4.495489120483,-4.495489120483,-4.495489120483,-4.484400749206,-3.276435136795,-3.276435136795,-3.276435136795,-3.596359729766,-3.596359729766,-3.596359729766,-2.95799088478,-2.95799088478,-2.95799088478,-3.915692090988,-3.915692090988,-3.915692090988,-4.565678119659,-4.565678119659,-4.565678119659,-3.924054861068,-3.924058437347,-3.924058437347,-3.924058437347,-3.924058437347,-5.524191379547,-5.524191379547,-5.558206558227,-5.558206558227,-5.558206558227,-5.558206558227,-5.236010074615,-5.236010074615,-5.236010074615,-6.222881793975,-6.222881793975,-6.222881793975,-6.222881793975,-6.222881793975,-5.899488449096,-5.899488449096,-5.899488449096,-5.899488449096,-6.20203590393,-6.20203590393,-6.20203590393,-5.20375585556,-5.20375585556,-5.20375585556,-5.20375585556,-4.91237783432,-4.91237783432,-4.91237783432,-4.91237783432,-4.91237783432,-5.218632221221,-5.218632221221,-5.218632221221,-5.218632221221,-5.218632221221,-3.581304073333,-3.581304073333,-3.581304073333,-3.581304073333,-3.581304073333,-3.581304073333,-3.574215650558,-3.574215650558,-3.574215650558,-3.574215650558,-3.260200977325,-3.260200977325,-3.260200977325,-3.260200977325,-3.260200977325,-3.26545882225,-3.26545882225,-3.26545882225,-3.26545882225,-5.50846338272,-5.50846338272,-5.50846338272,-5.50846338272,-5.490339279174,-5.490339279174,-5.490339279174,-5.175808429718,-5.175808429718,-5.5406665802,-6.283668994903,-6.283668994903,-6.283668994903,-6.144255638122,-6.144255638122,-6.144255638122,-5.844898700714,-5.844898700714,-5.844898700714,-4.244040012359,-4.244040012359,-4.244040012359,-2.943510770797,-2.943510770797,-2.943510770797,-2.943510770797,-3.603838682174,-3.603838682174,-3.603838682174,-4.059737682342,-4.059737682342,-4.059737682342,-4.059737682342,-4.390872955322,-4.390872955322,-4.390872955322,-4.390872955322,-3.717057704925,-3.717057704925,-3.717057704925,-3.717057704925,-3.717057704925,-3.717057704925,-4.553284168243,-4.717710971832,-4.717710971832,-4.717710971832,-4.378815174102,-4.378815174102,-4.378815174102,-4.704676151275,-4.704676151275,-4.704676151275,-5.027016639709,-5.027016639709,-5.027016639709,-5.027016639709,-4.690738677978,-4.690738677978,-4.690738677978,-3.7083902359,-3.7083902359,-3.7083902359,-3.373629331588,-3.373629331588,-3.373629331588,-3.373629331588,-3.366622924804,-3.366622924804,-3.366622924804,-3.366622924804,-5.088250637054,-5.088250637054,-5.088250637054,-5.088250637054,-4.74580335617,-4.74580335617,-4.730178833007,-4.730178833007,-4.367295742034,-4.367295742034,-4.367295742034,-4.367295742034,-4.355820655822,-4.355820655822,-4.355820655822,-4.355820655822,-5.974183559417,-5.974183559417,-5.974183559417,-5.974183559417,-5.974183559417,-6.657007217407,-6.657007217407,-6.657007217407,-6.657007217407,-6.347044467926,-6.347044467926,-6.347044467926,-7.319902896881,-7.319902896881,-7.319902896881,-7.319902896881,-7.293776512145,-7.293776512145,-7.293776512145,-7.293776512145,-5.072641849517,-5.072641849517,-5.072641849517,-5.057489395141,-5.057489395141,-5.057489395141,-5.057489395141,-5.042062759399,-5.042062759399,-5.042062759399,-5.042062759399,-5.042062759399,-4.651647090911,-4.982796669006,-4.982796669006,-4.982796669006,-4.638350009918,-4.638350009918,-4.638350009918,-4.638350009918,-4.638350009918,-4.038576126098,-4.038576126098,-4.038576126098,-4.038576126098,-4.049078941345,-4.049078941345,-4.049078941345,-3.698744773864,-3.698744773864,-3.698744773864,-5.362513542175,-5.362513542175,-5.362513542175,-5.362513542175,-5.345725536346,-5.345725536346,-5.345725536346,-5.345725536346,-5.698215007781,-5.698215007781,-5.698215007781,-5.698215007781,-5.698215007781,-5.62673997879,-5.62673997879,-5.62673997879,-5.250235080718,-5.250235080718,-5.250235080718,-4.926327228546,-4.602252960205,-4.602252960205,-4.602252960205,-5.662526607513,-5.662526607513,-5.662526607513,-5.662526607513,-5.662526607513,-5.662526607513,-5.680094718933,-5.680094718933,-5.680094718933,-5.680094718933,-5.329986095428,-5.329986095428,-5.329986095428,-5.329986095428,-5.329986095428,-6.412073135375,-6.412073135375,-6.412073135375,-6.750539302825,-6.750539302825,-6.750539302825,-7.063253879547,-7.063253879547,-7.063253879547,-6.774658679962,-6.774658679962,-6.774658679962,-6.774658679962,-6.726779460906,-6.726779460906,-6.726779460906,-6.434591293334,-6.434591293334,-6.434591293334,-6.434591293334,-5.608464717864,-5.608464717864,-5.592267990112,-5.592267990112,-5.592267990112,-5.592267990112,-3.387846708297,-3.387846708297,-3.387846708297,-3.387846708297,-3.04639673233,-3.04639673233,-3.04639673233,-1.279906988143,-1.279906988143,-1.283629059791,-1.283629059791,-1.283629059791,-1.275677323341,-1.275677323341,-1.275677323341,-5.314799785614,-5.314799785614,-5.314799785614,-5.314799785614,-5.29743528366,-5.29743528366,-5.29743528366,-5.29743528366,-4.96812915802,-4.96812915802,-4.96812915802,-4.96812915802],10,null,null,{"interactive":true,"className":"","stroke":true,"color":"blue","weight":5,"opacity":1,"fill":true,"fillColor":"blue","fillOpacity":0.2},null,null,null,null,null,{"interactive":false,"permanent":false,"direction":"auto","opacity":1,"offset":[0,0],"textsize":"10px","textOnly":false,"className":"","sticky":true},null]}],"limits":{"lat":[54.729820251464,60.32266998291],"lng":[-7.319902896881,-1.275677323341]}},"evals":[],"jsHooks":[]}</script>
<p class="caption">
Figure 5.2: Interactive map of the sampling locations for the Scottish soils.
</p>
</div>
<p>The XRPD data of the 703 Scottish soils were collected using Cu-Kα radiation <span class="citation">(for details see <a href="#ref-Butler2018" role="doc-biblioref">Butler, O’Rourke, and Hillier 2018</a>)</span> and are included within the <code>scotland_xrpd</code> data, which is a data frame rather than a <code>multiXY</code> object in order to save on file size when transferring to/from GitHub. The <code>scotland_xrpd</code> data frame contains the 2θ axis as the first column, with the subsequent 703 columns representing the count intensities of the diffractograms and column names relating to the <code>SAMPLE_ID</code> column in the <code>scotland_locations</code> data.</p>
<div class="sourceCode" id="cb204"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb204-1"><a href="mars.html#cb204-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Load the Scottish XRPD data</span></span>
<span id="cb204-2"><a href="mars.html#cb204-2" aria-hidden="true" tabindex="-1"></a><span class="fu">data</span>(scotland_xrpd)</span>
<span id="cb204-3"><a href="mars.html#cb204-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb204-4"><a href="mars.html#cb204-4" aria-hidden="true" tabindex="-1"></a><span class="co">#Check the class of the data</span></span>
<span id="cb204-5"><a href="mars.html#cb204-5" aria-hidden="true" tabindex="-1"></a><span class="fu">class</span>(scotland_xrpd)</span></code></pre></div>
<pre><code>## [1] &quot;data.frame&quot;</code></pre>
<div class="sourceCode" id="cb206"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb206-1"><a href="mars.html#cb206-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Summarise the first 5 columns</span></span>
<span id="cb206-2"><a href="mars.html#cb206-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(scotland_xrpd[<span class="dv">1</span><span class="sc">:</span><span class="dv">5</span>])</span></code></pre></div>
<pre><code>##       tth           S891338         S891345         S891346     
##  Min.   : 3.01   Min.   :  470   Min.   :  466   Min.   :  488  
##  1st Qu.:19.76   1st Qu.:  621   1st Qu.:  634   1st Qu.:  636  
##  Median :36.50   Median :  744   Median :  763   Median :  750  
##  Mean   :36.50   Mean   : 1009   Mean   : 1030   Mean   : 1015  
##  3rd Qu.:53.24   3rd Qu.:  914   3rd Qu.:  937   3rd Qu.:  930  
##  Max.   :69.99   Max.   :47279   Max.   :49634   Max.   :48448  
##     S891347     
##  Min.   :  529  
##  1st Qu.:  696  
##  Median :  818  
##  Mean   : 1068  
##  3rd Qu.: 1010  
##  Max.   :44156</code></pre>
<div class="sourceCode" id="cb208"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb208-1"><a href="mars.html#cb208-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Check that the column names match the SAMPLE_ID </span></span>
<span id="cb208-2"><a href="mars.html#cb208-2" aria-hidden="true" tabindex="-1"></a><span class="co">#column in scotland_locations</span></span>
<span id="cb208-3"><a href="mars.html#cb208-3" aria-hidden="true" tabindex="-1"></a><span class="fu">identical</span>(<span class="fu">names</span>(scotland_xrpd[<span class="sc">-</span><span class="dv">1</span>]),</span>
<span id="cb208-4"><a href="mars.html#cb208-4" aria-hidden="true" tabindex="-1"></a>          scotland_locations<span class="sc">$</span>SAMPLE_ID)</span></code></pre></div>
<pre><code>## [1] TRUE</code></pre>
<p>As outlined <a href="intro.html#to-data-frame">here</a>, data frames in this form (i.e. where the first column is 2θ and subsequent columns are count intensities of each sample) can readily be converted to <code>multiXY</code> objects using <code>as_multi_xy()</code>:</p>
<div class="sourceCode" id="cb210"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb210-1"><a href="mars.html#cb210-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Convert scotland_xrpd to a multiXY object</span></span>
<span id="cb210-2"><a href="mars.html#cb210-2" aria-hidden="true" tabindex="-1"></a>scotland_xrpd <span class="ot">&lt;-</span> <span class="fu">as_multi_xy</span>(scotland_xrpd)</span>
<span id="cb210-3"><a href="mars.html#cb210-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb210-4"><a href="mars.html#cb210-4" aria-hidden="true" tabindex="-1"></a><span class="co">#Plot the first 10 diffractograms</span></span>
<span id="cb210-5"><a href="mars.html#cb210-5" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(<span class="fu">as_multi_xy</span>(scotland_xrpd[<span class="dv">1</span><span class="sc">:</span><span class="dv">10</span>]),</span>
<span id="cb210-6"><a href="mars.html#cb210-6" aria-hidden="true" tabindex="-1"></a>     <span class="at">wavelength =</span> <span class="st">&quot;Cu&quot;</span>,</span>
<span id="cb210-7"><a href="mars.html#cb210-7" aria-hidden="true" tabindex="-1"></a>     <span class="at">normalise =</span> <span class="cn">TRUE</span>,</span>
<span id="cb210-8"><a href="mars.html#cb210-8" aria-hidden="true" tabindex="-1"></a>     <span class="at">interactive =</span> <span class="cn">FALSE</span>)</span></code></pre></div>
<div class="figure" style="text-align: center"><span id="fig:unnamed-chunk-118"></span>
<img src="DigiMinR_files/figure-html/unnamed-chunk-118-1.png" alt="The first 10 samples in the scotland_xrpd data." width="100%" />
<p class="caption">
Figure 5.3: The first 10 samples in the scotland_xrpd data.
</p>
</div>
</div>
</div>
<div id="mars-manipulation" class="section level2" number="5.3">
<h2><span class="header-section-number">5.3</span> Data manipulation</h2>
<p align="center">
<iframe width="560" height="315" src="https://www.youtube.com/embed/TzYaRqeNdV8" frameborder="0" allowfullscreen>
</iframe>
</p>
<p>The aim of this analysis is to compare all Martian diffractograms from the MSL to all Scottish soil diffractograms and hence identify those with the greatest similarity. In this case, similarity will be assessed using the Pearson correlation coefficient. Such comparison requires the data to be on identical 2θ axes, which can be achieved by applying the following manipulations to the data:</p>
<ol style="list-style-type: decimal">
<li><a href="intro.html#two-theta-transform">Transform the 2θ scale</a> of the <code>scotland_xrpd</code> data to its Co-Kα equivalent</li>
<li><a href="intro.html#interpolation">Interpolate</a> the data onto a harmonised 2θ scale within the overlapping 2θ range</li>
</ol>
<div id="θ-transformation" class="section level3" number="5.3.1">
<h3><span class="header-section-number">5.3.1</span> 2θ transformation</h3>
<p>As outlined <a href="intro.html#two-theta-transform">here</a>, <code>tth_transform()</code> can be used to transform the 2θ axis of a sample to one that is representative of data recorded using a different wavelength. Here the <code>scotland_xrpd</code> data, which were collected using Cu-Kα radiation, will be transformed to be representative of the Co-Kα radiation that was used on the MSL diffractometer:</p>
<div class="sourceCode" id="cb211"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb211-1"><a href="mars.html#cb211-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Convert Scotland_xrpd back to a dataframe for easy alteration of 2theta</span></span>
<span id="cb211-2"><a href="mars.html#cb211-2" aria-hidden="true" tabindex="-1"></a>scotland_xrpd <span class="ot">&lt;-</span> <span class="fu">multi_xy_to_df</span>(scotland_xrpd, <span class="at">tth =</span> <span class="cn">TRUE</span>)</span>
<span id="cb211-3"><a href="mars.html#cb211-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb211-4"><a href="mars.html#cb211-4" aria-hidden="true" tabindex="-1"></a><span class="co">#Change the 2theta axis</span></span>
<span id="cb211-5"><a href="mars.html#cb211-5" aria-hidden="true" tabindex="-1"></a>scotland_xrpd<span class="sc">$</span>tth <span class="ot">&lt;-</span> <span class="fu">tth_transform</span>(scotland_xrpd<span class="sc">$</span>tth,</span>
<span id="cb211-6"><a href="mars.html#cb211-6" aria-hidden="true" tabindex="-1"></a>                                   <span class="at">from =</span> <span class="fl">1.54056</span>, <span class="co">#Cu-K-alpha wavelength</span></span>
<span id="cb211-7"><a href="mars.html#cb211-7" aria-hidden="true" tabindex="-1"></a>                                   <span class="at">to =</span> <span class="fl">1.78897</span>) <span class="co">#Co-K-alpha wavelength</span></span>
<span id="cb211-8"><a href="mars.html#cb211-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb211-9"><a href="mars.html#cb211-9" aria-hidden="true" tabindex="-1"></a><span class="co">#Convert back to multiXY</span></span>
<span id="cb211-10"><a href="mars.html#cb211-10" aria-hidden="true" tabindex="-1"></a>scotland_xrpd <span class="ot">&lt;-</span> <span class="fu">as_multi_xy</span>(scotland_xrpd)</span>
<span id="cb211-11"><a href="mars.html#cb211-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb211-12"><a href="mars.html#cb211-12" aria-hidden="true" tabindex="-1"></a><span class="co">#Plot some of the transformed Scotland data</span></span>
<span id="cb211-13"><a href="mars.html#cb211-13" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(<span class="fu">as_multi_xy</span>(scotland_xrpd[<span class="dv">1</span><span class="sc">:</span><span class="dv">10</span>]),</span>
<span id="cb211-14"><a href="mars.html#cb211-14" aria-hidden="true" tabindex="-1"></a>     <span class="at">wavelength =</span> <span class="st">&quot;Co&quot;</span>,</span>
<span id="cb211-15"><a href="mars.html#cb211-15" aria-hidden="true" tabindex="-1"></a>     <span class="at">normalise =</span> <span class="cn">TRUE</span>,</span>
<span id="cb211-16"><a href="mars.html#cb211-16" aria-hidden="true" tabindex="-1"></a>     <span class="at">interactive =</span> <span class="cn">FALSE</span>)</span></code></pre></div>
<div class="figure" style="text-align: center"><span id="fig:unnamed-chunk-119"></span>
<img src="DigiMinR_files/figure-html/unnamed-chunk-119-1.png" alt="The first 10 samples in the scotland_xrpd data after 2theta transformation." width="100%" />
<p class="caption">
Figure 5.4: The first 10 samples in the scotland_xrpd data after 2theta transformation.
</p>
</div>
</div>
<div id="θ-interpolation" class="section level3" number="5.3.2">
<h3><span class="header-section-number">5.3.2</span> 2θ interpolation</h3>
<p>Now that the 2θ axis of the <code>scotland_xrpd</code> data is transformed to its Co-Kα equivalent, the overlapping 2θ range of the <code>scotland_xrpd</code> and <code>mars_xrpd</code> data can be computed and used to interpolate all data onto a harmonised 2θ axis:</p>
<div class="sourceCode" id="cb212"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb212-1"><a href="mars.html#cb212-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Extract the minimum and maximum to use in the harmonised 2theta scale</span></span>
<span id="cb212-2"><a href="mars.html#cb212-2" aria-hidden="true" tabindex="-1"></a>tth_min <span class="ot">&lt;-</span> <span class="fu">max</span>(<span class="fu">unlist</span>(<span class="fu">lapply</span>(<span class="fu">c</span>(mars_xrpd, scotland_xrpd), <span class="cf">function</span>(x) <span class="fu">min</span>(x<span class="sc">$</span>tth))))</span>
<span id="cb212-3"><a href="mars.html#cb212-3" aria-hidden="true" tabindex="-1"></a>tth_max <span class="ot">&lt;-</span> <span class="fu">min</span>(<span class="fu">unlist</span>(<span class="fu">lapply</span>(<span class="fu">c</span>(mars_xrpd, scotland_xrpd), <span class="cf">function</span>(x) <span class="fu">max</span>(x<span class="sc">$</span>tth))))</span>
<span id="cb212-4"><a href="mars.html#cb212-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb212-5"><a href="mars.html#cb212-5" aria-hidden="true" tabindex="-1"></a><span class="co">#Create a new 2theta axis to interpolate all data onto</span></span>
<span id="cb212-6"><a href="mars.html#cb212-6" aria-hidden="true" tabindex="-1"></a><span class="co">#using the 0.05 resolution of the MSL data</span></span>
<span id="cb212-7"><a href="mars.html#cb212-7" aria-hidden="true" tabindex="-1"></a>new_tth <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="fu">round</span>(tth_min, <span class="dv">2</span>), <span class="fu">round</span>(tth_max, <span class="dv">2</span>), <span class="fl">0.05</span>)</span>
<span id="cb212-8"><a href="mars.html#cb212-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb212-9"><a href="mars.html#cb212-9" aria-hidden="true" tabindex="-1"></a><span class="co">#Interpolate the data</span></span>
<span id="cb212-10"><a href="mars.html#cb212-10" aria-hidden="true" tabindex="-1"></a>mars_xrpd <span class="ot">&lt;-</span> <span class="fu">interpolate</span>(mars_xrpd, new_tth)</span>
<span id="cb212-11"><a href="mars.html#cb212-11" aria-hidden="true" tabindex="-1"></a>scotland_xrpd <span class="ot">&lt;-</span> <span class="fu">interpolate</span>(scotland_xrpd, new_tth)</span>
<span id="cb212-12"><a href="mars.html#cb212-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb212-13"><a href="mars.html#cb212-13" aria-hidden="true" tabindex="-1"></a><span class="co">#Plot some of the transformed and interpolated data</span></span>
<span id="cb212-14"><a href="mars.html#cb212-14" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(<span class="fu">as_multi_xy</span>(scotland_xrpd[<span class="dv">1</span><span class="sc">:</span><span class="dv">10</span>]),</span>
<span id="cb212-15"><a href="mars.html#cb212-15" aria-hidden="true" tabindex="-1"></a>     <span class="at">wavelength =</span> <span class="st">&quot;Co&quot;</span>,</span>
<span id="cb212-16"><a href="mars.html#cb212-16" aria-hidden="true" tabindex="-1"></a>     <span class="at">normalise =</span> <span class="cn">TRUE</span>,</span>
<span id="cb212-17"><a href="mars.html#cb212-17" aria-hidden="true" tabindex="-1"></a>     <span class="at">interactive =</span> <span class="cn">FALSE</span>)</span></code></pre></div>
<div class="figure" style="text-align: center"><span id="fig:unnamed-chunk-121"></span>
<img src="DigiMinR_files/figure-html/unnamed-chunk-121-1.png" alt="The first 10 samples in the scotland_xrpd data following 2theta transformation and interpolation." width="100%" />
<p class="caption">
Figure 5.5: The first 10 samples in the scotland_xrpd data following 2theta transformation and interpolation.
</p>
</div>
</div>
</div>
<div id="comparison-of-xrpd-data" class="section level2" number="5.4">
<h2><span class="header-section-number">5.4</span> Comparison of XRPD data</h2>
<p align="center">
<iframe width="560" height="315" src="https://www.youtube.com/embed/XrFaQA71z8Y" frameborder="0" allowfullscreen>
</iframe>
</p>
<p>Now that the data are harmonised and therefore comparable, the final step is to correlate each MSL diffractogram to every Scottish diffractogram and derive the Pearson correlation coefficients. This comparison should therefore yield 31 vectors each consisting of 703 correlation coefficients (thus 21,793 comparisons in total). In order to further enhance the derived correlation coefficients where similarities are detectable, each pairwise comparison will involve alignment of the 2 samples to one-another in order to correct for <a href="intro.html#alignment">common experimental aberrations</a> that can affect peak positions on the 2θ axis. To facilitate this a function will be created that accept the following 3 arguments</p>
<ol style="list-style-type: decimal">
<li><code>mars</code> will be an <a href="intro.html#loading-data"><code>XY</code> object</a> of an MSL diffractogram.</li>
<li><code>scotland</code> will be an <code>XY</code> object of a Scottish soil diffractogram.</li>
<li><code>align</code> will define the maximum 2θ shift (either positive or negative) that can be applied.</li>
</ol>
<p>The function will firstly align the two diffractograms to one-another before deriving the Pearson correlation coefficient:</p>
<div class="sourceCode" id="cb213"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb213-1"><a href="mars.html#cb213-1" aria-hidden="true" tabindex="-1"></a>compare_xrpd <span class="ot">&lt;-</span> <span class="cf">function</span>(mars, scotland, align) {</span>
<span id="cb213-2"><a href="mars.html#cb213-2" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb213-3"><a href="mars.html#cb213-3" aria-hidden="true" tabindex="-1"></a>  <span class="co">#Align the two samples to one another using the multiXY method</span></span>
<span id="cb213-4"><a href="mars.html#cb213-4" aria-hidden="true" tabindex="-1"></a>  <span class="co">#of the align_xy function</span></span>
<span id="cb213-5"><a href="mars.html#cb213-5" aria-hidden="true" tabindex="-1"></a>  x <span class="ot">&lt;-</span> <span class="fu">align_xy</span>(<span class="fu">as_multi_xy</span>(<span class="fu">list</span>(<span class="st">&quot;mars&quot;</span> <span class="ot">=</span> mars,</span>
<span id="cb213-6"><a href="mars.html#cb213-6" aria-hidden="true" tabindex="-1"></a>                                 <span class="st">&quot;scotland&quot;</span> <span class="ot">=</span> scotland)),</span>
<span id="cb213-7"><a href="mars.html#cb213-7" aria-hidden="true" tabindex="-1"></a>                <span class="at">std =</span> mars,</span>
<span id="cb213-8"><a href="mars.html#cb213-8" aria-hidden="true" tabindex="-1"></a>                <span class="at">xshift =</span> align,</span>
<span id="cb213-9"><a href="mars.html#cb213-9" aria-hidden="true" tabindex="-1"></a>                <span class="at">xmin =</span> <span class="fu">min</span>(mars[[<span class="dv">1</span>]]),</span>
<span id="cb213-10"><a href="mars.html#cb213-10" aria-hidden="true" tabindex="-1"></a>                <span class="at">xmax =</span> <span class="fu">max</span>(mars[[<span class="dv">1</span>]]))</span>
<span id="cb213-11"><a href="mars.html#cb213-11" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb213-12"><a href="mars.html#cb213-12" aria-hidden="true" tabindex="-1"></a>  <span class="co">#Correlate the count intensities to one-another</span></span>
<span id="cb213-13"><a href="mars.html#cb213-13" aria-hidden="true" tabindex="-1"></a>  pearson <span class="ot">&lt;-</span> <span class="fu">cor</span>(x<span class="sc">$</span>mars[[<span class="dv">2</span>]], x<span class="sc">$</span>scotland[[<span class="dv">2</span>]])</span>
<span id="cb213-14"><a href="mars.html#cb213-14" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb213-15"><a href="mars.html#cb213-15" aria-hidden="true" tabindex="-1"></a>  <span class="co">#return the pearson correlation coefficient</span></span>
<span id="cb213-16"><a href="mars.html#cb213-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(pearson)</span>
<span id="cb213-17"><a href="mars.html#cb213-17" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb213-18"><a href="mars.html#cb213-18" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<p>Now that we have created the <code>compare_xrpd()</code> function it will be applied across each of the diffractograms in <code>scotland_xrpd</code> using <code>sapply()</code>. For example, if we wanted to compare every diffractogram in <code>scotland_xrpd</code> to <code>mars_xrpd$Cumberland</code> we could use:</p>
<div class="sourceCode" id="cb214"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb214-1"><a href="mars.html#cb214-1" aria-hidden="true" tabindex="-1"></a>cumberland_to_scotland <span class="ot">&lt;-</span> <span class="fu">sapply</span>(scotland_xrpd,</span>
<span id="cb214-2"><a href="mars.html#cb214-2" aria-hidden="true" tabindex="-1"></a>                                 compare_xrpd,</span>
<span id="cb214-3"><a href="mars.html#cb214-3" aria-hidden="true" tabindex="-1"></a>                                 <span class="at">mars =</span> mars_xrpd<span class="sc">$</span>Cumberland,</span>
<span id="cb214-4"><a href="mars.html#cb214-4" aria-hidden="true" tabindex="-1"></a>                                 <span class="at">align =</span> <span class="fl">0.3</span></span>
<span id="cb214-5"><a href="mars.html#cb214-5" aria-hidden="true" tabindex="-1"></a>                                 )</span></code></pre></div>
<p>Which yields a named vector of 703 correlation coefficients comparing <code>mars_xrpd$Cumberland</code> to every sample within the <code>scotland_xrpd</code> data, with each item within the vector being named according to the sample ID from <code>scotland_xrpd</code>.</p>
<div class="sourceCode" id="cb215"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb215-1"><a href="mars.html#cb215-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Show the first six values of the names vector</span></span>
<span id="cb215-2"><a href="mars.html#cb215-2" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(cumberland_to_scotland)</span></code></pre></div>
<pre><code>##    S891338    S891345    S891346    S891347    S891355    S891356 
## 0.07680372 0.07571390 0.07945924 0.08710548 0.17750332 0.17151330</code></pre>
<p>To derive the correlation coefficients for <em>all 31 samples</em> within the <code>mars_xrpd</code> data instead of just <code>mars$Cumberland</code>, a <code>for</code> loop will be used:</p>
<div class="sourceCode" id="cb217"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb217-1"><a href="mars.html#cb217-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Create a blank list to populate</span></span>
<span id="cb217-2"><a href="mars.html#cb217-2" aria-hidden="true" tabindex="-1"></a>mars_to_scotland <span class="ot">&lt;-</span> <span class="fu">list</span>()</span>
<span id="cb217-3"><a href="mars.html#cb217-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb217-4"><a href="mars.html#cb217-4" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(mars_xrpd)) {</span>
<span id="cb217-5"><a href="mars.html#cb217-5" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb217-6"><a href="mars.html#cb217-6" aria-hidden="true" tabindex="-1"></a>  <span class="co">#Use sapply again to derive the named vector of coefficients</span></span>
<span id="cb217-7"><a href="mars.html#cb217-7" aria-hidden="true" tabindex="-1"></a>  mars_to_scotland[[i]] <span class="ot">&lt;-</span> <span class="fu">sapply</span>(scotland_xrpd,</span>
<span id="cb217-8"><a href="mars.html#cb217-8" aria-hidden="true" tabindex="-1"></a>                                  compare_xrpd,</span>
<span id="cb217-9"><a href="mars.html#cb217-9" aria-hidden="true" tabindex="-1"></a>                                  <span class="at">mars =</span> mars_xrpd[[i]],</span>
<span id="cb217-10"><a href="mars.html#cb217-10" aria-hidden="true" tabindex="-1"></a>                                  <span class="at">align =</span> <span class="fl">0.3</span></span>
<span id="cb217-11"><a href="mars.html#cb217-11" aria-hidden="true" tabindex="-1"></a>                                  )</span>
<span id="cb217-12"><a href="mars.html#cb217-12" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb217-13"><a href="mars.html#cb217-13" aria-hidden="true" tabindex="-1"></a>  <span class="co">#name the list item</span></span>
<span id="cb217-14"><a href="mars.html#cb217-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">names</span>(mars_to_scotland)[i] <span class="ot">&lt;-</span> <span class="fu">names</span>(mars_xrpd)[i]</span>
<span id="cb217-15"><a href="mars.html#cb217-15" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb217-16"><a href="mars.html#cb217-16" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<p>Which yields a list of 31 named vectors that each take the same form of <code>cumberland_to_scotland</code>. Each item within the list is named according to the MSL site name and consists of 703 numeric correlation coefficients:</p>
<div class="sourceCode" id="cb218"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb218-1"><a href="mars.html#cb218-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(mars_to_scotland)</span></code></pre></div>
<pre><code>##                  Length Class  Mode   
## Rocknest_4       703    -none- numeric
## Rocknest_5       703    -none- numeric
## Cumberland       703    -none- numeric
## John_Klein       703    -none- numeric
## Windjana         703    -none- numeric
## Confidence_Hills 703    -none- numeric
## Mojave2          703    -none- numeric
## Telegraph_Peak   703    -none- numeric
## Buckskin         703    -none- numeric
## Big_Sky          703    -none- numeric
## Greenhorn        703    -none- numeric
## Gobabeb_Dune     703    -none- numeric
## Lubango          703    -none- numeric
## Okoruso          703    -none- numeric
## Oudam            703    -none- numeric
## Marimba2         703    -none- numeric
## Quela            703    -none- numeric
## Sebina           703    -none- numeric
## Ogunquit_Beach   703    -none- numeric
## Duluth           703    -none- numeric
## Stoer            703    -none- numeric
## Aberlady         703    -none- numeric
## Kilmarie         703    -none- numeric
## Glen_Etive_1     703    -none- numeric
## Glen_Etive_2     703    -none- numeric
## Hutton           703    -none- numeric
## Edinburgh        703    -none- numeric
## Glasgow          703    -none- numeric
## Mary_Anning_1    703    -none- numeric
## Mary_Anning_3    703    -none- numeric
## Groken           703    -none- numeric</code></pre>
<p>By unlisting the <code>mars_to_scotland</code> data using <code>unlist()</code>, we end up with a very long vector consisting of 21,793 correlation coefficients, with each coefficient having a unique name that takes the form <code>MarsSite.ScotlandID</code>.</p>
<div class="sourceCode" id="cb220"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb220-1"><a href="mars.html#cb220-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Create a vector from the mars_to_scotland list</span></span>
<span id="cb220-2"><a href="mars.html#cb220-2" aria-hidden="true" tabindex="-1"></a>mars_to_scotland_v <span class="ot">&lt;-</span> <span class="fu">unlist</span>(mars_to_scotland)</span>
<span id="cb220-3"><a href="mars.html#cb220-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb220-4"><a href="mars.html#cb220-4" aria-hidden="true" tabindex="-1"></a><span class="co">#Check the first correlation coefficient</span></span>
<span id="cb220-5"><a href="mars.html#cb220-5" aria-hidden="true" tabindex="-1"></a>mars_to_scotland_v[<span class="dv">1</span>]</span></code></pre></div>
<pre><code>## Rocknest_4.S891338 
##          0.1205851</code></pre>
<p>with the name <code>{r names(mars_to_scotland_v[1])}</code> detailing that the <code>mars_xrpd$Rocknest_4</code> and <code>scotland_xrpd$S891338</code> samples were used to derive this correlation coefficient. It’s possible to plot the aligned data associated with these samples using:</p>
<div class="sourceCode" id="cb222"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb222-1"><a href="mars.html#cb222-1" aria-hidden="true" tabindex="-1"></a>comparison <span class="ot">&lt;-</span> <span class="fu">align_xy</span>(<span class="fu">as_multi_xy</span>(<span class="fu">list</span>(<span class="st">&quot;Mars_Rocknest_4&quot;</span> <span class="ot">=</span> mars_xrpd<span class="sc">$</span>Rocknest_4,</span>
<span id="cb222-2"><a href="mars.html#cb222-2" aria-hidden="true" tabindex="-1"></a>                                        <span class="st">&quot;Scotland_S891338&quot;</span> <span class="ot">=</span> scotland_xrpd<span class="sc">$</span>S891338)),</span>
<span id="cb222-3"><a href="mars.html#cb222-3" aria-hidden="true" tabindex="-1"></a>                       <span class="at">std =</span> mars_xrpd<span class="sc">$</span>Rocknest_4,</span>
<span id="cb222-4"><a href="mars.html#cb222-4" aria-hidden="true" tabindex="-1"></a>                       <span class="at">xshift =</span> <span class="fl">0.3</span>,</span>
<span id="cb222-5"><a href="mars.html#cb222-5" aria-hidden="true" tabindex="-1"></a>                       <span class="at">xmin =</span> <span class="fl">4.52</span>,</span>
<span id="cb222-6"><a href="mars.html#cb222-6" aria-hidden="true" tabindex="-1"></a>                       <span class="at">xmax =</span> <span class="fl">51.92</span>)</span>
<span id="cb222-7"><a href="mars.html#cb222-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb222-8"><a href="mars.html#cb222-8" aria-hidden="true" tabindex="-1"></a><span class="co">#Plot the data</span></span>
<span id="cb222-9"><a href="mars.html#cb222-9" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(comparison,</span>
<span id="cb222-10"><a href="mars.html#cb222-10" aria-hidden="true" tabindex="-1"></a>     <span class="at">wavelength =</span> <span class="st">&quot;Co&quot;</span>,</span>
<span id="cb222-11"><a href="mars.html#cb222-11" aria-hidden="true" tabindex="-1"></a>     <span class="at">normalise =</span> <span class="cn">TRUE</span>,</span>
<span id="cb222-12"><a href="mars.html#cb222-12" aria-hidden="true" tabindex="-1"></a>     <span class="at">interactive =</span> <span class="cn">FALSE</span>)</span></code></pre></div>
<div class="figure" style="text-align: center"><span id="fig:unnamed-chunk-128"></span>
<img src="DigiMinR_files/figure-html/unnamed-chunk-128-1.png" alt="Sample Rocknest_4 and S891338 aligned and plotted against one-another." width="100%" />
<p class="caption">
Figure 5.6: Sample Rocknest_4 and S891338 aligned and plotted against one-another.
</p>
</div>
<p>From this comparison it’s clear to see that these diffractograms are highly dissimilar, which is reflected in their relatively low correlation coefficient of 0.12. However, this is just the first correlation coefficient of ~22,000 that need to be explored, and now that all of the correlation coefficients are in a vector they can easily be summarised and visualised:</p>
<div class="sourceCode" id="cb223"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb223-1"><a href="mars.html#cb223-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Summarise the correlation coefficients</span></span>
<span id="cb223-2"><a href="mars.html#cb223-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(mars_to_scotland_v)</span></code></pre></div>
<pre><code>##    Min. 1st Qu.  Median    Mean 3rd Qu.    Max. 
## -0.2253  0.1125  0.1681  0.1752  0.2245  0.8091</code></pre>
<div class="sourceCode" id="cb225"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb225-1"><a href="mars.html#cb225-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Produce a histogram of the correlation coefficients</span></span>
<span id="cb225-2"><a href="mars.html#cb225-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> <span class="fu">data.frame</span>(<span class="st">&quot;pearson&quot;</span> <span class="ot">=</span> mars_to_scotland_v),</span>
<span id="cb225-3"><a href="mars.html#cb225-3" aria-hidden="true" tabindex="-1"></a>       <span class="fu">aes</span>(<span class="at">x =</span> pearson)) <span class="sc">+</span></span>
<span id="cb225-4"><a href="mars.html#cb225-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_histogram</span>(<span class="at">bins =</span> <span class="dv">100</span>, <span class="at">colour =</span> <span class="st">&quot;black&quot;</span>, <span class="at">fill =</span> <span class="st">&quot;white&quot;</span>) <span class="sc">+</span></span>
<span id="cb225-5"><a href="mars.html#cb225-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">&quot;Pearson correlation coefficient&quot;</span>) <span class="sc">+</span></span>
<span id="cb225-6"><a href="mars.html#cb225-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">&quot;Count&quot;</span>)</span></code></pre></div>
<div class="figure" style="text-align: center"><span id="fig:unnamed-chunk-129"></span>
<img src="DigiMinR_files/figure-html/unnamed-chunk-129-1.png" alt="Histogram of all 21,793 correlation coefficients" width="100%" />
<p class="caption">
Figure 5.7: Histogram of all 21,793 correlation coefficients
</p>
</div>
<p>The summary of the data outlines how the correlation coefficients range from -0.2 to 0.8, with an average of ~0.2. The histogram displays an approximately normal distribution of correlation coefficients, but shows a small tail of values &gt;0.75, that can be further explored:</p>
<div class="sourceCode" id="cb226"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb226-1"><a href="mars.html#cb226-1" aria-hidden="true" tabindex="-1"></a>high_cors <span class="ot">&lt;-</span> mars_to_scotland_v[mars_to_scotland_v <span class="sc">&gt;=</span> <span class="fl">0.75</span>]</span>
<span id="cb226-2"><a href="mars.html#cb226-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb226-3"><a href="mars.html#cb226-3" aria-hidden="true" tabindex="-1"></a><span class="co">#Check the results</span></span>
<span id="cb226-4"><a href="mars.html#cb226-4" aria-hidden="true" tabindex="-1"></a>high_cors</span></code></pre></div>
<pre><code>##    Cumberland.S926673    Cumberland.S926674    Cumberland.S968694 
##             0.7687338             0.8091307             0.7665140 
##    John_Klein.S926674       Lubango.S926500      Marimba2.S926499 
##             0.7810010             0.7567831             0.7533330 
##      Marimba2.S968695         Quela.S968695        Sebina.S968695 
##             0.8021795             0.7801234             0.7863120 
##        Duluth.S926674      Aberlady.S926676      Aberlady.S968695 
##             0.7522924             0.7530857             0.7752545 
##  Glen_Etive_2.S926674  Glen_Etive_2.S968694  Glen_Etive_2.S968695 
##             0.7610764             0.7585035             0.7974164 
##       Glasgow.S968695 Mary_Anning_1.S926674 Mary_Anning_1.S968695 
##             0.7790987             0.7597717             0.7635760 
## Mary_Anning_3.S926674 
##             0.7587199</code></pre>
<div class="sourceCode" id="cb228"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb228-1"><a href="mars.html#cb228-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Extract the Mars site names from the high_cors vector</span></span>
<span id="cb228-2"><a href="mars.html#cb228-2" aria-hidden="true" tabindex="-1"></a>high_cors_mars <span class="ot">&lt;-</span> <span class="fu">sub</span>(<span class="st">&quot;</span><span class="sc">\\</span><span class="st">..*&quot;</span>, <span class="st">&quot;&quot;</span>, <span class="fu">names</span>(high_cors))</span>
<span id="cb228-3"><a href="mars.html#cb228-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb228-4"><a href="mars.html#cb228-4" aria-hidden="true" tabindex="-1"></a><span class="co">#Show the sites</span></span>
<span id="cb228-5"><a href="mars.html#cb228-5" aria-hidden="true" tabindex="-1"></a><span class="fu">unique</span>(high_cors_mars)</span></code></pre></div>
<pre><code>##  [1] &quot;Cumberland&quot;    &quot;John_Klein&quot;    &quot;Lubango&quot;       &quot;Marimba2&quot;     
##  [5] &quot;Quela&quot;         &quot;Sebina&quot;        &quot;Duluth&quot;        &quot;Aberlady&quot;     
##  [9] &quot;Glen_Etive_2&quot;  &quot;Glasgow&quot;       &quot;Mary_Anning_1&quot; &quot;Mary_Anning_3&quot;</code></pre>
<div class="sourceCode" id="cb230"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb230-1"><a href="mars.html#cb230-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Extract the Scotland sample IDs from the high cors vector</span></span>
<span id="cb230-2"><a href="mars.html#cb230-2" aria-hidden="true" tabindex="-1"></a>high_cors_scotland <span class="ot">&lt;-</span> <span class="fu">sub</span>(<span class="st">&#39;.*</span><span class="sc">\\</span><span class="st">.&#39;</span>, <span class="st">&#39;&#39;</span>, <span class="fu">names</span>(high_cors))</span>
<span id="cb230-3"><a href="mars.html#cb230-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb230-4"><a href="mars.html#cb230-4" aria-hidden="true" tabindex="-1"></a><span class="co">#Show the samples</span></span>
<span id="cb230-5"><a href="mars.html#cb230-5" aria-hidden="true" tabindex="-1"></a><span class="fu">unique</span>(high_cors_scotland)</span></code></pre></div>
<pre><code>## [1] &quot;S926673&quot; &quot;S926674&quot; &quot;S968694&quot; &quot;S926500&quot; &quot;S926499&quot; &quot;S968695&quot; &quot;S926676&quot;</code></pre>
<p>It’s also possible to plot the samples for each of the sites where high correlations are found. Here we’ll plot the site that displays the highest correlation to samples within the <code>scotland_xrpd</code> dataset:</p>
<div class="sourceCode" id="cb232"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb232-1"><a href="mars.html#cb232-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Extract the name of the site with the highest correlation coefficients</span></span>
<span id="cb232-2"><a href="mars.html#cb232-2" aria-hidden="true" tabindex="-1"></a>highest_cor <span class="ot">&lt;-</span> <span class="fu">sub</span>(<span class="st">&quot;</span><span class="sc">\\</span><span class="st">..*&quot;</span>, <span class="st">&quot;&quot;</span>, <span class="fu">names</span>(high_cors)[<span class="fu">which.max</span>(high_cors)])</span>
<span id="cb232-3"><a href="mars.html#cb232-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb232-4"><a href="mars.html#cb232-4" aria-hidden="true" tabindex="-1"></a><span class="co">#print it</span></span>
<span id="cb232-5"><a href="mars.html#cb232-5" aria-hidden="true" tabindex="-1"></a>highest_cor</span></code></pre></div>
<pre><code>## [1] &quot;Cumberland&quot;</code></pre>
<div class="sourceCode" id="cb234"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb234-1"><a href="mars.html#cb234-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Extract the IDs of samples that correlate strongly with Cumberland</span></span>
<span id="cb234-2"><a href="mars.html#cb234-2" aria-hidden="true" tabindex="-1"></a>scotland_ids <span class="ot">&lt;-</span> <span class="fu">sub</span>(<span class="st">&#39;.*</span><span class="sc">\\</span><span class="st">.&#39;</span>, <span class="st">&#39;&#39;</span>, <span class="fu">names</span>(high_cors)[<span class="fu">grep</span>(highest_cor, <span class="fu">names</span>(high_cors))])</span>
<span id="cb234-3"><a href="mars.html#cb234-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb234-4"><a href="mars.html#cb234-4" aria-hidden="true" tabindex="-1"></a><span class="co">#print them</span></span>
<span id="cb234-5"><a href="mars.html#cb234-5" aria-hidden="true" tabindex="-1"></a>scotland_ids</span></code></pre></div>
<pre><code>## [1] &quot;S926673&quot; &quot;S926674&quot; &quot;S968694&quot;</code></pre>
<div class="sourceCode" id="cb236"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb236-1"><a href="mars.html#cb236-1" aria-hidden="true" tabindex="-1"></a>mars_highest_cor <span class="ot">&lt;-</span> <span class="fu">as_multi_xy</span>(<span class="fu">c</span>(mars_xrpd[highest_cor],</span>
<span id="cb236-2"><a href="mars.html#cb236-2" aria-hidden="true" tabindex="-1"></a>                                  scotland_xrpd[scotland_ids]))</span>
<span id="cb236-3"><a href="mars.html#cb236-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb236-4"><a href="mars.html#cb236-4" aria-hidden="true" tabindex="-1"></a><span class="co">#align data</span></span>
<span id="cb236-5"><a href="mars.html#cb236-5" aria-hidden="true" tabindex="-1"></a>mars_highest_cor <span class="ot">&lt;-</span> <span class="fu">align_xy</span>(mars_highest_cor,</span>
<span id="cb236-6"><a href="mars.html#cb236-6" aria-hidden="true" tabindex="-1"></a>                             <span class="at">std =</span> mars_highest_cor[[<span class="dv">1</span>]],</span>
<span id="cb236-7"><a href="mars.html#cb236-7" aria-hidden="true" tabindex="-1"></a>                             <span class="at">xshift =</span> <span class="fl">0.3</span>,</span>
<span id="cb236-8"><a href="mars.html#cb236-8" aria-hidden="true" tabindex="-1"></a>                             <span class="at">xmin =</span> <span class="fl">4.52</span>,</span>
<span id="cb236-9"><a href="mars.html#cb236-9" aria-hidden="true" tabindex="-1"></a>                             <span class="at">xmax =</span> <span class="fl">51.92</span>)</span>
<span id="cb236-10"><a href="mars.html#cb236-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb236-11"><a href="mars.html#cb236-11" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(mars_highest_cor,</span>
<span id="cb236-12"><a href="mars.html#cb236-12" aria-hidden="true" tabindex="-1"></a>     <span class="at">wavelength =</span> <span class="st">&quot;Co&quot;</span>,</span>
<span id="cb236-13"><a href="mars.html#cb236-13" aria-hidden="true" tabindex="-1"></a>     <span class="at">normalise =</span> <span class="cn">TRUE</span>,</span>
<span id="cb236-14"><a href="mars.html#cb236-14" aria-hidden="true" tabindex="-1"></a>     <span class="at">interactive =</span> <span class="cn">FALSE</span>)</span></code></pre></div>
<div class="figure" style="text-align: center"><span id="fig:unnamed-chunk-131"></span>
<img src="DigiMinR_files/figure-html/unnamed-chunk-131-1.png" alt="Diffractogram from the Cumberland site plotted against 3 diffractograms from Scotland identified as having relatively high correlation to the Martian data." width="100%" />
<p class="caption">
Figure 5.8: Diffractogram from the Cumberland site plotted against 3 diffractograms from Scotland identified as having relatively high correlation to the Martian data.
</p>
</div>
<p>From this plot (which is best plotted using <code>interactive = TRUE</code> in the function call) we can see how three samples from the <code>scotland_xrpd</code> data show notable similarity to the data from the Cumberland site in the MSL data. Of particular note is the very similar basal plane d-spacing of the predominant clay mineral within the samples, suggesting that perhaps similar clay minerals are observed in the samples from Mars and Scotland.</p>
<p>Further exploration of Scottish samples identified as having similar diffraction patterns to the Cumberland MSL sample can be achieved by exploring the data spatially and by understanding more about the parent material that Scottish soils developed from:</p>
<div class="sourceCode" id="cb237"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb237-1"><a href="mars.html#cb237-1" aria-hidden="true" tabindex="-1"></a><span class="fu">leaflet</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb237-2"><a href="mars.html#cb237-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">addTiles</span>() <span class="sc">%&gt;%</span></span>
<span id="cb237-3"><a href="mars.html#cb237-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">addCircleMarkers</span>(<span class="at">data =</span> scotland_locations[scotland_locations<span class="sc">$</span>SAMPLE_ID <span class="sc">%in%</span> scotland_ids,],</span>
<span id="cb237-4"><a href="mars.html#cb237-4" aria-hidden="true" tabindex="-1"></a>                   <span class="sc">~</span>PROFILE_LONGITUDE, <span class="sc">~</span>PROFILE_LATITUDE,</span>
<span id="cb237-5"><a href="mars.html#cb237-5" aria-hidden="true" tabindex="-1"></a>                   <span class="at">color =</span> <span class="st">&quot;blue&quot;</span>,</span>
<span id="cb237-6"><a href="mars.html#cb237-6" aria-hidden="true" tabindex="-1"></a>                   <span class="at">opacity =</span> <span class="dv">1</span>)</span></code></pre></div>
<div class="figure" style="text-align: center"><span id="fig:unnamed-chunk-132"></span>
<div id="htmlwidget-6338c15c1dba1c7ada1d" style="width:80%;height:480px;" class="leaflet html-widget"></div>
<script type="application/json" data-for="htmlwidget-6338c15c1dba1c7ada1d">{"x":{"options":{"crs":{"crsClass":"L.CRS.EPSG3857","code":null,"proj4def":null,"projectedBounds":null,"options":{}}},"calls":[{"method":"addTiles","args":["//{s}.tile.openstreetmap.org/{z}/{x}/{y}.png",null,null,{"minZoom":0,"maxZoom":18,"tileSize":256,"subdomains":"abc","errorTileUrl":"","tms":false,"noWrap":false,"zoomOffset":0,"zoomReverse":false,"opacity":1,"zIndex":1,"detectRetina":false,"attribution":"&copy; <a href=\"http://openstreetmap.org\">OpenStreetMap<\/a> contributors, <a href=\"http://creativecommons.org/licenses/by-sa/2.0/\">CC-BY-SA<\/a>"}]},{"method":"addCircleMarkers","args":[[56.480365753173,56.480365753173,57.555801391601],[-6.222881793975,-6.222881793975,-6.347044467926],10,null,null,{"interactive":true,"className":"","stroke":true,"color":"blue","weight":5,"opacity":1,"fill":true,"fillColor":"blue","fillOpacity":0.2},null,null,null,null,null,{"interactive":false,"permanent":false,"direction":"auto","opacity":1,"offset":[0,0],"textsize":"10px","textOnly":false,"className":"","sticky":true},null]}],"limits":{"lat":[56.480365753173,57.555801391601],"lng":[-6.347044467926,-6.222881793975]}},"evals":[],"jsHooks":[]}</script>
<p class="caption">
Figure 5.9: Interactive map of the locations of the Scottish soils that display the highest correlation to samples from the Cumberland MSL site.
</p>
</div>
<p>Plotting the data spatially reveals that the samples are from two sites that are both located on the West Coast of Scotland. More specifically the sites are on the Isle of Ulva, near the Isle of Mull, and the Trotternish Peninsula on the Isle of Skye. Both of these locations display soils developed from a basaltic parent material in combination with a relatively wet climate that has resulted in the weathering of this material to various clay minerals, which may be useful analogues for Martian clay mineralogy.</p>
<p>In summary, manipulation of XRPD data and data-driven comparisons allows for inter-planetary comparisons of soil samples collected on Earth and Mars. Application of such approaches may serve as a useful way of identifying sites that can be further studies as geological or mineralogy analogues for Mars in order to undertake more detailed analyses that are beyond the capabilities of rover missions.</p>

</div>
</div>
<h3>References</h3>
<div id="refs" class="references csl-bib-body hanging-indent">
<div id="ref-Bish2013" class="csl-entry">
Bish, David L, DF Blake, DT Vaniman, SJ Chipera, RV Morris, DW Ming, AH Treiman, et al. 2013. <span>“<span class="nocase">X-ray diffraction results from Mars Science Laboratory: Mineralogy of Rocknest at Gale crater</span>.”</span> <em>Science</em> 341 (6153). <a href="https://doi.org/10.1126/science.1238932">https://doi.org/10.1126/science.1238932</a>.
</div>
<div id="ref-Bristow2015" class="csl-entry">
Bristow, Thomas F, David L Bish, David T Vaniman, Richard V Morris, David F Blake, John P Grotzinger, Elizabeth B Rampe, et al. 2015. <span>“<span class="nocase">The origin and implications of clay minerals from Yellowknife Bay, Gale crater, Mars</span>.”</span> <em>American Mineralogist</em> 100 (4): 824–36. <a href="https://doi.org/10.2138/am-2015-5077CCBYNCND">https://doi.org/10.2138/am-2015-5077CCBYNCND</a>.
</div>
<div id="ref-Bristow2018" class="csl-entry">
Bristow, Thomas F, Elizabeth B Rampe, Cherie N Achilles, David F Blake, Steve J Chipera, Patricia Craig, Joy A Crisp, et al. 2018. <span>“<span class="nocase">Clay mineral diversity and abundance in sedimentary rocks of Gale crater, Mars</span>.”</span> <em>Science Advances</em> 4 (6): eaar3330. <a href="https://doi.org/10.1126/sciadv.aar3330">https://doi.org/10.1126/sciadv.aar3330</a>.
</div>
<div id="ref-Butler2018" class="csl-entry">
Butler, Benjamin M, Sharon M O’Rourke, and Stephen Hillier. 2018. <span>“<span class="nocase">Using rule-based regression models to predict and interpret soil properties from X-ray powder diffraction data</span>.”</span> <em>Geoderma</em> 329: 43–53. <a href="https://doi.org/10.1016/j.geoderma.2018.04.005">https://doi.org/10.1016/j.geoderma.2018.04.005</a>.
</div>
<div id="ref-Grotzinger2014" class="csl-entry">
Grotzinger, John P, Do Y Sumner, LC Kah, K Stack, S Gupta, L Edgar, D Rubin, et al. 2014. <span>“<span class="nocase">A habitable fluvio-lacustrine environment at Yellowknife Bay, Gale Crater, Mars</span>.”</span> <em>Science</em> 343 (6169). <a href="https://doi.org/10.1126/science.1242777">https://doi.org/10.1126/science.1242777</a>.
</div>
<div id="ref-Marlow2008" class="csl-entry">
Marlow, Jeffrey J, Zita Martins, and Mark A Sephton. 2008. <span>“Mars on Earth: Soil Analogues for Future Mars Missions.”</span> <em>Astronomy &amp; Geophysics</em> 49 (2): 2–20. <a href="https://doi.org/10.1111/j.1468-4004.2008.49220.x">https://doi.org/10.1111/j.1468-4004.2008.49220.x</a>.
</div>
<div id="ref-Vaniman2012" class="csl-entry">
Vaniman, D. 2012. <span>“Mars Science Laboratory Chemistry &amp; Mineralogy RDR Data V1.0, MSL-m-CHEMIN-4-RDR-V1.0.”</span> <em>NASA Planetary Data System</em>.
</div>
<div id="ref-Vaniman2014" class="csl-entry">
Vaniman, D, DL Bish, DW Ming, TF Bristow, RV Morris, DF Blake, SJ Chipera, et al. 2014. <span>“<span class="nocase">Mineralogy of a mudstone at Yellowknife Bay, Gale crater, Mars</span>.”</span> <em>Science</em> 343 (6169). <a href="https://doi.org/10.1126/science.1243480 ">https://doi.org/10.1126/science.1243480</a>.
</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="cluster-analysis.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="references.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": null,
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
